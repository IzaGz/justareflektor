(function(a){var b={},c=a.indexOf("#");a.substring(a.indexOf("?")).replace(/([^?=&]+)(=([^&]+))?/g,function(a,c,f,l){b[c]=l});b["boolean"]=function(a,c){return b.hasOwnProperty(a)?"false"!==b[a]:c};b["float"]=function(a,c){var f=parseFloat(b[a]);return f!=f?c:f};b["int"]=function(a,c){var f=parseInt(b[a],10);return f!=f?c:f};b.hash=-1==c?void 0:a.substring(c+1);b.setUrl=arguments.callee;window.url=b})(location.href);(function(a,b){function c(a){var b=a.length,c=q.type(a);return q.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"===typeof b&&0<b&&b-1 in a)}function d(a){var b=Ab[a]={};q.each(a.match(sa)||[],function(a,c){b[c]=!0});return b}function e(a,c,d,e){if(q.acceptData(a)){var f=q.expando,l=a.nodeType,p=l?q.cache:a,m=l?a[f]:a[f]&&f;if(m&&p[m]&&(e||p[m].data)||d!==b||"string"!==typeof c){m||(m=l?a[f]=ta.pop()||q.guid++:f);p[m]||(p[m]=l?{}:{toJSON:q.noop});if("object"===typeof c||
"function"===typeof c)e?p[m]=q.extend(p[m],c):p[m].data=q.extend(p[m].data,c);a=p[m];e||(a.data||(a.data={}),a=a.data);d!==b&&(a[q.camelCase(c)]=d);"string"===typeof c?(d=a[c],null==d&&(d=a[q.camelCase(c)])):d=a;return d}}}function f(a,b,c){if(q.acceptData(a)){var d,e,f=a.nodeType,l=f?q.cache:a,p=f?a[q.expando]:q.expando;if(l[p]){if(b&&(d=c?l[p]:l[p].data)){q.isArray(b)?b=b.concat(q.map(b,q.camelCase)):b in d?b=[b]:(b=q.camelCase(b),b=b in d?[b]:b.split(" "));for(e=b.length;e--;)delete d[b[e]];if(c?
!m(d):!q.isEmptyObject(d))return}if(!c&&(delete l[p].data,!m(l[p])))return;f?q.cleanData([a],!0):q.support.deleteExpando||l!=l.window?delete l[p]:l[p]=null}}}function l(a,c,d){if(d===b&&1===a.nodeType)if(d="data-"+c.replace(Fa,"-$1").toLowerCase(),d=a.getAttribute(d),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:$a.test(d)?q.parseJSON(d):d}catch(e){}q.data(a,c,d)}else d=b;return d}function m(a){for(var b in a)if(("data"!==b||!q.isEmptyObject(a[b]))&&"toJSON"!==
b)return!1;return!0}function n(){return!0}function p(){return!1}function r(){try{return ia.activeElement}catch(a){}}function t(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function u(a,b,c){if(q.isFunction(b))return q.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return q.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(Gc.test(b))return q.filter(b,a,c);b=q.filter(b,a)}return q.grep(a,function(a){return 0<=q.inArray(a,b)!==c})}function z(a){var b=yc.split("|");
a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function E(a,b){return q.nodeName(a,"table")&&q.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function C(a){a.type=(null!==q.find.attr(a,"type"))+"/"+a.type;return a}function A(a){var b=zc.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function B(a,b){for(var c,d=0;null!=(c=a[d]);d++)q._data(c,"globalEval",
!b||q._data(b[d],"globalEval"))}function F(a,b){if(1===b.nodeType&&q.hasData(a)){var c,d,e;d=q._data(a);var f=q._data(b,d),l=d.events;if(l)for(c in delete f.handle,f.events={},l)for(d=0,e=l[c].length;d<e;d++)q.event.add(b,c,l[c][d]);f.data&&(f.data=q.extend({},f.data))}}function I(a,c){var d,e,f=0,l=typeof a.getElementsByTagName!==ga?a.getElementsByTagName(c||"*"):typeof a.querySelectorAll!==ga?a.querySelectorAll(c||"*"):b;if(!l)for(l=[],d=a.childNodes||a;null!=(e=d[f]);f++)!c||q.nodeName(e,c)?l.push(e):
q.merge(l,I(e,c));return c===b||c&&q.nodeName(a,c)?q.merge([a],l):l}function J(a){Jb.test(a.type)&&(a.defaultChecked=a.checked)}function D(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=sd.length;e--;)if(b=sd[e]+c,b in a)return b;return d}function P(a,b){a=b||a;return"none"===q.css(a,"display")||!q.contains(a.ownerDocument,a)}function M(a,b){for(var c,d,e,f=[],l=0,p=a.length;l<p;l++)d=a[l],d.style&&(f[l]=q._data(d,"olddisplay"),c=d.style.display,b?(f[l]||"none"!==c||
(d.style.display=""),""===d.style.display&&P(d)&&(f[l]=q._data(d,"olddisplay",T(d.nodeName)))):f[l]||(e=P(d),(c&&"none"!==c||!e)&&q._data(d,"olddisplay",e?c:q.css(d,"display"))));for(l=0;l<p;l++)d=a[l],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[l]||"":"none");return a}function G(a,b,c){return(a=Od.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function K(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=q.css(a,
c+Wb[b],!0,e)),d?("content"===c&&(f-=q.css(a,"padding"+Wb[b],!0,e)),"margin"!==c&&(f-=q.css(a,"border"+Wb[b]+"Width",!0,e))):(f+=q.css(a,"padding"+Wb[b],!0,e),"padding"!==c&&(f+=q.css(a,"border"+Wb[b]+"Width",!0,e)));return f}function Y(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Xb(a),l=q.support.boxSizing&&"border-box"===q.css(a,"boxSizing",!1,f);if(0>=e||null==e){e=Ob(a,b,f);if(0>e||null==e)e=a.style[b];if(Wc.test(e))return e;d=l&&(q.support.boxSizingReliable||e===a.style[b]);
e=parseFloat(e)||0}return e+K(a,b,c||(l?"border":"content"),d,f)+"px"}function T(a){var b=ia,c=R[a];c||(c=O(a,b),"none"!==c&&c||(gc=(gc||q("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(gc[0].contentWindow||gc[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=O(a,b),gc.detach()),R[a]=c);return c}function O(a,b){var c=q(b.createElement(a)).appendTo(b.body),d=q.css(c[0],"display");c.remove();return d}
function fa(a,b,c,d){var e;if(q.isArray(b))q.each(b,function(b,e){c||Pd.test(a)?d(a,e):fa(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==q.type(b))d(a,b);else for(e in b)fa(a+"["+e+"]",b[e],c,d)}function S(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(sa)||[];if(q.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function X(a,b,c,d){function e(p){var m;f[p]=!0;q.each(a[p]||
[],function(a,ka){var p=ka(b,c,d);if("string"===typeof p&&!l&&!f[p])return b.dataTypes.unshift(p),e(p),!1;if(l)return!(m=p)});return m}var f={},l=a===jd;return e(b.dataTypes[0])||!f["*"]&&e("*")}function Q(a,c){var d,e,f=q.ajaxSettings.flatOptions||{};for(e in c)c[e]!==b&&((f[e]?a:d||(d={}))[e]=c[e]);d&&q.extend(!0,a,d);return a}function Z(){try{return new a.XMLHttpRequest}catch(b){}}function V(){setTimeout(function(){Hc=b});return Hc=q.now()}function da(a,b,c){for(var d,e=(Nc[b]||[]).concat(Nc["*"]),
f=0,l=e.length;f<l;f++)if(d=e[f].call(c,b,a))return d}function W(a,b,c){var d,e=0,f=Xc.length,l=q.Deferred().always(function(){delete p.elem}),p=function(){if(d)return!1;for(var b=Hc||V(),b=Math.max(0,m.startTime+m.duration-b),c=1-(b/m.duration||0),e=0,f=m.tweens.length;e<f;e++)m.tweens[e].run(c);l.notifyWith(a,[m,c,b]);if(1>c&&f)return b;l.resolveWith(a,[m]);return!1},m=l.promise({elem:a,props:q.extend({},b),opts:q.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Hc||
V(),duration:c.duration,tweens:[],createTween:function(b,c){var d=q.Tween(a,m.opts,b,c,m.opts.specialEasing[b]||m.opts.easing);m.tweens.push(d);return d},stop:function(b){var c=0,e=b?m.tweens.length:0;if(d)return this;for(d=!0;c<e;c++)m.tweens[c].run(1);b?l.resolveWith(a,[m,b]):l.rejectWith(a,[m,b]);return this}});c=m.props;for(ua(c,m.opts.specialEasing);e<f;e++)if(b=Xc[e].call(m,a,c,m.opts))return b;q.map(c,da,m);q.isFunction(m.opts.start)&&m.opts.start.call(a,m);q.fx.timer(q.extend(p,{elem:a,anim:m,
queue:m.opts.queue}));return m.progress(m.opts.progress).done(m.opts.done,m.opts.complete).fail(m.opts.fail).always(m.opts.always)}function ua(a,b){var c,d,e,f,l;for(c in a)if(d=q.camelCase(c),e=b[d],f=a[c],q.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(l=q.cssHooks[d])&&"expand"in l)for(c in f=l.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=e);else b[d]=e}function aa(a,b,c,d,e){return new aa.prototype.init(a,b,c,d,e)}function ja(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-
b)c=Wb[e],d["margin"+c]=d["padding"+c]=a;b&&(d.opacity=d.width=a);return d}function N(a){return q.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var ma,U,ga=typeof b,va=a.location,ia=a.document,Pa=ia.documentElement,jb=a.jQuery,Ka=a.$,bb={},ta=[],ya=ta.concat,na=ta.push,ha=ta.slice,ra=ta.indexOf,za=bb.toString,wa=bb.hasOwnProperty,Aa="1.10.1".trim,q=function(a,b){return new q.fn.init(a,b,U)},db=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,sa=/\S+/g,cb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
Ma=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,wb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,tb=/^[\],:{}\s]*$/,Pb=/(?:^|:|,)(?:\s*\[)+/g,Qb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Rb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,hc=/^-ms-/,Yb=/-([\da-z])/gi,eb=function(a,b){return b.toUpperCase()},Ba=function(a){if(ia.addEventListener||"load"===a.type||"complete"===ia.readyState)Sa(),q.ready()},Sa=function(){ia.addEventListener?(ia.removeEventListener("DOMContentLoaded",Ba,!1),a.removeEventListener("load",
Ba,!1)):(ia.detachEvent("onreadystatechange",Ba),a.detachEvent("onload",Ba))};q.fn=q.prototype={jquery:"1.10.1",constructor:q,init:function(a,c,d){var e;if(!a)return this;if("string"===typeof a){e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:Ma.exec(a);if(!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof q?c[0]:c,q.merge(this,q.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:ia,!0)),wb.test(e[1])&&q.isPlainObject(c))for(e in c)if(q.isFunction(this[e]))this[e](c[e]);
else this.attr(e,c[e])}else{if((c=ia.getElementById(e[2]))&&c.parentNode){if(c.id!==e[2])return d.find(a);this.length=1;this[0]=c}this.context=ia;this.selector=a}return this}if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(q.isFunction(a))return d.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return q.makeArray(a,this)},selector:"",length:0,toArray:function(){return ha.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},
pushStack:function(a){a=q.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;return a},each:function(a,b){return q.each(this,a,b)},ready:function(a){q.ready.promise().done(a);return this},slice:function(){return this.pushStack(ha.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},map:function(a){return this.pushStack(q.map(this,function(b,c){return a.call(b,
c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:na,sort:[].sort,splice:[].splice};q.fn.init.prototype=q.fn;q.extend=q.fn.extend=function(){var a,c,d,e,f,l=arguments[0]||{},p=1,m=arguments.length,n=!1;"boolean"===typeof l&&(n=l,l=arguments[1]||{},p=2);"object"===typeof l||q.isFunction(l)||(l={});m===p&&(l=this,--p);for(;p<m;p++)if(null!=(f=arguments[p]))for(e in f)a=l[e],d=f[e],l!==d&&(n&&d&&(q.isPlainObject(d)||(c=q.isArray(d)))?(c?(c=!1,a=a&&q.isArray(a)?a:[]):a=a&&q.isPlainObject(a)?
a:{},l[e]=q.extend(n,a,d)):d!==b&&(l[e]=d));return l};q.extend({expando:"jQuery"+("1.10.1"+Math.random()).replace(/\D/g,""),noConflict:function(b){a.$===q&&(a.$=Ka);b&&a.jQuery===q&&(a.jQuery=jb);return q},isReady:!1,readyWait:1,holdReady:function(a){a?q.readyWait++:q.ready(!0)},ready:function(a){if(!0===a?!--q.readyWait:!q.isReady){if(!ia.body)return setTimeout(q.ready);q.isReady=!0;!0!==a&&0<--q.readyWait||(ma.resolveWith(ia,[q]),q.fn.trigger&&q(ia).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===
q.type(a)},isArray:Array.isArray||function(a){return"array"===q.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"===typeof a||"function"===typeof a?bb[za.call(a)]||"object":typeof a},isPlainObject:function(a){var c;if(!a||"object"!==q.type(a)||a.nodeType||q.isWindow(a))return!1;try{if(a.constructor&&!wa.call(a,"constructor")&&!wa.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(q.support.ownLast)for(c in a)return wa.call(a,
c);for(c in a);return c===b||wa.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);},parseHTML:function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||ia;var d=wb.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];d=q.buildFragment([a],b,c);c&&q(c).remove();return q.merge([],d.childNodes)},parseJSON:function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(null===b)return b;if("string"===typeof b&&(b=q.trim(b))&&
tb.test(b.replace(Qb,"@").replace(Rb,"]").replace(Pb,"")))return(new Function("return "+b))();q.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||"string"!==typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||q.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&q.trim(b)&&
(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(hc,"ms-").replace(Yb,eb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,l=a.length;e=c(a);if(d)if(e)for(;f<l&&(e=b.apply(a[f],d),!1!==e);f++);else for(f in a){if(e=b.apply(a[f],d),!1===e)break}else if(e)for(;f<l&&(e=b.call(a[f],f,a[f]),!1!==e);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:Aa&&!Aa.call("\ufeff\u00a0")?
function(a){return null==a?"":Aa.call(a)}:function(a){return null==a?"":(a+"").replace(cb,"")},makeArray:function(a,b){var d=b||[];null!=a&&(c(Object(a))?q.merge(d,"string"===typeof a?[a]:a):na.call(d,a));return d},inArray:function(a,b,c){var d;if(b){if(ra)return ra.call(b,a,c);d=b.length;for(c=c?0>c?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"===typeof d)for(;f<d;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];
a.length=e;return a},grep:function(a,b,c){var d,e=[],f=0,l=a.length;for(c=!!c;f<l;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,l=a.length,p=[];if(c(a))for(;f<l;f++)e=b(a[f],f,d),null!=e&&(p[p.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(p[p.length]=e);return ya.apply([],p)},guid:1,proxy:function(a,c){var d,e;"string"===typeof c&&(e=a[c],c=a,a=e);if(!q.isFunction(a))return b;d=ha.call(arguments,2);e=function(){return a.apply(c||this,d.concat(ha.call(arguments)))};
e.guid=a.guid=a.guid||q.guid++;return e},access:function(a,c,d,e,f,l,p){var m=0,n=a.length,r=null==d;if("object"===q.type(d))for(m in f=!0,d)q.access(a,c,m,d[m],!0,l,p);else if(e!==b&&(f=!0,q.isFunction(e)||(p=!0),r&&(p?(c.call(a,e),c=null):(r=c,c=function(a,b,c){return r.call(q(a),c)})),c))for(;m<n;m++)c(a[m],d,p?e:e.call(a[m],m,c(a[m],d)));return f?a:r?c.call(a):n?c(a[0],d):l},now:function(){return(new Date).getTime()},swap:function(a,b,c,d){var e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];
c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c}});q.ready.promise=function(b){if(!ma)if(ma=q.Deferred(),"complete"===ia.readyState)setTimeout(q.ready);else if(ia.addEventListener)ia.addEventListener("DOMContentLoaded",Ba,!1),a.addEventListener("load",Ba,!1);else{ia.attachEvent("onreadystatechange",Ba);a.attachEvent("onload",Ba);var c=!1;try{c=null==a.frameElement&&ia.documentElement}catch(d){}c&&c.doScroll&&function hb(){if(!q.isReady){try{c.doScroll("left")}catch(a){return setTimeout(hb,
50)}Sa();q.ready()}}()}return ma.promise(b)};q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){bb["[object "+b+"]"]=b.toLowerCase()});U=q(ia);(function(a,b){function c(a,b,d,e){var f,l,p,m,n;(b?b.ownerDocument||b:ja)!==yb&&Q(b);b=b||yb;d=d||[];if(!a||"string"!==typeof a)return d;if(1!==(m=b.nodeType)&&9!==m)return[];if(ua&&!e){if(f=ga.exec(a))if(p=f[1])if(9===m)if((l=b.getElementById(p))&&l.parentNode){if(l.id===p)return d.push(l),d}else return d;else{if(b.ownerDocument&&
(l=b.ownerDocument.getElementById(p))&&N(b,l)&&l.id===p)return d.push(l),d}else{if(f[2])return O.apply(d,b.getElementsByTagName(a)),d;if((p=f[3])&&F.getElementsByClassName&&b.getElementsByClassName)return O.apply(d,b.getElementsByClassName(p)),d}if(F.qsa&&(!K||!K.test(a))){l=f=Ca;p=b;n=9===m&&a;if(1===m&&"object"!==b.nodeName.toLowerCase()){m=Ea(a);(f=b.getAttribute("id"))?l=f.replace(ta,"\\$&"):b.setAttribute("id",l);l="[id='"+l+"'] ";for(p=m.length;p--;)m[p]=l+C(m[p]);p=Wb.test(a)&&b.parentNode||
b;n=m.join(",")}if(n)try{return O.apply(d,p.querySelectorAll(n)),d}catch(ka){}finally{f||b.removeAttribute("id")}}}var r;a:{a=a.replace(Ob,"$1");l=Ea(a);if(!e&&1===l.length){f=l[0]=l[0].slice(0);if(2<f.length&&"ID"===(r=f[0]).type&&F.getById&&9===b.nodeType&&ua&&G.relative[f[1].type]){b=(G.find.ID(r.matches[0].replace(bc,Tb),b)||[])[0];if(!b){r=d;break a}a=a.slice(f.shift().value.length)}for(m=ca.needsContext.test(a)?0:f.length;m--;){r=f[m];if(G.relative[p=r.type])break;if(p=G.find[p])if(e=p(r.matches[0].replace(bc,
Tb),Wb.test(f[0].type)&&b.parentNode||b)){f.splice(m,1);a=e.length&&C(f);if(!a){O.apply(d,e);r=d;break a}break}}}ac(a,l)(e,b,!ua,d,Wb.test(a));r=d}return r}function d(a){return ea.test(a+"")}function e(){function a(c,d){b.push(c+=" ")>G.cacheLength&&delete a[b.shift()];return a[c]=d}var b=[];return a}function f(a){a[Ca]=!0;return a}function l(a){var b=yb.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function p(a,b,c){a=a.split("|");var d,
e=a.length;for(c=c?null:b;e--;)(d=G.attrHandle[a[e]])&&d!==b||(G.attrHandle[a[e]]=c)}function m(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:!0===a[b]?b.toLowerCase():null}function n(a,b){return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}function r(a){if("input"===a.nodeName.toLowerCase())return a.defaultValue}function t(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||U)-(~a.sourceIndex||U);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?
1:-1}function u(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function s(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function z(a){return f(function(b){b=+b;return f(function(c,d){for(var e,f=a([],c.length,b),l=f.length;l--;)c[e=f[l]]&&(c[e]=!(d[e]=c[e]))})})}function Ea(a,b){var d,e,f,l,p,m,n;if(p=T[a+" "])return b?0:p.slice(0);p=a;m=[];for(n=G.preFilter;p;){if(!d||(e=fa.exec(p)))e&&(p=p.slice(e[0].length)||p),
m.push(f=[]);d=!1;if(e=ma.exec(p))d=e.shift(),f.push({value:d,type:e[0].replace(Ob," ")}),p=p.slice(d.length);for(l in G.filter)!(e=ca[l].exec(p))||n[l]&&!(e=n[l](e))||(d=e.shift(),f.push({value:d,type:l,matches:e}),p=p.slice(d.length));if(!d)break}return b?p.length:p?c.error(a):T(a,m).slice(0)}function C(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function D(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=ia++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,
c,f)}:function(b,c,l){var p,m,n,ka=Sb+" "+f;if(l)for(;b=b[d];){if((1===b.nodeType||e)&&a(b,c,l))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(n=b[Ca]||(b[Ca]={}),(m=n[d])&&m[0]===ka){if(!0===(p=m[1])||p===Ga)return!0===p}else if(m=n[d]=[ka],m[1]=a(b,c,l)||Ga,!0===m[1])return!0}}function E(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function A(a,b,c,d,e){for(var f,l=[],p=0,m=a.length,n=null!=b;p<m;p++)if(f=a[p])if(!c||c(f,d,e))l.push(f),
n&&b.push(p);return l}function I(a,b,d,e,l,p){e&&!e[Ca]&&(e=I(e));l&&!l[Ca]&&(l=I(l,p));return f(function(f,p,m,n){var ka,r,t=[],q=[],u=p.length,s;if(!(s=f)){s=b||"*";for(var z=m.nodeType?[m]:m,xc=[],Ea=0,C=z.length;Ea<C;Ea++)c(s,z[Ea],xc);s=xc}s=!a||!f&&b?s:A(s,t,a,m,n);z=d?l||(f?a:u||e)?[]:p:s;d&&d(s,z,m,n);if(e)for(ka=A(z,q),e(ka,[],m,n),m=ka.length;m--;)if(r=ka[m])z[q[m]]=!(s[q[m]]=r);if(f){if(l||a){if(l){ka=[];for(m=z.length;m--;)(r=z[m])&&ka.push(s[m]=r);l(null,z=[],ka,n)}for(m=z.length;m--;)(r=
z[m])&&-1<(ka=l?zb.call(f,r):t[m])&&(f[ka]=!(p[ka]=r))}}else z=A(z===p?z.splice(u,z.length):z),l?l(null,p,z,n):O.apply(p,z)})}function da(a){var b,c,d,e=a.length,f=G.relative[a[0].type];c=f||G.relative[" "];for(var l=f?1:0,p=D(function(a){return a===b},c,!0),m=D(function(a){return-1<zb.call(b,a)},c,!0),n=[function(a,c,d){return!f&&(d||c!==M)||((b=c).nodeType?p(a,c,d):m(a,c,d))}];l<e;l++)if(c=G.relative[a[l].type])n=[D(E(n),c)];else{c=G.filter[a[l].type].apply(null,a[l].matches);if(c[Ca]){for(d=++l;d<
e&&!G.relative[a[d].type];d++);return I(1<l&&E(n),1<l&&C(a.slice(0,l-1).concat({value:" "===a[l-2].type?"*":""})).replace(Ob,"$1"),c,l<d&&da(a.slice(l,d)),d<e&&da(a=a.slice(d)),d<e&&C(a))}n.push(c)}return E(n)}function B(a,b){var d=0,e=0<b.length,l=0<a.length,p=function(f,p,m,n,ka){var r,t,q=[],u=0,s="0",z=f&&[],xc=null!=ka,Ea=M,C=f||l&&G.find.TAG("*",ka&&p.parentNode||p),D=Sb+=null==Ea?1:Math.random()||0.1;xc&&(M=p!==yb&&p,Ga=d);for(;null!=(ka=C[s]);s++){if(l&&ka){for(r=0;t=a[r++];)if(t(ka,p,m)){n.push(ka);
break}xc&&(Sb=D,Ga=++d)}e&&((ka=!t&&ka)&&u--,f&&z.push(ka))}u+=s;if(e&&s!==u){for(r=0;t=b[r++];)t(z,q,p,m);if(f){if(0<u)for(;s--;)z[s]||q[s]||(q[s]=vc.call(n));q=A(q)}O.apply(n,q);xc&&(!f&&0<q.length&&1<u+b.length)&&c.uniqueSort(n)}xc&&(Sb=D,M=Ea);return z};return e?f(p):p}function J(){}var Za,F,Ga,G,P,W,ac,M,H,Q,yb,mb,ua,K,aa,Cc,N,Ca="sizzle"+-new Date,ja=a.document,Sb=0,ia=0,V=e(),T=e(),va=e(),X=!1,Y=function(){return 0},zc=typeof b,U=-2147483648,Jb={}.hasOwnProperty,R=[],vc=R.pop,Z=R.push,O=R.push,
S=R.slice,zb=R.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},Xb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),Jc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+Xb+")|)|)[\\x20\\t\\r\\n\\f]*\\]",gc=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+Jc.replace(3,8)+")*)|.*)\\)|)",Ob=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$",
"g"),fa=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,ma=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Wb=/[\x20\t\r\n\f]*[+~]/,ya=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),ba=RegExp(gc),ha=RegExp("^"+Xb+"$"),ca={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+Jc),PSEUDO:RegExp("^"+gc),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},ea=/^[^{]+\{\s*\[native \w/,ga=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Pa=/^(?:input|select|textarea|button)$/i,ld=/^h\d$/i,ta=/'|\\/g,bc=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)",
"ig"),Tb=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)};try{O.apply(R=S.call(ja.childNodes),ja.childNodes),R[ja.childNodes.length].nodeType}catch(na){O={apply:R.length?function(a,b){Z.apply(a,S.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}W=c.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};F=c.support={};Q=c.setDocument=function(a){var b=a?
a.ownerDocument||a:ja;a=b.parentWindow;if(b===yb||9!==b.nodeType||!b.documentElement)return yb;yb=b;mb=b.documentElement;ua=!W(b);a&&a.frameElement&&a.attachEvent("onbeforeunload",function(){Q()});F.attributes=l(function(a){a.innerHTML="<a href='#'></a>";p("type|href|height|width",n,"#"===a.firstChild.getAttribute("href"));p("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",m,null==a.getAttribute("disabled"));a.className="i";
return!a.getAttribute("className")});F.input=l(function(a){a.innerHTML="<input>";a.firstChild.setAttribute("value","");return""===a.firstChild.getAttribute("value")});p("value",r,F.attributes&&F.input);F.getElementsByTagName=l(function(a){a.appendChild(b.createComment(""));return!a.getElementsByTagName("*").length});F.getElementsByClassName=l(function(a){a.innerHTML="<div class='a'></div><div class='a i'></div>";a.firstChild.className="i";return 2===a.getElementsByClassName("i").length});F.getById=
l(function(a){mb.appendChild(a).id=Ca;return!b.getElementsByName||!b.getElementsByName(Ca).length});F.getById?(G.find.ID=function(a,b){if(typeof b.getElementById!==zc&&ua){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},G.filter.ID=function(a){var b=a.replace(bc,Tb);return function(a){return a.getAttribute("id")===b}}):(delete G.find.ID,G.filter.ID=function(a){var b=a.replace(bc,Tb);return function(a){return(a=typeof a.getAttributeNode!==zc&&a.getAttributeNode("id"))&&a.value===b}});G.find.TAG=
F.getElementsByTagName?function(a,b){if(typeof b.getElementsByTagName!==zc)return b.getElementsByTagName(a)}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f};G.find.CLASS=F.getElementsByClassName&&function(a,b){if(typeof b.getElementsByClassName!==zc&&ua)return b.getElementsByClassName(a)};aa=[];K=[];if(F.qsa=d(b.querySelectorAll))l(function(a){a.innerHTML="<select><option selected=''></option></select>";a.querySelectorAll("[selected]").length||
K.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||K.push(":checked")}),l(function(a){var c=b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("t","");a.querySelectorAll("[t^='']").length&&K.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll(":enabled").length||K.push(":enabled",":disabled");a.querySelectorAll("*,:x");
K.push(",.*:")});(F.matchesSelector=d(Cc=mb.webkitMatchesSelector||mb.mozMatchesSelector||mb.oMatchesSelector||mb.msMatchesSelector))&&l(function(a){F.disconnectedMatch=Cc.call(a,"div");Cc.call(a,"[s!='']:x");aa.push("!=",gc)});K=K.length&&RegExp(K.join("|"));aa=aa.length&&RegExp(aa.join("|"));N=d(mb.contains)||mb.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&1===d.nodeType&&(c.contains?c.contains(d):a.compareDocumentPosition&&
a.compareDocumentPosition(d)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};F.sortDetached=l(function(a){return a.compareDocumentPosition(b.createElement("div"))&1});Y=mb.compareDocumentPosition?function(a,c){if(a===c)return X=!0,0;var d=c.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(c);return d?d&1||!F.sortDetached&&c.compareDocumentPosition(a)===d?a===b||N(ja,a)?-1:c===b||N(ja,c)?1:H?zb.call(H,a)-zb.call(H,c):0:d&4?-1:1:a.compareDocumentPosition?
-1:1}:function(a,c){var d,e=0;d=a.parentNode;var f=c.parentNode,l=[a],p=[c];if(a===c)return X=!0,0;if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:H?zb.call(H,a)-zb.call(H,c):0;if(d===f)return t(a,c);for(d=a;d=d.parentNode;)l.unshift(d);for(d=c;d=d.parentNode;)p.unshift(d);for(;l[e]===p[e];)e++;return e?t(l[e],p[e]):l[e]===ja?-1:p[e]===ja?1:0};return b};c.matches=function(a,b){return c(a,null,null,b)};c.matchesSelector=function(a,b){(a.ownerDocument||a)!==yb&&Q(a);b=b.replace(ya,"='$1']");if(F.matchesSelector&&
ua&&!(aa&&aa.test(b)||K&&K.test(b)))try{var d=Cc.call(a,b);if(d||F.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<c(b,yb,null,[a]).length};c.contains=function(a,b){(a.ownerDocument||a)!==yb&&Q(a);return N(a,b)};c.attr=function(a,c){(a.ownerDocument||a)!==yb&&Q(a);var d=G.attrHandle[c.toLowerCase()],d=d&&Jb.call(G.attrHandle,c.toLowerCase())?d(a,c,!ua):b;return d===b?F.attributes||!ua?a.getAttribute(c):(d=a.getAttributeNode(c))&&d.specified?d.value:null:d};c.error=
function(a){throw Error("Syntax error, unrecognized expression: "+a);};c.uniqueSort=function(a){var b,c=[],d=0,e=0;X=!F.detectDuplicates;H=!F.sortStable&&a.slice(0);a.sort(Y);if(X){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a};P=c.getText=function(a){var b,c="",d=0;b=a.nodeType;if(!b)for(;b=a[d];d++)c+=P(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=P(a)}else if(3===b||4===b)return a.nodeValue;
return c};G=c.selectors={cacheLength:50,createPseudo:f,match:ca,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(bc,Tb);a[3]=(a[4]||a[5]||"").replace(bc,Tb);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||c.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===
a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&c.error(a[0]);return a},PSEUDO:function(a){var c,d=!a[5]&&a[2];if(ca.CHILD.test(a[0]))return null;a[3]&&a[4]!==b?a[2]=a[4]:d&&(ba.test(d)&&(c=Ea(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length))&&(a[0]=a[0].slice(0,c),a[2]=d.slice(0,c));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(bc,Tb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=V[a+" "];return b||
(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&V(a,function(a){return b.test("string"===typeof a.className&&a.className||typeof a.getAttribute!==zc&&a.getAttribute("class")||"")})},ATTR:function(a,b,d){return function(e){e=c.attr(e,a);if(null==e)return"!="===b;if(!b)return!0;e+="";return"="===b?e===d:"!="===b?e!==d:"^="===b?d&&0===e.indexOf(d):"*="===b?d&&-1<e.indexOf(d):"$="===b?d&&e.slice(-d.length)===d:"~="===b?-1<(" "+e+" ").indexOf(d):"|="===b?e===d||e.slice(0,d.length+1)===
d+"-":!1}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),l="last"!==a.slice(-4),p="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,m){var n,ka,r,t,q;c=f!==l?"nextSibling":"previousSibling";var u=b.parentNode,s=p&&b.nodeName.toLowerCase();m=!m&&!p;if(u){if(f){for(;c;){for(ka=b;ka=ka[c];)if(p?ka.nodeName.toLowerCase()===s:1===ka.nodeType)return!1;q=c="only"===a&&!q&&"nextSibling"}return!0}q=[l?u.firstChild:u.lastChild];if(l&&m)for(m=u[Ca]||(u[Ca]={}),n=m[a]||[],
t=n[0]===Sb&&n[1],r=n[0]===Sb&&n[2],ka=t&&u.childNodes[t];ka=++t&&ka&&ka[c]||(r=t=0)||q.pop();){if(1===ka.nodeType&&++r&&ka===b){m[a]=[Sb,t,r];break}}else if(m&&(n=(b[Ca]||(b[Ca]={}))[a])&&n[0]===Sb)r=n[1];else for(;(ka=++t&&ka&&ka[c]||(r=t=0)||q.pop())&&((p?ka.nodeName.toLowerCase()!==s:1!==ka.nodeType)||!++r||(m&&((ka[Ca]||(ka[Ca]={}))[a]=[Sb,r]),ka!==b)););r-=e;return r===d||0===r%d&&0<=r/d}}},PSEUDO:function(a,b){var d,e=G.pseudos[a]||G.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+
a);return e[Ca]?e(b):1<e.length?(d=[a,a,"",b],G.setFilters.hasOwnProperty(a.toLowerCase())?f(function(a,c){for(var d,f=e(a,b),l=f.length;l--;)d=zb.call(a,f[l]),a[d]=!(c[d]=f[l])}):function(a){return e(a,0,d)}):e}},pseudos:{not:f(function(a){var b=[],c=[],d=ac(a.replace(Ob,"$1"));return d[Ca]?f(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)if(c=e[f])a[f]=!(b[f]=c)}):function(a,e,f){b[0]=a;d(b,null,f,c);return!c.pop()}}),has:f(function(a){return function(b){return 0<c(a,b).length}}),contains:f(function(a){return function(b){return-1<
(b.textContent||b.innerText||P(b)).indexOf(a)}}),lang:f(function(a){ha.test(a||"")||c.error("unsupported lang: "+a);a=a.replace(bc,Tb).toLowerCase();return function(b){var c;do if(c=ua?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===mb},focus:function(a){return a===yb.activeElement&&
(!yb.hasFocus||yb.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if("@"<a.nodeName||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!G.pseudos.empty(a)},
header:function(a){return ld.test(a.nodeName)},input:function(a){return Pa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:z(function(){return[0]}),last:z(function(a,b){return[b-1]}),eq:z(function(a,b,c){return[0>c?c+b:c]}),even:z(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),
odd:z(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:z(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:z(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};for(Za in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})G.pseudos[Za]=u(Za);for(Za in{submit:!0,reset:!0})G.pseudos[Za]=s(Za);ac=c.compile=function(a,b){var c,d=[],e=[],f=va[a+" "];if(!f){b||(b=Ea(a));for(c=b.length;c--;)f=da(b[c]),f[Ca]?d.push(f):e.push(f);f=va(a,B(e,d))}return f};G.pseudos.nth=G.pseudos.eq;
J.prototype=G.filters=G.pseudos;G.setFilters=new J;F.sortStable=Ca.split("").sort(Y).join("")===Ca;Q();[0,0].sort(Y);F.detectDuplicates=X;q.find=c;q.expr=c.selectors;q.expr[":"]=q.expr.pseudos;q.unique=c.uniqueSort;q.text=c.getText;q.isXMLDoc=c.isXML;q.contains=c.contains})(a);var Ab={};q.Callbacks=function(a){a="string"===typeof a?Ab[a]||d(a):q.extend({},a);var c,e,f,l,p,m,n=[],r=!a.once&&[],t=function(b){e=a.memory&&b;f=!0;p=m||0;m=0;l=n.length;for(c=!0;n&&p<l;p++)if(!1===n[p].apply(b[0],b[1])&&
a.stopOnFalse){e=!1;break}c=!1;n&&(r?r.length&&t(r.shift()):e?n=[]:u.disable())},u={add:function(){if(n){var b=n.length;(function pb(b){q.each(b,function(b,c){var d=q.type(c);"function"===d?a.unique&&u.has(c)||n.push(c):c&&(c.length&&"string"!==d)&&pb(c)})})(arguments);c?l=n.length:e&&(m=b,t(e))}return this},remove:function(){n&&q.each(arguments,function(a,b){for(var d;-1<(d=q.inArray(b,n,d));)n.splice(d,1),c&&(d<=l&&l--,d<=p&&p--)});return this},has:function(a){return a?-1<q.inArray(a,n):!(!n||!n.length)},
empty:function(){n=[];l=0;return this},disable:function(){n=r=e=b;return this},disabled:function(){return!n},lock:function(){r=b;e||u.disable();return this},locked:function(){return!r},fireWith:function(a,b){b=b||[];b=[a,b.slice?b.slice():b];!n||f&&!r||(c?r.push(b):t(b));return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!f}};return u};q.extend({Deferred:function(a){var b=[["resolve","done",q.Callbacks("once memory"),"resolved"],["reject","fail",q.Callbacks("once memory"),
"rejected"],["notify","progress",q.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return q.Deferred(function(c){q.each(b,function(b,f){var l=f[0],p=q.isFunction(a[b])&&a[b];e[f[1]](function(){var a=p&&p.apply(this,arguments);if(a&&q.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);else c[l+"With"](this===d?c.promise():this,p?[a]:arguments)})});a=null}).promise()},
promise:function(a){return null!=a?q.extend(a,d):d}},e={};d.pipe=d.then;q.each(b,function(a,f){var l=f[2],p=f[3];d[f[1]]=l.add;p&&l.add(function(){c=p},b[a^1][2].disable,b[2][2].lock);e[f[0]]=function(){e[f[0]+"With"](this===e?d:this,arguments);return this};e[f[0]+"With"]=l.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=0,c=ha.call(arguments),d=c.length,e=1!==d||a&&q.isFunction(a.promise)?d:0,f=1===e?a:q.Deferred(),l=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?
ha.call(arguments):d;c===p?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},p,m,n;if(1<d)for(p=Array(d),m=Array(d),n=Array(d);b<d;b++)c[b]&&q.isFunction(c[b].promise)?c[b].promise().done(l(b,n,c)).fail(f.reject).progress(l(b,m,p)):--e;e||f.resolveWith(n,c);return f.promise()}});q.support=function(b){var c,d,e,f,l,p,m=ia.createElement("div");m.setAttribute("className","t");m.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";c=m.getElementsByTagName("*")||[];d=m.getElementsByTagName("a")[0];
if(!d||!d.style||!c.length)return b;e=ia.createElement("select");f=e.appendChild(ia.createElement("option"));c=m.getElementsByTagName("input")[0];d.style.cssText="top:1px;float:left;opacity:.5";b.getSetAttribute="t"!==m.className;b.leadingWhitespace=3===m.firstChild.nodeType;b.tbody=!m.getElementsByTagName("tbody").length;b.htmlSerialize=!!m.getElementsByTagName("link").length;b.style=/top/.test(d.getAttribute("style"));b.hrefNormalized="/a"===d.getAttribute("href");b.opacity=/^0.5/.test(d.style.opacity);
b.cssFloat=!!d.style.cssFloat;b.checkOn=!!c.value;b.optSelected=f.selected;b.enctype=!!ia.createElement("form").enctype;b.html5Clone="<:nav></:nav>"!==ia.createElement("nav").cloneNode(!0).outerHTML;b.inlineBlockNeedsLayout=!1;b.shrinkWrapBlocks=!1;b.pixelPosition=!1;b.deleteExpando=!0;b.noCloneEvent=!0;b.reliableMarginRight=!0;b.boxSizingReliable=!0;c.checked=!0;b.noCloneChecked=c.cloneNode(!0).checked;e.disabled=!0;b.optDisabled=!f.disabled;try{delete m.test}catch(n){b.deleteExpando=!1}c=ia.createElement("input");
c.setAttribute("value","");b.input=""===c.getAttribute("value");c.value="t";c.setAttribute("type","radio");b.radioValue="t"===c.value;c.setAttribute("checked","t");c.setAttribute("name","t");d=ia.createDocumentFragment();d.appendChild(c);b.appendChecked=c.checked;b.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;m.attachEvent&&(m.attachEvent("onclick",function(){b.noCloneEvent=!1}),m.cloneNode(!0).click());for(p in{submit:!0,change:!0,focusin:!0})m.setAttribute(d="on"+p,"t"),b[p+"Bubbles"]=
d in a||!1===m.attributes[d].expando;m.style.backgroundClip="content-box";m.cloneNode(!0).style.backgroundClip="";b.clearCloneStyle="content-box"===m.style.backgroundClip;for(p in q(b))break;b.ownLast="0"!==p;q(function(){var c,d,e=ia.getElementsByTagName("body")[0];e&&(c=ia.createElement("div"),c.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",e.appendChild(c).appendChild(m),m.innerHTML="<table><tr><td></td><td>t</td></tr></table>",d=m.getElementsByTagName("td"),
d[0].style.cssText="padding:0;margin:0;border:0;display:none",l=0===d[0].offsetHeight,d[0].style.display="",d[1].style.display="none",b.reliableHiddenOffsets=l&&0===d[0].offsetHeight,m.innerHTML="",m.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",q.swap(e,null!=e.style.zoom?{zoom:1}:{},function(){b.boxSizing=4===m.offsetWidth}),a.getComputedStyle&&(b.pixelPosition=
"1%"!==(a.getComputedStyle(m,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(m,null)||{width:"4px"}).width,d=m.appendChild(ia.createElement("div")),d.style.cssText=m.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",d.style.marginRight=d.style.width="0",m.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),typeof m.style.zoom!==ga&&(m.innerHTML="",
m.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===m.offsetWidth,m.style.display="block",m.innerHTML="<div></div>",m.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==m.offsetWidth,b.inlineBlockNeedsLayout&&(e.style.zoom=1)),e.removeChild(c),c=m=d=d=null)});c=e=d=f=d=c=null;return b}({});var $a=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Fa=/([A-Z])/g;
q.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){a=a.nodeType?q.cache[a[q.expando]]:a[q.expando];return!!a&&!m(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&q.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===
b}});q.fn.extend({data:function(a,c){var d,e,f=null,p=0,m=this[0];if(a===b){if(this.length&&(f=q.data(m),1===m.nodeType&&!q._data(m,"parsedAttrs"))){for(d=m.attributes;p<d.length;p++)e=d[p].name,0===e.indexOf("data-")&&(e=q.camelCase(e.slice(5)),l(m,e,f[e]));q._data(m,"parsedAttrs",!0)}return f}return"object"===typeof a?this.each(function(){q.data(this,a)}):1<arguments.length?this.each(function(){q.data(this,a,c)}):m?l(m,a,q.data(m,a)):null},removeData:function(a){return this.each(function(){q.removeData(this,
a)})}});q.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=q._data(a,b),c&&(!d||q.isArray(c)?d=q._data(a,b,q.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=q.queue(a,b),d=c.length,e=c.shift(),f=q._queueHooks(a,b),l=function(){q.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,l,f));!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return q._data(a,c)||q._data(a,c,{empty:q.Callbacks("once memory").add(function(){q._removeData(a,
b+"queue");q._removeData(a,c)})})}});q.fn.extend({queue:function(a,c){var d=2;"string"!==typeof a&&(c=a,a="fx",d--);return arguments.length<d?q.queue(this[0],a):c===b?this:this.each(function(){var b=q.queue(this,a,c);q._queueHooks(this,a);"fx"===a&&"inprogress"!==b[0]&&q.dequeue(this,a)})},dequeue:function(a){return this.each(function(){q.dequeue(this,a)})},delay:function(a,b){a=q.fx?q.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},
clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=q.Deferred(),l=this,p=this.length,m=function(){--e||f.resolveWith(l,[l])};"string"!==typeof a&&(c=a,a=b);for(a=a||"fx";p--;)(d=q._data(l[p],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(m));m();return f.promise(c)}});var Ja,Cb,s=/[\t\r\n\f]/g,Fb=/\r/g,sb=/^(?:input|select|textarea|button|object)$/i,lb=/^(?:a|area)$/i,kb=/^(?:checked|selected)$/i,gb=q.support.getSetAttribute,sc=q.support.input;q.fn.extend({attr:function(a,
b){return q.access(this,q.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){q.removeAttr(this,a)})},prop:function(a,b){return q.access(this,q.prop,a,b,1<arguments.length)},removeProp:function(a){a=q.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,l=0,p=this.length;b="string"===typeof a&&a;if(q.isFunction(a))return this.each(function(b){q(this).addClass(a.call(this,b,this.className))});if(b)for(b=
(a||"").match(sa)||[];l<p;l++)if(c=this[l],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(s," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=q.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,l=0,p=this.length;b=0===arguments.length||"string"===typeof a&&a;if(q.isFunction(a))return this.each(function(b){q(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(sa)||[];l<p;l++)if(c=this[l],d=1===c.nodeType&&(c.className?(" "+c.className+
" ").replace(s," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");c.className=a?q.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"===typeof b;return q.isFunction(a)?this.each(function(c){q(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,l=q(this),p=b,m=a.match(sa)||[];e=m[f++];)p=d?p:!l.hasClass(e),l[p?"addClass":"removeClass"](e);else if(c===ga||"boolean"===c)this.className&&q._data(this,
"__className__",this.className),this.className=this.className||!1===a?"":q._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(s," ").indexOf(a))return!0;return!1},val:function(a){var c,d,e,f=this[0];if(arguments.length)return e=q.isFunction(a),this.each(function(c){1===this.nodeType&&(c=e?a.call(this,c,q(this).val()):a,null==c?c="":"number"===typeof c?c+="":q.isArray(c)&&(c=q.map(c,function(a){return null==
a?"":a+""})),d=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,c,"value")!==b||(this.value=c))});if(f){if((d=q.valHooks[f.type]||q.valHooks[f.nodeName.toLowerCase()])&&"get"in d&&(c=d.get(f,"value"))!==b)return c;c=f.value;return"string"===typeof c?c.replace(Fb,""):null==c?"":c}}});q.extend({valHooks:{option:{get:function(a){var b=q.find.attr(a,"value");return null!=b?b:a.text}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===
a.type||0>d)?null:[],f=a?d+1:c.length,l=0>d?f:a?d:0;l<f;l++)if(b=c[l],!(!b.selected&&l!==d||(q.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&q.nodeName(b.parentNode,"optgroup"))){b=q(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=q.makeArray(b),l=e.length;l--;)if(d=e[l],d.selected=0<=q.inArray(q(d).val(),f))c=!0;c||(a.selectedIndex=-1);return f}}},attr:function(a,c,d){var e,f,l=a.nodeType;if(a&&3!==l&&8!==l&&2!==l){if(typeof a.getAttribute===
ga)return q.prop(a,c,d);1===l&&q.isXMLDoc(a)||(c=c.toLowerCase(),e=q.attrHooks[c]||(q.expr.match.bool.test(c)?Cb:Ja));if(d!==b)if(null===d)q.removeAttr(a,c);else{if(e&&"set"in e&&(f=e.set(a,d,c))!==b)return f;a.setAttribute(c,d+"");return d}else{if(e&&"get"in e&&null!==(f=e.get(a,c)))return f;f=q.find.attr(a,c);return null==f?b:f}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(sa);if(f&&1===a.nodeType)for(;c=f[e++];)d=q.propFix[c]||c,q.expr.match.bool.test(c)?sc&&gb||!kb.test(c)?a[d]=!1:a[q.camelCase("default-"+
c)]=a[d]=!1:q.attr(a,c,""),a.removeAttribute(gb?c:d)},attrHooks:{type:{set:function(a,b){if(!q.support.radioValue&&"radio"===b&&q.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,c,d){var e,f,l;l=a.nodeType;if(a&&3!==l&&8!==l&&2!==l){if(l=1!==l||!q.isXMLDoc(a))c=q.propFix[c]||c,f=q.propHooks[c];return d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]}},propHooks:{tabIndex:{get:function(a){var b=
q.find.attr(a,"tabindex");return b?parseInt(b,10):sb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}}});Cb={set:function(a,b,c){!1===b?q.removeAttr(a,c):sc&&gb||!kb.test(c)?a.setAttribute(!gb&&q.propFix[c]||c,c):a[q.camelCase("default-"+c)]=a[c]=!0;return c}};q.each(q.expr.match.bool.source.match(/\w+/g),function(a,c){var d=q.expr.attrHandle[c]||q.find.attr;q.expr.attrHandle[c]=sc&&gb||!kb.test(c)?function(a,c,e){var f=q.expr.attrHandle[c];a=e?b:(q.expr.attrHandle[c]=b)!=d(a,c,e)?c.toLowerCase():
null;q.expr.attrHandle[c]=f;return a}:function(a,c,d){return d?b:a[q.camelCase("default-"+c)]?c.toLowerCase():null}});sc&&gb||(q.attrHooks.value={set:function(a,b,c){if(q.nodeName(a,"input"))a.defaultValue=b;else return Ja&&Ja.set(a,b,c)}});gb||(Ja={set:function(a,c,d){var e=a.getAttributeNode(d);e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d));e.value=c+="";return"value"===d||c===a.getAttribute(d)?c:b}},q.expr.attrHandle.id=q.expr.attrHandle.name=q.expr.attrHandle.coords=function(a,c,
d){var e;return d?b:(e=a.getAttributeNode(c))&&""!==e.value?e.value:null},q.valHooks.button={get:function(a,c){var d=a.getAttributeNode(c);return d&&d.specified?d.value:b},set:Ja.set},q.attrHooks.contenteditable={set:function(a,b,c){Ja.set(a,""===b?!1:b,c)}},q.each(["width","height"],function(a,b){q.attrHooks[b]={set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}}}));q.support.hrefNormalized||q.each(["href","src"],function(a,b){q.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}});
q.support.style||(q.attrHooks.style={get:function(a){return a.style.cssText||b},set:function(a,b){return a.style.cssText=b+""}});q.support.optSelected||(q.propHooks.selected={get:function(a){if(a=a.parentNode)a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex;return null}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){q.propFix[this.toLowerCase()]=this});q.support.enctype||(q.propFix.enctype="encoding");
q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(a,b){if(q.isArray(b))return a.checked=0<=q.inArray(q(a).val(),b)}};q.support.checkOn||(q.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var tc=/^(?:input|select|textarea)$/i,ic=/^key/,jc=/^(?:mouse|contextmenu)|click/,uc=/^(?:focusinfocus|focusoutblur)$/,kc=/^([^.]*)(?:\.(.+)|)$/;q.event={global:{},add:function(a,c,d,e,f){var l,p,m,n,r,t,u,s,z;if(m=q._data(a)){d.handler&&(n=d,d=n.handler,f=
n.selector);d.guid||(d.guid=q.guid++);(p=m.events)||(p=m.events={});(r=m.handle)||(r=m.handle=function(a){return typeof q===ga||a&&q.event.triggered===a.type?b:q.event.dispatch.apply(r.elem,arguments)},r.elem=a);c=(c||"").match(sa)||[""];for(m=c.length;m--;)l=kc.exec(c[m])||[],s=t=l[1],z=(l[2]||"").split(".").sort(),s&&(l=q.event.special[s]||{},s=(f?l.delegateType:l.bindType)||s,l=q.event.special[s]||{},t=q.extend({type:s,origType:t,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&q.expr.match.needsContext.test(f),
namespace:z.join(".")},n),(u=p[s])||(u=p[s]=[],u.delegateCount=0,l.setup&&!1!==l.setup.call(a,e,z,r)||(a.addEventListener?a.addEventListener(s,r,!1):a.attachEvent&&a.attachEvent("on"+s,r))),l.add&&(l.add.call(a,t),t.handler.guid||(t.handler.guid=d.guid)),f?u.splice(u.delegateCount++,0,t):u.push(t),q.event.global[s]=!0);a=null}},remove:function(a,b,c,d,e){var f,l,p,m,n,r,t,u,s,z,Ea,C=q.hasData(a)&&q._data(a);if(C&&(r=C.events)){b=(b||"").match(sa)||[""];for(n=b.length;n--;)if(p=kc.exec(b[n])||[],s=
Ea=p[1],z=(p[2]||"").split(".").sort(),s){t=q.event.special[s]||{};s=(d?t.delegateType:t.bindType)||s;u=r[s]||[];p=p[2]&&RegExp("(^|\\.)"+z.join("\\.(?:.*\\.|)")+"(\\.|$)");for(m=f=u.length;f--;)l=u[f],!e&&Ea!==l.origType||(c&&c.guid!==l.guid||p&&!p.test(l.namespace)||d&&!(d===l.selector||"**"===d&&l.selector))||(u.splice(f,1),l.selector&&u.delegateCount--,t.remove&&t.remove.call(a,l));m&&!u.length&&(t.teardown&&!1!==t.teardown.call(a,z,C.handle)||q.removeEvent(a,s,C.handle),delete r[s])}else for(s in r)q.event.remove(a,
s+b[n],c,d,!0);q.isEmptyObject(r)&&(delete C.handle,q._removeData(a,"events"))}},trigger:function(c,d,e,f){var l,p,m,n,r,t,u=[e||ia],s=wa.call(c,"type")?c.type:c;r=wa.call(c,"namespace")?c.namespace.split("."):[];m=l=e=e||ia;if(3!==e.nodeType&&8!==e.nodeType&&!uc.test(s+q.event.triggered)&&(0<=s.indexOf(".")&&(r=s.split("."),s=r.shift(),r.sort()),p=0>s.indexOf(":")&&"on"+s,c=c[q.expando]?c:new q.Event(s,"object"===typeof c&&c),c.isTrigger=f?2:3,c.namespace=r.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+
r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:q.makeArray(d,[c]),r=q.event.special[s]||{},f||!r.trigger||!1!==r.trigger.apply(e,d))){if(!f&&!r.noBubble&&!q.isWindow(e)){n=r.delegateType||s;uc.test(n+s)||(m=m.parentNode);for(;m;m=m.parentNode)u.push(m),l=m;l===(e.ownerDocument||ia)&&u.push(l.defaultView||l.parentWindow||a)}for(t=0;(m=u[t++])&&!c.isPropagationStopped();)c.type=1<t?n:r.bindType||s,(l=(q._data(m,"events")||{})[c.type]&&q._data(m,"handle"))&&l.apply(m,
d),(l=p&&m[p])&&(q.acceptData(m)&&l.apply&&!1===l.apply(m,d))&&c.preventDefault();c.type=s;if(!f&&!c.isDefaultPrevented()&&(!r._default||!1===r._default.apply(u.pop(),d))&&q.acceptData(e)&&p&&e[s]&&!q.isWindow(e)){(l=e[p])&&(e[p]=null);q.event.triggered=s;try{e[s]()}catch(z){}q.event.triggered=b;l&&(e[p]=l)}return c.result}},dispatch:function(a){a=q.event.fix(a);var c,d,e,f,l=[],p=ha.call(arguments);c=(q._data(this,"events")||{})[a.type]||[];var m=q.event.special[a.type]||{};p[0]=a;a.delegateTarget=
this;if(!m.preDispatch||!1!==m.preDispatch.call(this,a)){l=q.event.handlers.call(this,a,c);for(c=0;(e=l[c++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((q.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,p),d!==b&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());m.postDispatch&&m.postDispatch.call(this,a);return a.result}},
handlers:function(a,c){var d,e,f,l,p=[],m=c.delegateCount,n=a.target;if(m&&n.nodeType&&(!a.button||"click"!==a.type))for(;n!=this;n=n.parentNode||this)if(1===n.nodeType&&(!0!==n.disabled||"click"!==a.type)){f=[];for(l=0;l<m;l++)e=c[l],d=e.selector+" ",f[d]===b&&(f[d]=e.needsContext?0<=q(d,this).index(n):q.find(d,this,null,[n]).length),f[d]&&f.push(e);f.length&&p.push({elem:n,handlers:f})}m<c.length&&p.push({elem:this,handlers:c.slice(m)});return p},fix:function(a){if(a[q.expando])return a;var b,c,
d;b=a.type;var e=a,f=this.fixHooks[b];f||(this.fixHooks[b]=f=jc.test(b)?this.mouseHooks:ic.test(b)?this.keyHooks:{});d=f.props?this.props.concat(f.props):this.props;a=new q.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];a.target||(a.target=e.srcElement||ia);3===a.target.nodeType&&(a.target=a.target.parentNode);a.metaKey=!!a.metaKey;return f.filter?f.filter(a,e):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f=c.button,l=c.fromElement;null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||ia,e=d.documentElement,d=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||
d&&d.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0));!a.relatedTarget&&l&&(a.relatedTarget=l===a.target?c.toElement:l);a.which||f===b||(a.which=f&1?1:f&2?3:f&4?2:0);return a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==r()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){if(this===r()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(q.nodeName(this,
"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(a){return q.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=q.extend(new q.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?q.event.trigger(a,null,b):q.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};q.removeEvent=ia.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,
c,!1)}:function(a,b,c){b="on"+b;a.detachEvent&&(typeof a[b]===ga&&(a[b]=null),a.detachEvent(b,c))};q.Event=function(a,b){if(!(this instanceof q.Event))return new q.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?n:p):this.type=a;b&&q.extend(this,b);this.timeStamp=a&&a.timeStamp||q.now();this[q.expando]=!0};q.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,
preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=n;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=n;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n;this.stopPropagation()}};q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){q.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,
d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!q.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});q.support.submitBubbles||(q.event.special.submit={setup:function(){if(q.nodeName(this,"form"))return!1;q.event.add(this,"click._submit keypress._submit",function(a){a=a.target;(a=q.nodeName(a,"input")||q.nodeName(a,"button")?a.form:b)&&!q._data(a,"submitBubbles")&&(q.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),q._data(a,"submitBubbles",!0))})},
postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&q.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(q.nodeName(this,"form"))return!1;q.event.remove(this,"._submit")}});q.support.changeBubbles||(q.event.special.change={setup:function(){if(tc.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)q.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),
q.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);q.event.simulate("change",this,a,!0)});return!1}q.event.add(this,"beforeactivate._change",function(a){a=a.target;tc.test(a.nodeName)&&!q._data(a,"changeBubbles")&&(q.event.add(a,"change._change",function(a){!this.parentNode||(a.isSimulated||a.isTrigger)||q.event.simulate("change",this.parentNode,a,!0)}),q._data(a,"changeBubbles",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||
a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){q.event.remove(this,"._change");return!tc.test(this.nodeName)}});q.support.focusinBubbles||q.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){q.event.simulate(b,a.target,q.event.fix(a),!0)};q.event.special[b]={setup:function(){0===c++&&ia.addEventListener(a,d,!0)},teardown:function(){0===--c&&ia.removeEventListener(a,d,!0)}}});q.fn.extend({on:function(a,
c,d,e,f){var l,m;if("object"===typeof a){"string"!==typeof c&&(d=d||c,c=b);for(l in a)this.on(l,c,d,a[l],f);return this}null==d&&null==e?(e=c,d=c=b):null==e&&("string"===typeof c?(e=d,d=b):(e=d,d=c,c=b));if(!1===e)e=p;else if(!e)return this;1===f&&(m=e,e=function(a){q().off(a);return m.apply(this,arguments)},e.guid=m.guid||(m.guid=q.guid++));return this.each(function(){q.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e;if(a&&a.preventDefault&&a.handleObj)return e=
a.handleObj,q(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"===typeof a){for(e in a)this.off(e,c,a[e]);return this}if(!1===c||"function"===typeof c)d=c,c=b;!1===d&&(d=p);return this.each(function(){q.event.remove(this,a,d,c)})},trigger:function(a,b){return this.each(function(){q.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return q.event.trigger(a,b,c,!0)}});var Gc=/^.[^:#\[\.,]*$/,lc=/^(?:parents|prev(?:Until|All))/,
$b=q.expr.match.needsContext,mc={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!==typeof a)return this.pushStack(q(a).filter(function(){for(b=0;b<e;b++)if(q.contains(d[b],this))return!0}));for(b=0;b<e;b++)q.find(a,d[b],c);c=this.pushStack(1<e?q.unique(c):c);c.selector=this.selector?this.selector+" "+a:a;return c},has:function(a){var b,c=q(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(q.contains(this,c[b]))return!0})},
not:function(a){return this.pushStack(u(this,a||[],!0))},filter:function(a){return this.pushStack(u(this,a||[],!1))},is:function(a){return!!u(this,"string"===typeof a&&$b.test(a)?q(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],l=$b.test(a)||"string"!==typeof a?q(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(l?-1<l.index(c):1===c.nodeType&&q.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?q.unique(f):
f)},index:function(a){return a?"string"===typeof a?q.inArray(this[0],q(a)):q.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"===typeof a?q(a,b):q.makeArray(a&&a.nodeType?[a]:a),c=q.merge(this.get(),c);return this.pushStack(q.unique(c))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});q.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return q.dir(a,
"parentNode")},parentsUntil:function(a,b,c){return q.dir(a,"parentNode",c)},next:function(a){return t(a,"nextSibling")},prev:function(a){return t(a,"previousSibling")},nextAll:function(a){return q.dir(a,"nextSibling")},prevAll:function(a){return q.dir(a,"previousSibling")},nextUntil:function(a,b,c){return q.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return q.dir(a,"previousSibling",c)},siblings:function(a){return q.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return q.sibling(a.firstChild)},
contents:function(a){return q.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:q.merge([],a.childNodes)}},function(a,b){q.fn[a]=function(c,d){var e=q.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(e=q.filter(d,e));1<this.length&&(mc[a]||(e=q.unique(e)),lc.test(a)&&(e=e.reverse()));return this.pushStack(e)}});q.extend({filter:function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?q.find.matchesSelector(d,a)?[d]:[]:q.find.matches(a,q.grep(b,
function(a){return 1===a.nodeType}))},dir:function(a,c,d){var e=[];for(a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!q(a).is(d));)1===a.nodeType&&e.push(a),a=a[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var yc="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",nc=/ jQuery\d+="(?:null|\d+)"/g,Ea=RegExp("<(?:"+yc+")[\\s/>]",
"i"),mb=/^\s+/,Za=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ga=/<([\w:]+)/,vc=/<tbody/i,yb=/<|&#?\w+;/,Ca=/<(?:script|style|link)/i,Jb=/^(?:checkbox|radio)$/i,ac=/checked\s*(?:[^=]|=\s*.checked.)/i,Cc=/^$|\/(?:java|ecma)script/i,zc=/^true\/(.*)/,Sb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,zb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],
tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:q.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Jc=z(ia).appendChild(ia.createElement("div"));zb.optgroup=zb.option;zb.tbody=zb.tfoot=zb.colgroup=zb.caption=zb.thead;zb.th=zb.td;q.fn.extend({text:function(a){return q.access(this,function(a){return a===b?q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ia).createTextNode(a))},
null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||E(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=E(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,
function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?q.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||q.cleanData(I(c)),c.parentNode&&(b&&q.contains(c.ownerDocument,c)&&B(I(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&q.cleanData(I(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&q.nodeName(a,"select")&&(a.options.length=0)}return this},
clone:function(a,b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return q.clone(this,a,b)})},html:function(a){return q.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(nc,""):b;if("string"===typeof a&&!(Ca.test(a)||!q.support.htmlSerialize&&Ea.test(a)||!q.support.leadingWhitespace&&mb.test(a)||zb[(Ga.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Za,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},1===c.nodeType&&(q.cleanData(I(c,
!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=q.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),q(this).remove(),e.insertBefore(c,d))},!0);return b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){a=ya.apply([],a);var d,e,f,l,p=0,m=this.length,n=this,r=m-1,t=a[0],u=q.isFunction(t);
if(u||!(1>=m||"string"!==typeof t||q.support.checkClone||!ac.test(t)))return this.each(function(d){var e=n.eq(d);u&&(a[0]=t.call(this,d,e.html()));e.domManip(a,b,c)});if(m&&(l=q.buildFragment(a,this[0].ownerDocument,!1,!c&&this),d=l.firstChild,1===l.childNodes.length&&(l=d),d)){f=q.map(I(l,"script"),C);for(e=f.length;p<m;p++)d=l,p!==r&&(d=q.clone(d,!0,!0),e&&q.merge(f,I(d,"script"))),b.call(this[p],d,p);if(e)for(l=f[f.length-1].ownerDocument,q.map(f,A),p=0;p<e;p++)d=f[p],Cc.test(d.type||"")&&(!q._data(d,
"globalEval")&&q.contains(l,d))&&(d.src?q._evalUrl(d.src):q.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Sb,"")));l=d=null}return this}});q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){q.fn[a]=function(a){for(var c=0,d=[],e=q(a),f=e.length-1;c<=f;c++)a=c===f?this:this.clone(!0),q(e[c])[b](a),na.apply(d,a.get());return this.pushStack(d)}});q.extend({clone:function(a,b,c){var d,e,f,l,p,m=q.contains(a.ownerDocument,
a);q.support.html5Clone||q.isXMLDoc(a)||!Ea.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(Jc.innerHTML=a.outerHTML,Jc.removeChild(f=Jc.firstChild));if(!(q.support.noCloneEvent&&q.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||q.isXMLDoc(a)))for(d=I(f),p=I(a),l=0;null!=(e=p[l]);++l)if(d[l]){var n=d[l],r=void 0,t=void 0,u=void 0;if(1===n.nodeType){r=n.nodeName.toLowerCase();if(!q.support.noCloneEvent&&n[q.expando]){u=q._data(n);for(t in u.events)q.removeEvent(n,t,u.handle);n.removeAttribute(q.expando)}if("script"===
r&&n.text!==e.text)C(n).text=e.text,A(n);else if("object"===r)n.parentNode&&(n.outerHTML=e.outerHTML),q.support.html5Clone&&(e.innerHTML&&!q.trim(n.innerHTML))&&(n.innerHTML=e.innerHTML);else if("input"===r&&Jb.test(e.type))n.defaultChecked=n.checked=e.checked,n.value!==e.value&&(n.value=e.value);else if("option"===r)n.defaultSelected=n.selected=e.defaultSelected;else if("input"===r||"textarea"===r)n.defaultValue=e.defaultValue}}if(b)if(c)for(p=p||I(a),d=d||I(f),l=0;null!=(e=p[l]);l++)F(e,d[l]);else F(a,
f);d=I(f,"script");0<d.length&&B(d,!m&&I(a,"script"));return f},buildFragment:function(a,b,c,d){for(var e,f,l,p,m,n,r=a.length,t=z(b),u=[],s=0;s<r;s++)if((f=a[s])||0===f)if("object"===q.type(f))q.merge(u,f.nodeType?[f]:f);else if(yb.test(f)){l=l||t.appendChild(b.createElement("div"));p=(Ga.exec(f)||["",""])[1].toLowerCase();n=zb[p]||zb._default;l.innerHTML=n[1]+f.replace(Za,"<$1></$2>")+n[2];for(e=n[0];e--;)l=l.lastChild;!q.support.leadingWhitespace&&mb.test(f)&&u.push(b.createTextNode(mb.exec(f)[0]));
if(!q.support.tbody)for(e=(f="table"!==p||vc.test(f)?"<table>"!==n[1]||vc.test(f)?0:l:l.firstChild)&&f.childNodes.length;e--;)q.nodeName(m=f.childNodes[e],"tbody")&&!m.childNodes.length&&f.removeChild(m);q.merge(u,l.childNodes);for(l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=t.lastChild}else u.push(b.createTextNode(f));l&&t.removeChild(l);q.support.appendChecked||q.grep(I(u,"input"),J);for(s=0;f=u[s++];)if(!d||-1===q.inArray(f,d))if(a=q.contains(f.ownerDocument,f),l=I(t.appendChild(f),
"script"),a&&B(l),c)for(e=0;f=l[e++];)Cc.test(f.type||"")&&c.push(f);return t},cleanData:function(a,b){for(var c,d,e,f,l=0,p=q.expando,m=q.cache,n=q.support.deleteExpando,r=q.event.special;null!=(c=a[l]);l++)if(b||q.acceptData(c))if(f=(e=c[p])&&m[e]){if(f.events)for(d in f.events)r[d]?q.event.remove(c,d):q.removeEvent(c,d,f.handle);m[e]&&(delete m[e],n?delete c[p]:typeof c.removeAttribute!==ga?c.removeAttribute(p):c[p]=null,ta.push(e))}},_evalUrl:function(a){return q.ajax({url:a,type:"GET",dataType:"script",
async:!1,global:!1,"throws":!0})}});q.fn.extend({wrapAll:function(a){if(q.isFunction(a))return this.each(function(b){q(this).wrapAll(a.call(this,b))});if(this[0]){var b=q(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return q.isFunction(a)?this.each(function(b){q(this).wrapInner(a.call(this,b))}):this.each(function(){var b=
q(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=q.isFunction(a);return this.each(function(c){q(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){q.nodeName(this,"body")||q(this).replaceWith(this.childNodes)}).end()}});var gc,Xb,Ob,Tb=/alpha\([^)]*\)/i,$d=/opacity\s*=\s*([^)]*)/,ae=/^(top|right|bottom|left)$/,ld=/^(none|table(?!-c[ea]).+)/,Ad=/^margin/,Od=RegExp("^("+db+")(.*)$","i"),Wc=RegExp("^("+db+")(?!px)[a-z%]+$","i"),
be=RegExp("^([+-])=("+db+")","i"),R={BODY:"block"},bc={position:"absolute",visibility:"hidden",display:"block"},Bd={letterSpacing:0,fontWeight:400},Wb=["Top","Right","Bottom","Left"],sd=["Webkit","O","Moz","ms"];q.fn.extend({css:function(a,c){return q.access(this,function(a,c,d){var e,f={},l=0;if(q.isArray(c)){e=Xb(a);for(d=c.length;l<d;l++)f[c[l]]=q.css(a,c[l],!1,e);return f}return d!==b?q.style(a,c,d):q.css(a,c)},a,c,1<arguments.length)},show:function(){return M(this,!0)},hide:function(){return M(this)},
toggle:function(a){var b="boolean"===typeof a;return this.each(function(){(b?a:P(this))?q(this).show():q(this).hide()})}});q.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ob(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":q.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,l,p,m=q.camelCase(c),
n=a.style;c=q.cssProps[m]||(q.cssProps[m]=D(n,m));p=q.cssHooks[c]||q.cssHooks[m];if(d!==b){if(l=typeof d,"string"===l&&(f=be.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(q.css(a,c)),l="number"),!(null==d||"number"===l&&isNaN(d)||("number"!==l||q.cssNumber[m]||(d+="px"),q.support.clearCloneStyle||(""!==d||0!==c.indexOf("background"))||(n[c]="inherit"),p&&"set"in p&&(d=p.set(a,d,e))===b)))try{n[c]=d}catch(r){}}else return p&&"get"in p&&(f=p.get(a,!1,e))!==b?f:n[c]}},css:function(a,c,d,e){var f,l;l=q.camelCase(c);
c=q.cssProps[l]||(q.cssProps[l]=D(a.style,l));(l=q.cssHooks[c]||q.cssHooks[l])&&"get"in l&&(f=l.get(a,!0,d));f===b&&(f=Ob(a,c,e));"normal"===f&&c in Bd&&(f=Bd[c]);return""===d||d?(a=parseFloat(f),!0===d||q.isNumeric(a)?a||0:f):f}});a.getComputedStyle?(Xb=function(b){return a.getComputedStyle(b,null)},Ob=function(a,c,d){var e,f=(d=d||Xb(a))?d.getPropertyValue(c)||d[c]:b,l=a.style;d&&(""!==f||q.contains(a.ownerDocument,a)||(f=q.style(a,c)),Wc.test(f)&&Ad.test(c)&&(a=l.width,c=l.minWidth,e=l.maxWidth,
l.minWidth=l.maxWidth=l.width=f,f=d.width,l.width=a,l.minWidth=c,l.maxWidth=e));return f}):ia.documentElement.currentStyle&&(Xb=function(a){return a.currentStyle},Ob=function(a,c,d){var e,f,l=(d=d||Xb(a))?d[c]:b,p=a.style;null==l&&(p&&p[c])&&(l=p[c]);if(Wc.test(l)&&!ae.test(c)){d=p.left;if(f=(e=a.runtimeStyle)&&e.left)e.left=a.currentStyle.left;p.left="fontSize"===c?"1em":l;l=p.pixelLeft+"px";p.left=d;f&&(e.left=f)}return""===l?"auto":l});q.each(["height","width"],function(a,b){q.cssHooks[b]={get:function(a,
c,d){if(c)return 0===a.offsetWidth&&ld.test(q.css(a,"display"))?q.swap(a,bc,function(){return Y(a,b,d)}):Y(a,b,d)},set:function(a,c,d){var e=d&&Xb(a);return G(a,c,d?K(a,b,d,q.support.boxSizing&&"border-box"===q.css(a,"boxSizing",!1,e),e):0)}}});q.support.opacity||(q.cssHooks.opacity={get:function(a,b){return $d.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=q.isNumeric(b)?"alpha(opacity="+
100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if((1<=b||""===b)&&(""===q.trim(f.replace(Tb,""))&&c.removeAttribute)&&(c.removeAttribute("filter"),""===b||d&&!d.filter))return;c.filter=Tb.test(f)?f.replace(Tb,e):f+" "+e}});q(function(){q.support.reliableMarginRight||(q.cssHooks.marginRight={get:function(a,b){if(b)return q.swap(a,{display:"inline-block"},Ob,[a,"marginRight"])}});!q.support.pixelPosition&&q.fn.position&&q.each(["top","left"],function(a,b){q.cssHooks[b]={get:function(a,c){if(c)return c=
Ob(a,b),Wc.test(c)?q(a).position()[b]+"px":c}}})});q.expr&&q.expr.filters&&(q.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!q.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||q.css(a,"display"))},q.expr.filters.visible=function(a){return!q.expr.filters.hidden(a)});q.each({margin:"",padding:"",border:"Width"},function(a,b){q.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)e[a+Wb[d]+b]=c[d]||c[d-2]||c[0];
return e}};Ad.test(a)||(q.cssHooks[a+b].set=G)});var ce=/%20/g,Pd=/\[\]$/,Cd=/\r?\n/g,de=/^(?:submit|button|image|reset|file)$/i,ee=/^(?:input|select|textarea|keygen)/i;q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=q.prop(this,"elements");return a?q.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!q(this).is(":disabled")&&ee.test(this.nodeName)&&!de.test(a)&&(this.checked||!Jb.test(a))}).map(function(a,
b){var c=q(this).val();return null==c?null:q.isArray(c)?q.map(c,function(a){return{name:b.name,value:a.replace(Cd,"\r\n")}}):{name:b.name,value:c.replace(Cd,"\r\n")}}).get()}});q.param=function(a,c){var d,e=[],f=function(a,b){b=q.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=q.ajaxSettings&&q.ajaxSettings.traditional);if(q.isArray(a)||a.jquery&&!q.isPlainObject(a))q.each(a,function(){f(this.name,this.value)});else for(d in a)fa(d,a[d],c,f);return e.join("&").replace(ce,
"+")};q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){q.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}});q.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},
delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Dc,ba,ea=q.now(),ca=/\?/,fe=/#.*$/,Dd=/([?&])_=[^&]*/,ge=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,he=/^(?:GET|HEAD)$/,ie=/^\/\//,Ed=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Fd=q.fn.load,Gd={},jd={},Hd="*/".concat("*");try{ba=va.href}catch(le){ba=ia.createElement("a"),ba.href="",ba=ba.href}Dc=Ed.exec(ba.toLowerCase())||[];q.fn.load=function(a,c,d){if("string"!==
typeof a&&Fd)return Fd.apply(this,arguments);var e,f,l,p=this,m=a.indexOf(" ");0<=m&&(e=a.slice(m,a.length),a=a.slice(0,m));q.isFunction(c)?(d=c,c=b):c&&"object"===typeof c&&(l="POST");0<p.length&&q.ajax({url:a,type:l,dataType:"html",data:c}).done(function(a){f=arguments;p.html(e?q("<div>").append(q.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){p.each(d,f||[a.responseText,b,a])});return this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){q.fn[b]=
function(a){return this.on(b,a)}});q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ba,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Dc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Hd,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",
json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":q.parseJSON,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Q(Q(a,q.ajaxSettings),b):Q(q.ajaxSettings,a)},ajaxPrefilter:S(Gd),ajaxTransport:S(jd),ajax:function(a,c){function d(a,c,e,f){var t,E,A,da;da=c;if(2!==I){I=2;m&&clearTimeout(m);r=b;p=f||"";B.readyState=0<a?4:0;f=200<=a&&300>a||304===a;if(e){A=u;for(var J=B,Za,F,G,Ga,P=A.contents,W=A.dataTypes;"*"===W[0];)W.shift(),F===b&&(F=
A.mimeType||J.getResponseHeader("Content-Type"));if(F)for(Ga in P)if(P[Ga]&&P[Ga].test(F)){W.unshift(Ga);break}if(W[0]in e)G=W[0];else{for(Ga in e){if(!W[0]||A.converters[Ga+" "+W[0]]){G=Ga;break}Za||(Za=Ga)}G=G||Za}G?(G!==W[0]&&W.unshift(G),A=e[G]):A=void 0}a:{e=u;Za=A;F=B;G=f;var ac,ka,M,J={},P=e.dataTypes.slice();if(P[1])for(ka in e.converters)J[ka.toLowerCase()]=e.converters[ka];for(Ga=P.shift();Ga;)if(e.responseFields[Ga]&&(F[e.responseFields[Ga]]=Za),!M&&(G&&e.dataFilter)&&(Za=e.dataFilter(Za,
e.dataType)),M=Ga,Ga=P.shift())if("*"===Ga)Ga=M;else if("*"!==M&&M!==Ga){ka=J[M+" "+Ga]||J["* "+Ga];if(!ka)for(ac in J)if(A=ac.split(" "),A[1]===Ga&&(ka=J[M+" "+A[0]]||J["* "+A[0]])){!0===ka?ka=J[ac]:!0!==J[ac]&&(Ga=A[0],P.unshift(A[1]));break}if(!0!==ka)if(ka&&e["throws"])Za=ka(Za);else try{Za=ka(Za)}catch(yb){A={state:"parsererror",error:ka?yb:"No conversion from "+M+" to "+Ga};break a}}A={state:"success",data:Za}}if(f)u.ifModified&&((da=B.getResponseHeader("Last-Modified"))&&(q.lastModified[l]=
da),(da=B.getResponseHeader("etag"))&&(q.etag[l]=da)),204===a||"HEAD"===u.type?da="nocontent":304===a?da="notmodified":(da=A.state,t=A.data,E=A.error,f=!E);else if(E=da,a||!da)da="error",0>a&&(a=0);B.status=a;B.statusText=(c||da)+"";f?Ea.resolveWith(s,[t,da,B]):Ea.rejectWith(s,[B,da,E]);B.statusCode(D);D=b;n&&z.trigger(f?"ajaxSuccess":"ajaxError",[B,u,f?t:E]);C.fireWith(s,[B,da]);n&&(z.trigger("ajaxComplete",[B,u]),--q.active||q.event.trigger("ajaxStop"))}}"object"===typeof a&&(c=a,a=b);c=c||{};var e,
f,l,p,m,n,r,t,u=q.ajaxSetup({},c),s=u.context||u,z=u.context&&(s.nodeType||s.jquery)?q(s):q.event,Ea=q.Deferred(),C=q.Callbacks("once memory"),D=u.statusCode||{},E={},A={},I=0,da="canceled",B={readyState:0,getResponseHeader:function(a){var b;if(2===I){if(!t)for(t={};b=ge.exec(p);)t[b[1].toLowerCase()]=b[2];b=t[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===I?p:null},setRequestHeader:function(a,b){var c=a.toLowerCase();I||(a=A[c]=A[c]||a,E[a]=b);return this},overrideMimeType:function(a){I||
(u.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>I)for(b in a)D[b]=[D[b],a[b]];else B.always(a[B.status]);return this},abort:function(a){a=a||da;r&&r.abort(a);d(0,a);return this}};Ea.promise(B).complete=C.add;B.success=B.done;B.error=B.fail;u.url=((a||u.url||ba)+"").replace(fe,"").replace(ie,Dc[1]+"//");u.type=c.method||c.type||u.method||u.type;u.dataTypes=q.trim(u.dataType||"*").toLowerCase().match(sa)||[""];null==u.crossDomain&&(e=Ed.exec(u.url.toLowerCase()),u.crossDomain=!(!e||
e[1]===Dc[1]&&e[2]===Dc[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(Dc[3]||("http:"===Dc[1]?"80":"443"))));u.data&&(u.processData&&"string"!==typeof u.data)&&(u.data=q.param(u.data,u.traditional));X(Gd,u,c,B);if(2===I)return B;(n=u.global)&&0===q.active++&&q.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!he.test(u.type);l=u.url;u.hasContent||(u.data&&(l=u.url+=(ca.test(l)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=Dd.test(l)?l.replace(Dd,"$1_="+ea++):l+(ca.test(l)?"&":
"?")+"_="+ea++));u.ifModified&&(q.lastModified[l]&&B.setRequestHeader("If-Modified-Since",q.lastModified[l]),q.etag[l]&&B.setRequestHeader("If-None-Match",q.etag[l]));(u.data&&u.hasContent&&!1!==u.contentType||c.contentType)&&B.setRequestHeader("Content-Type",u.contentType);B.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Hd+"; q=0.01":""):u.accepts["*"]);for(f in u.headers)B.setRequestHeader(f,u.headers[f]);if(u.beforeSend&&
(!1===u.beforeSend.call(s,B,u)||2===I))return B.abort();da="abort";for(f in{success:1,error:1,complete:1})B[f](u[f]);if(r=X(jd,u,c,B)){B.readyState=1;n&&z.trigger("ajaxSend",[B,u]);u.async&&0<u.timeout&&(m=setTimeout(function(){B.abort("timeout")},u.timeout));try{I=1,r.send(E,d)}catch(J){if(2>I)d(-1,J);else throw J;}}else d(-1,"No Transport");return B},getJSON:function(a,b,c){return q.get(a,b,c,"json")},getScript:function(a,c){return q.get(a,b,c,"script")}});q.each(["get","post"],function(a,c){q[c]=
function(a,d,e,f){q.isFunction(d)&&(f=f||e,e=d,d=b);return q.ajax({url:a,type:c,dataType:f,data:d,success:e})}});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){q.globalEval(a);return a}}});q.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});q.ajaxTransport("script",function(a){if(a.crossDomain){var c,
d=ia.head||q("head")[0]||ia.documentElement;return{send:function(b,e){c=ia.createElement("script");c.async=!0;a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,b){if(b||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,b||e(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(b,!0)}}}});var Id=[],md=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var a=Id.pop()||q.expando+"_"+ea++;this[a]=!0;return a}});q.ajaxPrefilter("json jsonp",function(c,d,e){var f,l,p,m=!1!==c.jsonp&&(md.test(c.url)?"url":"string"===typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&md.test(c.data)&&"data");if(m||"jsonp"===c.dataTypes[0])return f=c.jsonpCallback=q.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,m?c[m]=c[m].replace(md,"$1"+f):!1!==c.jsonp&&(c.url+=(ca.test(c.url)?"&":"?")+c.jsonp+"="+
f),c.converters["script json"]=function(){p||q.error(f+" was not called");return p[0]},c.dataTypes[0]="json",l=a[f],a[f]=function(){p=arguments},e.always(function(){a[f]=l;c[f]&&(c.jsonpCallback=d.jsonpCallback,Id.push(f));p&&q.isFunction(l)&&l(p[0]);p=l=b}),"script"});var Kc,Uc,je=0,nd=a.ActiveXObject&&function(){for(var a in Kc)Kc[a](b,!0)};q.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&Z()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:
Z;Uc=q.ajaxSettings.xhr();q.support.cors=!!Uc&&"withCredentials"in Uc;(Uc=q.support.ajax=!!Uc)&&q.ajaxTransport(function(c){if(!c.crossDomain||q.support.cors){var d;return{send:function(e,f){var l,p,m=c.xhr();c.username?m.open(c.type,c.url,c.async,c.username,c.password):m.open(c.type,c.url,c.async);if(c.xhrFields)for(p in c.xhrFields)m[p]=c.xhrFields[p];c.mimeType&&m.overrideMimeType&&m.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(p in e)m.setRequestHeader(p,
e[p])}catch(n){}m.send(c.hasContent&&c.data||null);d=function(a,e){var p,n,r,u;try{if(d&&(e||4===m.readyState))if(d=b,l&&(m.onreadystatechange=q.noop,nd&&delete Kc[l]),e)4!==m.readyState&&m.abort();else{u={};p=m.status;n=m.getAllResponseHeaders();"string"===typeof m.responseText&&(u.text=m.responseText);try{r=m.statusText}catch(t){r=""}p||!c.isLocal||c.crossDomain?1223===p&&(p=204):p=u.text?200:404}}catch(s){e||f(-1,s)}u&&f(p,r,u,n)};c.async?4===m.readyState?setTimeout(d):(l=++je,nd&&(Kc||(Kc={},
q(a).unload(nd)),Kc[l]=d),m.onreadystatechange=d):d()},abort:function(){d&&d(b,!0)}}}});var Hc,gd,ke=/^(?:toggle|show|hide)$/,Jd=RegExp("^(?:([+-])=|)("+db+")([a-z%]*)$","i"),La=/queueHooks$/,Xc=[function(a,b,c){var d,e,f,l,p,m=this,n={},r=a.style,u=a.nodeType&&P(a),t=q._data(a,"fxshow");c.queue||(l=q._queueHooks(a,"fx"),null==l.unqueued&&(l.unqueued=0,p=l.empty.fire,l.empty.fire=function(){l.unqueued||p()}),l.unqueued++,m.always(function(){m.always(function(){l.unqueued--;q.queue(a,"fx").length||
l.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[r.overflow,r.overflowX,r.overflowY],"inline"===q.css(a,"display")&&"none"===q.css(a,"float")&&(q.support.inlineBlockNeedsLayout&&"inline"!==T(a.nodeName)?r.zoom=1:r.display="inline-block"));c.overflow&&(r.overflow="hidden",q.support.shrinkWrapBlocks||m.always(function(){r.overflow=c.overflow[0];r.overflowX=c.overflow[1];r.overflowY=c.overflow[2]}));for(d in b)e=b[d],ke.exec(e)&&(delete b[d],f=f||"toggle"===e,e!==(u?"hide":
"show")&&(n[d]=t&&t[d]||q.style(a,d)));if(!q.isEmptyObject(n))for(d in t?"hidden"in t&&(u=t.hidden):t=q._data(a,"fxshow",{}),f&&(t.hidden=!u),u?q(a).show():m.done(function(){q(a).hide()}),m.done(function(){var b;q._removeData(a,"fxshow");for(b in n)q.style(a,b,n[b])}),n)b=da(u?t[d]:0,d,m),d in t||(t[d]=b.start,u&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],Nc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Jd.exec(b),f=e&&e[3]||(q.cssNumber[a]?"":"px"),l=(q.cssNumber[a]||
"px"!==f&&+d)&&Jd.exec(q.css(c.elem,a)),p=1,m=20;if(l&&l[3]!==f){f=f||l[3];e=e||[];l=+d||1;do p=p||".5",l/=p,q.style(c.elem,a,l+f);while(p!==(p=c.cur()/d)&&1!==p&&--m)}e&&(l=c.start=+l||+d||0,c.unit=f,c.end=e[1]?l+(e[1]+1)*e[2]:+e[2]);return c}]};q.Animation=q.extend(W,{tweener:function(a,b){q.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],Nc[c]=Nc[c]||[],Nc[c].unshift(b)},prefilter:function(a,b){b?Xc.unshift(a):Xc.push(a)}});q.Tween=aa;aa.prototype={constructor:aa,
init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(q.cssNumber[c]?"":"px")},cur:function(){var a=aa.propHooks[this.prop];return a&&a.get?a.get(this):aa.propHooks._default.get(this)},run:function(a){var b,c=aa.propHooks[this.prop];this.pos=this.options.duration?b=q.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;this.options.step&&this.options.step.call(this.elem,
this.now,this);c&&c.set?c.set(this):aa.propHooks._default.set(this);return this}};aa.prototype.init.prototype=aa.prototype;aa.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=q.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(q.fx.step[a.prop])q.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[q.cssProps[a.prop]]||q.cssHooks[a.prop])?q.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};aa.propHooks.scrollTop=
aa.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};q.each(["toggle","show","hide"],function(a,b){var c=q.fn[b];q.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(ja(b,!0),a,d,e)}});q.fn.extend({fadeTo:function(a,b,c,d){return this.filter(P).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=q.isEmptyObject(a),f=q.speed(b,c,d);b=function(){var b=W(this,q.extend({},
a),f);(e||q._data(this,"finish"))&&b.stop(!0)};b.finish=b;return e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop;b(d)};"string"!==typeof a&&(d=c,c=a,a=b);c&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=q.timers,l=q._data(this);if(c)l[c]&&l[c].stop&&e(l[c]);else for(c in l)l[c]&&(l[c].stop&&La.test(c))&&e(l[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),
b=!1,f.splice(c,1));!b&&d||q.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,c=q._data(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=q.timers,f=d?d.length:0;c.finish=!0;q.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<f;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});q.each({slideDown:ja("show"),slideUp:ja("hide"),slideToggle:ja("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){q.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});q.speed=function(a,b,c){var d=a&&"object"===typeof a?q.extend({},a):{complete:c||!c&&b||q.isFunction(a)&&a,duration:a,easing:c&&b||b&&!q.isFunction(b)&&b};d.duration=q.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in q.fx.speeds?q.fx.speeds[d.duration]:q.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;d.complete=
function(){q.isFunction(d.old)&&d.old.call(this);d.queue&&q.dequeue(this,d.queue)};return d};q.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};q.timers=[];q.fx=aa.prototype.init;q.fx.tick=function(){var a,c=q.timers,d=0;for(Hc=q.now();d<c.length;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||q.fx.stop();Hc=b};q.fx.timer=function(a){a()&&q.timers.push(a)&&q.fx.start()};q.fx.interval=13;q.fx.start=function(){gd||(gd=setInterval(q.fx.tick,q.fx.interval))};
q.fx.stop=function(){clearInterval(gd);gd=null};q.fx.speeds={slow:600,fast:200,_default:400};q.fx.step={};q.expr&&q.expr.filters&&(q.expr.filters.animated=function(a){return q.grep(q.timers,function(b){return a===b.elem}).length});q.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){q.offset.setOffset(this,a,b)});var c,d,e={top:0,left:0},f=(d=this[0])&&d.ownerDocument;if(f){c=f.documentElement;if(!q.contains(c,d))return e;typeof d.getBoundingClientRect!==ga&&(e=d.getBoundingClientRect());
d=N(f);return{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}}};q.offset={setOffset:function(a,b,c){var d=q.css(a,"position");"static"===d&&(a.style.position="relative");var e=q(a),f=e.offset(),l=q.css(a,"top"),p=q.css(a,"left"),m={},n={};("absolute"===d||"fixed"===d)&&-1<q.inArray("auto",[l,p])?(n=e.position(),d=n.top,p=n.left):(d=parseFloat(l)||0,p=parseFloat(p)||0);q.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(m.top=b.top-
f.top+d);null!=b.left&&(m.left=b.left-f.left+p);"using"in b?b.using.call(a,m):e.css(m)}};q.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];"fixed"===q.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),q.nodeName(a[0],"html")||(c=a.offset()),c.top+=q.css(a[0],"borderTopWidth",!0),c.left+=q.css(a[0],"borderLeftWidth",!0));return{top:b.top-c.top-q.css(d,"marginTop",!0),left:b.left-c.left-q.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=
this.offsetParent||Pa;a&&!q.nodeName(a,"html")&&"static"===q.css(a,"position");)a=a.offsetParent;return a||Pa})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);q.fn[a]=function(e){return q.access(this,function(a,e,f){var l=N(a);if(f===b)return l?c in l?l[c]:l.document.documentElement[e]:a[e];l?l.scrollTo(d?q(l).scrollLeft():f,d?f:q(l).scrollTop()):a[e]=f},a,e,arguments.length,null)}});q.each({Height:"height",Width:"width"},function(a,c){q.each({padding:"inner"+
a,content:c,"":"outer"+a},function(d,e){q.fn[e]=function(e,f){var l=arguments.length&&(d||"boolean"!==typeof e),p=d||(!0===e||!0===f?"margin":"border");return q.access(this,function(c,d,e){return q.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(d=c.documentElement,Math.max(c.body["scroll"+a],d["scroll"+a],c.body["offset"+a],d["offset"+a],d["client"+a])):e===b?q.css(c,d,p):q.style(c,d,e,p)},c,l?e:b,l,null)}})});q.fn.size=function(){return this.length};q.fn.andSelf=q.fn.addBack;
"object"===typeof module&&module&&"object"===typeof module.exports?module.exports=q:(a.jQuery=a.$=q,"function"===typeof define&&define.amd&&define("jquery",[],function(){return q}))})(window);(function(){function a(b,c,d){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b._chain&&(b=b._wrapped);c._chain&&(c=c._wrapped);if(b.isEqual&&D.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&D.isFunction(c.isEqual))return c.isEqual(b);var e=n.call(b);if(e!=n.call(c))return!1;switch(e){case "[object String]":return b==String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==
c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==b)return!0;d.push(b);var f=0,l=!0;if("[object Array]"==e){if(f=b.length,l=f==c.length)for(;f--&&(l=f in b==f in c&&a(b[f],c[f],d)););}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var p in b)if(D.has(b,p)&&(f++,!(l=D.has(c,p)&&a(b[p],c[p],d))))break;if(l){for(p in c)if(D.has(c,p)&&!f--)break;
l=!f}}d.pop();return l}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,l=e.slice,m=e.unshift,n=f.toString,p=f.hasOwnProperty,r=e.forEach,t=e.map,u=e.reduce,z=e.reduceRight,E=e.filter,C=e.every,A=e.some,B=e.indexOf,F=e.lastIndexOf,f=Array.isArray,I=Object.keys,J=Function.prototype.bind,D=function(a){return new Q(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=D),exports._=D):b._=D;D.VERSION="1.3.3";var P=D.each=D.forEach=function(a,
b,c){if(null!=a)if(r&&a.forEach===r)a.forEach(b,c);else if(a.length===+a.length)for(var e=0,f=a.length;e<f&&!(e in a&&b.call(c,a[e],e,a)===d);e++);else for(e in a)if(D.has(a,e)&&b.call(c,a[e],e,a)===d)break};D.map=D.collect=function(a,b,c){var d=[];if(null==a)return d;if(t&&a.map===t)return a.map(b,c);P(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});a.length===+a.length&&(d.length=a.length);return d};D.reduce=D.foldl=D.inject=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);if(u&&a.reduce===
u)return d&&(b=D.bind(b,d)),e?a.reduce(b,c):a.reduce(b);P(a,function(a,f,l){e?c=b.call(d,c,a,f,l):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};D.reduceRight=D.foldr=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);if(z&&a.reduceRight===z)return d&&(b=D.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=D.toArray(a).reverse();d&&!e&&(b=D.bind(b,d));return e?D.reduce(f,b,c,d):D.reduce(f,b)};D.find=D.detect=function(a,b,c){var d;M(a,function(a,
e,f){if(b.call(c,a,e,f))return d=a,!0});return d};D.filter=D.select=function(a,b,c){var d=[];if(null==a)return d;if(E&&a.filter===E)return a.filter(b,c);P(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)});return d};D.reject=function(a,b,c){var d=[];if(null==a)return d;P(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)});return d};D.every=D.all=function(a,b,c){var e=!0;if(null==a)return e;if(C&&a.every===C)return a.every(b,c);P(a,function(a,f,l){if(!(e=e&&b.call(c,a,f,l)))return d});return!!e};
var M=D.some=D.any=function(a,b,c){b||(b=D.identity);var e=!1;if(null==a)return e;if(A&&a.some===A)return a.some(b,c);P(a,function(a,f,l){if(e||(e=b.call(c,a,f,l)))return d});return!!e};D.include=D.contains=function(a,b){var c=!1;return null==a?c:B&&a.indexOf===B?-1!=a.indexOf(b):c=M(a,function(a){return a===b})};D.invoke=function(a,b){var c=l.call(arguments,2);return D.map(a,function(a){return(D.isFunction(b)?b||a:a[b]).apply(a,c)})};D.pluck=function(a,b){return D.map(a,function(a){return a[b]})};
D.max=function(a,b,c){if(!b&&D.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&D.isEmpty(a))return-Infinity;var d={computed:-Infinity};P(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>=d.computed&&(d={value:a,computed:e})});return d.value};D.min=function(a,b,c){if(!b&&D.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&D.isEmpty(a))return Infinity;var d={computed:Infinity};P(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<d.computed&&(d={value:a,computed:e})});return d.value};D.shuffle=
function(a){var b=[],c;P(a,function(a,d,e){c=Math.floor(Math.random()*(d+1));b[d]=b[c];b[c]=a});return b};D.sortBy=function(a,b,c){var d=D.isFunction(b)?b:function(a){return a[b]};return D.pluck(D.map(a,function(a,b,e){return{value:a,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return void 0===c?1:void 0===d?-1:c<d?-1:c>d?1:0}),"value")};D.groupBy=function(a,b){var c={},d=D.isFunction(b)?b:function(a){return a[b]};P(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)});
return c};D.sortedIndex=function(a,b,c){c||(c=D.identity);for(var d=0,e=a.length;d<e;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d};D.toArray=function(a){return a?D.isArray(a)||D.isArguments(a)?l.call(a):a.toArray&&D.isFunction(a.toArray)?a.toArray():D.values(a):[]};D.size=function(a){return D.isArray(a)?a.length:D.keys(a).length};D.first=D.head=D.take=function(a,b,c){return null==b||c?a[0]:l.call(a,0,b)};D.initial=function(a,b,c){return l.call(a,0,a.length-(null==b||c?1:b))};D.last=function(a,b,
c){return null==b||c?a[a.length-1]:l.call(a,Math.max(a.length-b,0))};D.rest=D.tail=function(a,b,c){return l.call(a,null==b||c?1:b)};D.compact=function(a){return D.filter(a,function(a){return!!a})};D.flatten=function(a,b){return D.reduce(a,function(a,c){if(D.isArray(c))return a.concat(b?c:D.flatten(c));a[a.length]=c;return a},[])};D.without=function(a){return D.difference(a,l.call(arguments,1))};D.uniq=D.unique=function(a,b,c){c=c?D.map(a,c):a;var d=[];3>a.length&&(b=!0);D.reduce(c,function(c,e,f){(b?
D.last(c)===e&&c.length:D.include(c,e))||(c.push(e),d.push(a[f]));return c},[]);return d};D.union=function(){return D.uniq(D.flatten(arguments,!0))};D.intersection=D.intersect=function(a){var b=l.call(arguments,1);return D.filter(D.uniq(a),function(a){return D.every(b,function(b){return 0<=D.indexOf(b,a)})})};D.difference=function(a){var b=D.flatten(l.call(arguments,1),!0);return D.filter(a,function(a){return!D.include(b,a)})};D.zip=function(){for(var a=l.call(arguments),b=D.max(D.pluck(a,"length")),
c=Array(b),d=0;d<b;d++)c[d]=D.pluck(a,""+d);return c};D.indexOf=function(a,b,c){if(null==a)return-1;var d;if(c)return c=D.sortedIndex(a,b),a[c]===b?c:-1;if(B&&a.indexOf===B)return a.indexOf(b);c=0;for(d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1};D.lastIndexOf=function(a,b){if(null==a)return-1;if(F&&a.lastIndexOf===F)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};D.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var d=
Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};var G=function(){};D.bind=function(a,b){var c,d;if(a.bind===J&&J)return J.apply(a,l.call(arguments,1));if(!D.isFunction(a))throw new TypeError;d=l.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,d.concat(l.call(arguments)));G.prototype=a.prototype;var e=new G,f=a.apply(e,d.concat(l.call(arguments)));return Object(f)===f?f:e}};D.bindAll=function(a){var b=l.call(arguments,1);0==b.length&&(b=D.functions(a));
P(b,function(b){a[b]=D.bind(a[b],a)});return a};D.memoize=function(a,b){var c={};b||(b=D.identity);return function(){var d=b.apply(this,arguments);return D.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};D.delay=function(a,b){var c=l.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};D.defer=function(a){return D.delay.apply(D,[a,1].concat(l.call(arguments,1)))};D.throttle=function(a,b){var c,d,e,f,l,p,m=D.debounce(function(){l=f=!1},b);return function(){c=this;d=arguments;e||
(e=setTimeout(function(){e=null;l&&a.apply(c,d);m()},b));f?l=!0:p=a.apply(c,d);m();f=!0;return p}};D.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments;c&&!d&&a.apply(e,f);clearTimeout(d);d=setTimeout(function(){d=null;c||a.apply(e,f)},b)}};D.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};D.wrap=function(a,b){return function(){var c=[a].concat(l.call(arguments,0));return b.apply(this,c)}};D.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};D.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};D.keys=I||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)D.has(a,c)&&(b[b.length]=c);return b};D.values=function(a){return D.map(a,D.identity)};D.functions=D.methods=function(a){var b=[],c;for(c in a)D.isFunction(a[c])&&b.push(c);return b.sort()};D.extend=function(a){P(l.call(arguments,
1),function(b){for(var c in b)a[c]=b[c]});return a};D.pick=function(a){var b={};P(D.flatten(l.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};D.defaults=function(a){P(l.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};D.clone=function(a){return D.isObject(a)?D.isArray(a)?a.slice():D.extend({},a):a};D.tap=function(a,b){b(a);return a};D.isEqual=function(b,c){return a(b,c,[])};D.isEmpty=function(a){if(null==a)return!0;if(D.isArray(a)||D.isString(a))return 0===
a.length;for(var b in a)if(D.has(a,b))return!1;return!0};D.isElement=function(a){return!(!a||1!=a.nodeType)};D.isArray=f||function(a){return"[object Array]"==n.call(a)};D.isObject=function(a){return a===Object(a)};D.isArguments=function(a){return"[object Arguments]"==n.call(a)};D.isArguments(arguments)||(D.isArguments=function(a){return!(!a||!D.has(a,"callee"))});D.isFunction=function(a){return"[object Function]"==n.call(a)};D.isString=function(a){return"[object String]"==n.call(a)};D.isNumber=function(a){return"[object Number]"==
n.call(a)};D.isFinite=function(a){return D.isNumber(a)&&isFinite(a)};D.isNaN=function(a){return a!==a};D.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};D.isDate=function(a){return"[object Date]"==n.call(a)};D.isRegExp=function(a){return"[object RegExp]"==n.call(a)};D.isNull=function(a){return null===a};D.isUndefined=function(a){return void 0===a};D.has=function(a,b){return p.call(a,b)};D.noConflict=function(){b._=c;return this};D.identity=function(a){return a};D.times=
function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)};D.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};D.result=function(a,b){if(null==a)return null;var c=a[b];return D.isFunction(c)?c.call(a):c};D.mixin=function(a){P(D.functions(a),function(b){V(b,D[b]=a[b])})};var K=0;D.uniqueId=function(a){var b=K++;return a?a+b:b};D.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var Y=/.^/,T={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},O;for(O in T)T[T[O]]=O;var fa=/\\|'|\r|\n|\t|\u2028|\u2029/g,S=/\\(\\|'|r|n|t|u2028|u2029)/g,X=function(a){return a.replace(S,function(a,b){return T[b]})};D.template=function(a,b,c){c=D.defaults(c||{},D.templateSettings);a="__p+='"+a.replace(fa,function(a){return"\\"+T[a]}).replace(c.escape||Y,function(a,b){return"'+\n_.escape("+X(b)+")+\n'"}).replace(c.interpolate||Y,function(a,b){return"'+\n("+
X(b)+")+\n'"}).replace(c.evaluate||Y,function(a,b){return"';\n"+X(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var d=new Function(c.variable||"obj","_",a);if(b)return d(b,D);b=function(a){return d.call(this,a,D)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};D.chain=function(a){return D(a).chain()};var Q=function(a){this._wrapped=a};D.prototype=Q.prototype;
var Z=function(a,b){return b?D(a).chain():a},V=function(a,b){Q.prototype[a]=function(){var a=l.call(arguments);m.call(a,this._wrapped);return Z(b.apply(D,a),this._chain)}};D.mixin(D);P("pop push reverse shift sort splice unshift".split(" "),function(a){var b=e[a];Q.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;"shift"!=a&&"splice"!=a||0!==d||delete c[0];return Z(c,this._chain)}});P(["concat","join","slice"],function(a){var b=e[a];Q.prototype[a]=function(){return Z(b.apply(this._wrapped,
arguments),this._chain)}});Q.prototype.chain=function(){this._chain=!0;return this};Q.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var a=[].slice,b=/\s+/,c=function(a,c,d,e){if(!d)return!0;if("object"===typeof d)for(var p in d)a[c].apply(a,[p,d[p]].concat(e));else if(b.test(d)){d=d.split(b);p=0;for(var r=d.length;p<r;p++)a[c].apply(a,[d[p]].concat(e))}else return!0},d=function(a,b,c){var d;a=-1;var e=b.length;switch(c.length){case 0:for(;++a<e;)(d=b[a]).callback.call(d.ctx);break;case 1:for(;++a<e;)(d=b[a]).callback.call(d.ctx,c[0]);break;case 2:for(;++a<e;)(d=b[a]).callback.call(d.ctx,c[0],c[1]);break;case 3:for(;++a<
e;)(d=b[a]).callback.call(d.ctx,c[0],c[1],c[2]);break;default:for(;++a<e;)(d=b[a]).callback.apply(d.ctx,c)}},e=Backbone.Events={on:function(a,b,d){if(!c(this,"on",a,[b,d])||!b)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:b,context:d,ctx:d||this});return this},once:function(a,b,d){if(!c(this,"once",a,[b,d])||!b)return this;var e=this,p=_.once(function(){e.off(a,p);b.apply(this,arguments)});p._callback=b;this.on(a,p,d);return this},off:function(a,
b,d){var e,p,r,t,u,z,E,C;if(!this._events||!c(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events={},this;t=a?[a]:_.keys(this._events);u=0;for(z=t.length;u<z;u++)if(a=t[u],e=this._events[a]){r=[];if(b||d)for(E=0,C=e.length;E<C;E++)p=e[E],(b&&b!==(p.callback._callback||p.callback)||d&&d!==p.context)&&r.push(p);this._events[a]=r}return this},trigger:function(b){if(!this._events)return this;var e=a.call(arguments,1);if(!c(this,"trigger",b,e))return this;var m=this._events[b],n=this._events.all;
m&&d(this,m,e);n&&d(this,n,arguments);return this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=_.uniqueId("l"));d[e]=a;a.on(b,c||this,this);return this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),b||c||delete d[a._listenerId];else{for(var e in d)d[e].off(null,null,this);this._listeners={}}return this}}};e.bind=e.on;e.unbind=e.off})();
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var f=(new Date).getTime(),l=Math.max(0,16-(f-a)),m=window.setTimeout(function(){b(f+l)},l);a=f+l;return m});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();
(function(){function a(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(z.Events.resize,b,a)}var b=this,c=b.Two||{},d=Math.sin,e=Math.cos,f=Math.atan2,l=Math.sqrt,m=Math.abs,n=Math.PI,p=2*n,r=n/2,t=Math.pow,u={hasEventListeners:_.isFunction(b.addEventListener),bind:function(a,b,c,d){this.hasEventListeners?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c);return this},unbind:function(a,b,c,d){this.hasEventListeners?
a.removeEventListeners(b,c,!!d):a.detachEvent("on"+b,c);return this}},z=b.Two=function(b){b=_.defaults(b||{},{fullscreen:!1,width:640,height:480,type:z.Types.svg,autostart:!1});this.type=b.type;this.renderer=new z[this.type](this);z.Utils.setPlaying.call(this,b.autostart);this.frameCount=0;b.fullscreen?(b=_.bind(a,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),u.bind(window,"resize",b),b()):(this.renderer.setSize(b.width,b.height),this.width=b.width,this.height=b.height);this.scene=new z.Group;this.renderer.add(this.scene);z.Instances.push(this)};_.extend(z,{Array:b.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,
Instances:[],noConflict:function(){b.Two=c;return this},Utils:{getComputedMatrix:function(a){for(var b=new z.Matrix;a&&a._matrix;){var c=a._matrix.elements;b.multiply(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9]);a=a.parent}return b},Curve:{CollinearityEpsilon:t(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this));return this},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";
_.each(a.attributes,function(a,c){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return z.Utils.read.g.apply(this,
arguments)},g:function(a){var b=new z.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in z.Utils.read&&(a=z.Utils.read[c].call(this,a),b.add(a))}},this);return z.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var c=a.points,d=_.map(_.range(c.numberOfItems),function(a){a=c.getItem(a);return new z.Vector(a.x,a.y)}),d=(new z.Polygon(d,!b)).noStroke();return z.Utils.applySvgAttributes(a,d)},polyline:function(a){return z.Utils.read.polygon(a,!0)},
path:function(a){var b=a.getAttribute("d"),b=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){a=_.map(_.compact(a.split(/m/g)),function(a,b){return 0>=b?a:"m"+a});a[0]="M"+a[0];return a})),c=new z.Vector,d=new z.Vector;return _.map(b,function(b){var e,f=!1,l=!1;b=_.flatten(_.map(b.match(/[a-z][^a-z]*/ig),function(a){var b,p,m=a[0],n=m.toLowerCase();e=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/);f=m===n;var r,u,t;switch(n){case "z":l=!0;break;case "m":case "l":p=parseFloat(e[0]);b=parseFloat(e[1]);
b=new z.Vector(p,b);f&&b.addSelf(c);c.copy(b);break;case "h":case "v":p="h"===n?"x":"y";a="x"===p?"y":"x";b=new z.Vector;b[p]=parseFloat(e[0]);b[a]=c[a];f&&(b[p]+=c[p]);c.copy(b);break;case "s":case "c":b=c.x;a=c.y;"c"===n?(m=parseFloat(e[0]),p=parseFloat(e[1]),n=parseFloat(e[2]),r=parseFloat(e[3]),u=parseFloat(e[4]),t=parseFloat(e[5])):(r=(new z.Vector).copy(c).subSelf(d),m=parseFloat(r.x),p=parseFloat(r.y),n=parseFloat(e[0]),r=parseFloat(e[1]),u=parseFloat(e[2]),t=parseFloat(e[3]));f&&(m+=b,p+=
a,n+=b,r+=a,u+=b,t+=a);b=z.Utils.subdivide(b,a,m,p,n,r,u,t);c.set(u,t);d.set(n,r);break;case "t":case "q":b=c.x;a=c.y;d.isZero()?(m=b,p=a):(m=d.x,a=d.y);"q"===n?(n=parseFloat(e[0]),r=parseFloat(e[1]),u=parseFloat(e[1]),t=parseFloat(e[2])):(r=(new z.Vector).copy(c).subSelf(d),n=parseFloat(r.x),r=parseFloat(r.y),u=parseFloat(e[0]),t=parseFloat(e[1]));f&&(m+=b,p+=a,n+=b,r+=a,u+=b,t+=a);b=z.Utils.subdivide(b,a,m,p,n,r,u,t);c.set(u,t);d.set(n,r);break;case "a":throw new z.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return b}));_.isUndefined(b[b.length-1])&&b.pop();b=(new z.Polygon(b,l)).noStroke();return z.Utils.applySvgAttributes(a,b)})},circle:function(a){var b=parseFloat(a.getAttribute("cx")),c=parseFloat(a.getAttribute("cy")),f=parseFloat(a.getAttribute("r")),l=z.Resolution,m=_.map(_.range(l),function(a){var b=a/l*p;a=f*e(b);b=f*d(b);return new z.Vector(a,b)},this),m=(new z.Polygon(m,!0,!0)).noStroke();m.translation.set(b,c);return z.Utils.applySvgAttributes(a,m)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
c=parseFloat(a.getAttribute("cy")),f=parseFloat(a.getAttribute("rx")),l=parseFloat(a.getAttribute("ry")),m=z.Resolution,n=_.map(_.range(m),function(a){var b=a/m*p;a=f*e(b);b=l*d(b);return new z.Vector(a,b)},this),n=(new z.Polygon(n,!0,!0)).noStroke();n.translation.set(b,c);return z.Utils.applySvgAttributes(a,n)},rect:function(a){var b=parseFloat(a.getAttribute("x")),c=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),e=parseFloat(a.getAttribute("height")),d=d/2,e=e/2,f=[new z.Vector(d,
e),new z.Vector(-d,e),new z.Vector(-d,-e),new z.Vector(d,-e)],f=(new z.Polygon(f,!0)).noStroke();f.translation.set(b+d,c+e);return z.Utils.applySvgAttributes(a,f)},line:function(a){var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2")),d=(d-b)/2,e=(e-c)/2,f=[new z.Vector(-d,-e),new z.Vector(d,e)],f=(new z.Polygon(f)).noFill();f.translation.set(b+d,c+e);return z.Utils.applySvgAttributes(a,f)}},subdivide:function(a,
b,c,d,e,l,r,u,t){var C=z.Utils.Curve.CollinearityEpsilon,E=z.Utils.Curve.RecursionLimit,A=z.Utils.Curve.CuspLimit,B=z.Utils.Curve.Tolerance,F;t=t||0;if(t>E)return[];var E=(a+c)/2,Z=(b+d)/2,V=(c+e)/2,da=(d+l)/2,W=(e+r)/2,ua=(l+u)/2,aa=(E+V)/2,ja=(Z+da)/2,V=(V+W)/2,da=(da+ua)/2,N=(aa+V)/2,ma=(ja+da)/2;F=r-a;var U=u-b,ga=m((c-r)*U-(d-u)*F),va=m((e-r)*U-(l-u)*F);if(0<t){if(ga>C&&va>C&&(ga+va)*(ga+va)<=B.distance*(F*F+U*U)){if(B.angle<B.epsilon)return[new z.Vector(N,ma)];F=f(l-d,e-c);C=m(F-f(d-b,c-a));
F=m(f(u-l,r-e)-F);C>=n&&(C=p-C);F>=n&&(F=p-F);if(C+F<B.angle)return[new z.Vector(N,ma)];if(0!==A){if(C>A)return[new z.Vector(c,d)];if(F>A)return[new z.Vector(e,l)]}}}else if(ga>C)if(ga*ga<=B.distance*(F*F+U*U)){if(B.angle<B.epsilon)return[new z.Vector(N,ma)];C=m(f(l-d,e-c)-f(d-b,c-a));C>=n&&(C=p-C);if(C<B.angle)return[new z.Vector(c,d),new z.Vector(e,l)];if(0!==A&&C>A)return[new z.Vector(c,d)]}else if(va>C){if(va*va<=B.distance*(F*F+U*U)){if(B.angle<B.epsilon)return[new z.Vector(N,ma)];C=m(f(u-l,
r-e)-f(l-d,e-c));C>=n&&(C=p-C);if(C<B.angle)return[new z.Vector(c,d),new z.Vector(e,l)];if(0!==A&&C>A)return[new z.Vector2(e,l)]}}else if(F=N-(a+r)/2,U=ma-(b+u)/2,F*F+U*U<=B.distance)return[new z.Vector(N,ma)];return z.Utils.subdivide(a,b,E,Z,aa,ja,N,ma,t+1).concat(z.Utils.subdivide(N,ma,V,da,W,ua,r,u,t+1))},getCurveFromPoints:function(a,b){for(var c=[],d=a.length,e=d-1,f=0;f<d;f++){var l=a[f],p={x:l.x,y:l.y};c.push(p);var l=b?F(f-1,d):Math.max(f-1,0),m=b?F(f+1,d):Math.min(f+1,e);B(a[l],p,a[m]);p.u.x||
p.u.y||(p.u.x=p.x,p.u.y=p.y);p.v.x||p.v.y||(p.v.x=p.x,p.v.y=p.y)}return c},getControlPoints:function(a,b,c){var f=A(a,b),l=A(c,b);a=E(a,b);c=E(c,b);var p=(f+l)/2;if(1E-4>a||1E-4>c)return b.u={x:b.x,y:b.y},b.v={x:b.x,y:b.y},b;a*=0.33;c*=0.33;p=l<f?p+r:p-r;f={x:b.x+e(p)*a,y:b.y+d(p)*a};p-=n;l={x:b.x+e(p)*c,y:b.y+d(p)*c};b.u=f;b.v=l;return b},angleBetween:function(a,b){return f(a.y-b.y,a.x-b.x)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},distanceBetween:function(a,b){return l(C(a,
b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});z.Utils.Error.prototype=Error();z.Utils.Error.prototype.constructor=z.Utils.Error;var E=z.Utils.distanceBetween,C=z.Utils.distanceBetweenSquared,A=z.Utils.angleBetween,B=z.Utils.getControlPoints,F=z.Utils.mod;_.extend(z.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){z.Utils.setPlaying.call(this,!0);return this.trigger(z.Events.play)},
pause:function(){this.playing=!1;return this.trigger(z.Events.pause)},update:function(){_.defer(_.bind(function(){var a=!!this._lastFrame,b=(window.performance&&window.performance.now?window.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,c=this.renderer;a===c.width&&b===c.height||c.setSize(a,b);this.trigger(z.Events.update,this.frameCount,this.timeDelta);this.render()},this));return this},render:function(){this.renderer.render();
return this.trigger(z.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,c,d){c=(c-a)/2;d=(d-b)/2;var e=[new z.Vector(-c,-d),new z.Vector(c,d)],e=(new z.Polygon(e)).noFill();e.translation.set(a+c,b+d);this.scene.add(e);return e},
makeRectangle:function(a,b,c,d){c/=2;d/=2;d=[new z.Vector(c,d),new z.Vector(-c,d),new z.Vector(-c,-d),new z.Vector(c,-d)];d=new z.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,f){var l=z.Resolution,m=_.map(_.range(l),function(a){var b=a/l*p;a=c*e(b);b=f*d(b);return new z.Vector(a,b)},this),m=new z.Polygon(m,!0,!0);m.translation.set(a,b);this.scene.add(m);return m},makeCurve:function(a){var b=
arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;c.push(new z.Vector(e,arguments[d+1]))}var b=arguments[b-1],c=new z.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),f=b.left+b.width/2,l=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=f;a.y-=l});c.translation.set(f,l);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;
c.push(new z.Vector(e,arguments[d+1]))}b=arguments[b-1];c=new z.Polygon(c,!(_.isBoolean(b)&&b));c.center();this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new z.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in z.Utils.read))return null;a=z.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(z.Instances,function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})();
"function"===typeof define&&define.amd?define(function(){return z}):"undefined"!=typeof module&&module.exports&&(module.exports=z)})();
(function(){var a=Two.Vector=function(a,b){this.x=a||0;this.y=b||0};_.extend(a,{MakeGetterSetter:function(a,b,e){var f="_"+b;Object.defineProperty(a,b,{get:function(){return this[f]},set:function(a){this[f]=a;this.trigger(Two.Events.change,b)}});a[f]=e}});_.extend(a.prototype,Backbone.Events,{set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new a(this.x,this.y)},add:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;return this},multiplySelf:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+
this.y*a.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return 1E-4>this.distanceTo(a)},lerp:function(a,b){return this.set((a.x-this.x)*
b+this.x,(a.y-this.y)*b+this.y)},isZero:function(){return 1E-4>this.length()}});var b={set:function(a,b){this._x=a;this._y=b;return this.trigger(Two.Events.change)},copy:function(a){this._x=a.x;this._y=a.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new a(this._x,this._y)},add:function(a,b){this._x=a.x+b.x;this._y=a.y+b.y;return this.trigger(Two.Events.change)},addSelf:function(a){this._x+=a.x;this._y+=
a.y;return this.trigger(Two.Events.change)},sub:function(a,b){this._x=a.x-b.x;this._y=a.y-b.y;return this.trigger(Two.Events.change)},subSelf:function(a){this._x-=a.x;this._y-=a.y;return this.trigger(Two.Events.change)},multiplySelf:function(a){this._x*=a.x;this._y*=a.y;return this.trigger(Two.Events.change)},multiplyScalar:function(a){this._x*=a;this._y*=a;return this.trigger(Two.Events.change)},divideScalar:function(a){return a?(this._x/=a,this._y/=a,this.trigger(Two.Events.change)):this.clear()},
negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this._x*a.x+this._y*a.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this._x-a.x;a=this._y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return 1E-4>
this.distanceTo(a)},lerp:function(a,b){return this.set((a.x-this._x)*b+this._x,(a.y-this._y)*b+this._y)},isZero:function(){return 1E-4>this.length()}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,b),this._bound=!0);Backbone.Events.bind.apply(this,arguments);return this}})();
(function(){_.range(6);var a=Math.cos,b=Math.sin,c=Math.tan,d=Two.Matrix=function(a,b,c,d,n,p){this.elements=new Two.Array(9);var r=a;_.isArray(r)||(r=_.toArray(arguments));this.identity().set(r)};_.extend(d,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,b){if(3>=b.length){var c=b[0]||0,d=b[1]||0,n=b[2]||0;return{x:a[0]*c+a[1]*d+a[2]*n,y:a[3]*c+a[4]*d+a[5]*n,z:a[6]*c+a[7]*d+a[8]*n}}var c=a[0],d=a[1],n=a[2],p=a[3],r=a[4],t=a[5],u=a[6],z=a[7],E=a[8],C=b[0],A=b[1],B=b[2],F=b[3],I=b[4],J=b[5],D=b[6],
P=b[7],M=b[8];return[c*C+d*F+n*D,c*A+d*I+n*P,c*B+d*J+n*M,p*C+r*F+t*D,p*A+r*I+t*P,p*B+r*J+t*M,u*C+z*F+E*D,u*A+z*I+E*P,u*B+z*J+E*M]}});_.extend(d.prototype,Backbone.Events,{set:function(a,b,c,d,n,p){var r=a;_.isArray(r)||(r=_.toArray(arguments));_.each(r,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(d.Identity);return this},multiply:function(a,b,c,d,n,p,r,t,u){var z=arguments,E=z.length;if(1>=E)return _.each(this.elements,
function(b,c){this.elements[c]=b*a},this),this.trigger(Two.Events.change);if(3>=E)return a=a||0,b=b||0,c=c||0,n=this.elements,{x:n[0]*a+n[1]*b+n[2]*c,y:n[3]*a+n[4]*b+n[5]*c,z:n[6]*a+n[7]*b+n[8]*c};E=this.elements;A0=E[0];A1=E[1];A2=E[2];A3=E[3];A4=E[4];A5=E[5];A6=E[6];A7=E[7];A8=E[8];B0=z[0];B1=z[1];B2=z[2];B3=z[3];B4=z[4];B5=z[5];B6=z[6];B7=z[7];B8=z[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},inverse:function(a){var b=this.elements;a=a||new Two.Matrix;var c=b[0],d=b[1],n=b[2],p=b[3],r=b[4],t=b[5],u=b[6],z=b[7],b=b[8],E=b*r-t*z,C=-b*p+t*u,A=z*p-r*u,B=c*E+d*C+n*A;if(!B)return null;B=1/B;a.elements[0]=E*B;a.elements[1]=(-b*d+n*z)*B;a.elements[2]=(t*d-n*r)*B;a.elements[3]=C*B;a.elements[4]=(b*c-
n*u)*B;a.elements[5]=(-t*c+n*p)*B;a.elements[6]=A*B;a.elements[7]=(-z*c+d*u)*B;a.elements[8]=(r*c-d*p)*B;return a},scale:function(a,b){1>=arguments.length&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(c){var d=a(c);c=b(c);return this.multiply(d,-c,0,c,d,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){a=c(a);return this.multiply(1,a,0,0,1,0,0,0,1)},skewY:function(a){a=c(a);return this.multiply(1,0,0,a,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},
toArray:function(a){var b=this.elements,c=parseFloat(b[0].toFixed(3)),d=parseFloat(b[1].toFixed(3)),n=parseFloat(b[2].toFixed(3)),p=parseFloat(b[3].toFixed(3)),r=parseFloat(b[4].toFixed(3)),t=parseFloat(b[5].toFixed(3));if(a){a=parseFloat(b[6].toFixed(3));var u=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,p,a,d,r,u,n,t,b]}return[c,p,d,r,n,t]},clone:function(){var a=this.elements[0],b=this.elements[1],c=this.elements[2],d=this.elements[3],n=this.elements[4],p=this.elements[5];
g=this.elements[6];h=this.elements[7];i=this.elements[8];return new Two.Matrix(a,b,c,d,n,p,g,h,i)}})})();
(function(){function a(a){var b={},c=a.id,d=a.translation,r=a.rotation,t=a.scale,u=a.stroke,z=a.linewidth,E=a.fill,C=a.opacity,A=a.visible,B=a.cap,F=a.join,I=a.miter,J=a.curved,D=a.closed,P=a.vertices;c&&(b.id=f.Identifier+c);d&&(_.isNumber(t)&&_.isNumber(r))&&(b.transform="matrix("+a._matrix.toString()+")");u&&(b.stroke=u);E&&(b.fill=E);C&&(b["stroke-opacity"]=b["fill-opacity"]=C);b.visibility=A?"visible":"hidden";B&&(b["stroke-linecap"]=B);F&&(b["stroke-linejoin"]=F);I&&(b["stroke-miterlimit"]=
I);z&&(b["stroke-width"]=z);P&&(b.d=e.toString(P,D,J));return b}function b(a,b,c,d,f){switch(b){case "matrix":b="transform";c="matrix("+c.toString()+")";break;case "visible":b="visibility";c=c?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";c=e.toString(c,d,f);break;case "opacity":e.setAttributes(a,{"stroke-opacity":c,"fill-opacity":c});return}a.setAttribute(b,
c)}var c=Two.Utils.getCurveFromPoints,d=Two.Utils.mod,e={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,b){var c=document.createElementNS(this.ns,a);"svg"===a&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(c,b);return c},setAttributes:function(a,b){_.each(b,function(b,c){a.setAttribute(c,b)},this);return this},removeAttributes:function(a,b){_.each(b,function(a){this.removeAttribute(a)},a);return this},toString:function(a,
b,e){var f=a.length,r=f-1;if(!e)return _.map(a,function(a,c){var d;d=(0>=c?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));c>=r&&b&&(d+=" Z");return d}).join(" ");var t=c(a,b);return _.map(t,function(a,c){var e,l=b?d(c-1,f):Math.max(c-1,0),n=b?d(c+1,f):Math.min(c+1,r);e=t[l];var n=t[n],l=e.v.x.toFixed(3),B=e.v.y.toFixed(3),F=a.u.x.toFixed(3),I=a.u.y.toFixed(3),J=a.x.toFixed(3),D=a.y.toFixed(3);e=0>=c?"M "+J+" "+D:"C "+l+" "+B+" "+F+" "+I+" "+J+" "+D;c>=r&&b&&(l=a.v.x.toFixed(3),B=a.v.y.toFixed(3),
F=n.u.x.toFixed(3),I=n.u.y.toFixed(3),J=n.x.toFixed(3),D=n.y.toFixed(3),e=e+(" C "+l+" "+B+" "+F+" "+I+" "+J+" "+D)+" Z");return e}).join(" ")}},f=Two[Two.Types.svg]=function(){this.count=0;this.domElement=e.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(f,{Identifier:"two-",Utils:e});_.extend(f.prototype,Backbone.Events,{setSize:function(a,b){this.width=a;this.height=
b;e.setAttributes(this.domElement,{width:a,height:b});return this},add:function(b){var c=b,d=this.elements,f=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;_.isUndefined(b.id)&&(b.id=_.uniqueId());c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=a(b),delete b.stroke,delete b.fill,delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],
delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=a(b));b=e.createElement(c,b);f.appendChild(b);d.push(b)},this);return this},getElementById:function(a){var b=this.elements,c;for(c in b){var d=b[c];if(d.getAttribute("id").replace(f.Identifier,"")==a)return d}return null},update:function(a,c,d,e,f){var t=this.getElementById(a);switch(c){case Two.Properties.hierarchy:_.each(d,function(a){t.appendChild(this.getElementById(a))},this);break;case Two.Properties.demotion:_.each(d,
function(a){t.removeChild(this.getElementById(a))},this);break;default:b(t,c,d,e,f)}return this},render:function(){this.unveil();return this}})})();
(function(){var a=Two.Utils.getCurveFromPoints,b=Two.Utils.mod,c=function(a){_.each(a,function(a,b){this[b]=a},this);this.children={}};_.extend(c.prototype,{appendChild:function(a){var b=a.parent,c=a.id;_.isUndefined(b)||delete b.children[c];this.children[c]=a;a.parent=this;return this},removeChild:function(a){delete this.children[a.id];return this},render:function(a){var b=this.matrix;a.save();a.transform(b[0],b[1],b[2],b[3],b[4],b[5]);_.each(this.children,function(b){b.render(a)});a.restore();return this}});
var d=function(a){_.each(a,function(a,b){this[b]=a},this)};_.extend(d.prototype,{render:function(a){var c=this.matrix,d=this.stroke,e=this.linewidth,f=this.fill,t=this.opacity,u=this.cap,z=this.join,E=this.miter,C=this.curved,A=this.closed,B=this.commands,F=B.length,I=F-1;if(!this.visible)return this;a.save();c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]);f&&(a.fillStyle=f);d&&(a.strokeStyle=d);e&&(a.lineWidth=e);E&&(a.miterLimit=E);z&&(a.lineJoin=z);u&&(a.lineCap=u);_.isNumber(t)&&(a.globalAlpha=
t);a.beginPath();_.each(B,function(c,d){var e=c.x.toFixed(3),f=c.y.toFixed(3);if(C){var p=A?b(d-1,F):Math.max(d-1,0),m=A?b(d+1,F):Math.min(d+1,I),n=B[p],m=B[m],p=n.v.x.toFixed(3),n=n.v.y.toFixed(3),r=c.u.x.toFixed(3),u=c.u.y.toFixed(3);0>=d?a.moveTo(e,f):(a.bezierCurveTo(p,n,r,u,e,f),d>=I&&A&&(p=c.v.x.toFixed(3),n=c.v.y.toFixed(3),r=m.u.x.toFixed(3),u=m.u.y.toFixed(3),e=m.x.toFixed(3),f=m.y.toFixed(3),a.bezierCurveTo(p,n,r,u,e,f)))}else 0>=d?a.moveTo(e,f):a.lineTo(e,f)});A&&!C&&a.closePath();a.fill();
a.stroke();a.restore()}});var e={toArray:function(b,c,d){return c?a(b,d):_.map(b,function(a,b){return{x:a.x,y:a.y}})}},f=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements={};this.stage=null};_.extend(f,{});_.extend(f,{Group:c,Element:d,getStyles:function(a){var b={},c=a.id,d=a._matrix,f=a.stroke,t=a.linewidth,u=a.fill,z=a.opacity,E=a.visible,C=a.cap,A=a.join,B=a.miter,F=a.curved,I=a.closed;a=a.vertices;
c&&(b.id=c);_.isObject(d)&&(b.matrix=d.toArray());f&&(b.stroke=f);u&&(b.fill=u);_.isNumber(z)&&(b.opacity=z);C&&(b.cap=C);A&&(b.join=A);B&&(b.miter=B);t&&(b.linewidth=t);a&&(b.commands=e.toArray(a,F,I));b.visible=!!E;b.curved=!!F;b.closed=!!I;return b},setStyles:function(a,b,c,d,f){switch(b){case "matrix":b="matrix";c=c.toArray();break;case "vertices":b="commands",a.curved=f,a.closed=d,c=e.toArray(c,a.curved,a.closed)}a[b]=c},Utils:e});_.extend(f.prototype,Backbone.Events,{setSize:function(a,b){this.width=
this.domElement.width=a;this.height=this.domElement.height=b;_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});return this},add:function(a){constructor=Object.getPrototypeOf(this).constructor;var b=a,c=this.elements,d=constructor.Group,e=constructor.Element,f=constructor.getStyles;_.isArray(a)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;var l=_.isNull(this.stage);_.isUndefined(a.id)&&(a.id=_.uniqueId());b?(b=f.call(this,
a),delete b.stroke,delete b.fill,delete b.opacity,delete b.cap,delete b.join,delete b.miter,delete b.linewidth,b=new d(b),l&&(this.stage=b,this.stage.object=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new e(f.call(this,a));c[b.id]=b;l||this.stage.appendChild(b)},this);return this},update:function(a,b,c,d,e,f){var u=Object.getPrototypeOf(this).constructor,z=this.elements,E=z[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){E.appendChild(z[a])});
break;case Two.Properties.demotion:_.each(c,function(a){E.removeChild(z[a]);this.elements[a]=null},this);break;default:u.setStyles.call(this,E,b,c,d,e,f)}return this},render:function(){if(_.isNull(this.stage))return this;this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();
(function(){function a(a,b){var c=Math.min(a.top,b.top),d=Math.min(a.left,b.left),e=Math.max(a.right,b.right),f=Math.max(a.bottom,b.bottom);return{top:c,left:d,right:e,bottom:f,width:e-d,height:f-c,centroid:{x:-d,y:-c}}}var b=Two[Two.Types.canvas],c=Two.Matrix.Multiply,d=Two[Two.Types.canvas].Utils.toArray,e=Two.Utils.mod,f=function(a){b.Group.call(this,a)};_.extend(f.prototype,b.Group.prototype,{appendChild:function(){b.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},
updateTexture:function(a){_.each(this.children,function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=c(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var l=function(a){b.Element.call(this,a)};_.extend(l.prototype,
b.Element.prototype,{updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=c(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){m.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,
this.texture);a.uniformMatrix3fv(b.matrix,!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var m={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b,c){var d=Infinity,e=-Infinity,f=Infinity,l=-Infinity;_.each(a,function(a,b){var p=a.x,m=a.y,n,r;f=Math.min(m,f);d=Math.min(p,d);e=Math.max(p,e);l=Math.max(m,l);c&&(p=a.u.x,m=a.u.y,
n=a.v.x,r=a.v.y,f=Math.min(m,r,f),d=Math.min(p,n,d),e=Math.max(p,n,e),l=Math.max(m,r,l))});_.isNumber(b)&&(f-=b,d-=b,e+=b,l+=b);return{top:f,left:d,right:e,bottom:l,width:e-d,height:l-f,centroid:{x:-d,y:-f}}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right;a=a.bottom;return new Two.Array([c,b,d,b,c,a,c,a,d,b,d,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,d=this.ctx,f=a._scale,l=a.stroke,m=a.linewidth*f,n=a.fill,B=a.opacity,F=a.cap,I=a.join,J=a.miter,D=a.curved,P=a.closed,M=
b.length,G=M-1;c.width=Math.max(Math.ceil(a.rect.width*f),1);c.height=Math.max(Math.ceil(a.rect.height*f),1);a=a.rect.centroid;var K=a.x*f,Y=a.y*f;d.clearRect(0,0,c.width,c.height);n&&(d.fillStyle=n);l&&(d.strokeStyle=l);m&&(d.lineWidth=m);J&&(d.miterLimit=J);I&&(d.lineJoin=I);F&&(d.lineCap=F);_.isNumber(B)&&(d.globalAlpha=B);d.beginPath();_.each(b,function(a,c){var l=(a.x*f+K).toFixed(3),p=(a.y*f+Y).toFixed(3);if(D){var m=P?e(c-1,M):Math.max(c-1,0),n=P?e(c+1,M):Math.min(c+1,G),t=b[m],n=b[n],m=(t.v.x*
f+K).toFixed(3),t=(t.v.y*f+Y).toFixed(3),C=(a.u.x*f+K).toFixed(3),E=(a.u.y*f+Y).toFixed(3);0>=c?d.moveTo(l,p):(d.bezierCurveTo(m,t,C,E,l,p),c>=G&&P&&(m=(a.v.x*f+K).toFixed(3),t=(a.v.y*f+Y).toFixed(3),C=(n.u.x*f+K).toFixed(3),E=(n.u.y*f+Y).toFixed(3),l=(n.x*f+K).toFixed(3),p=(n.y*f+Y).toFixed(3),d.bezierCurveTo(m,t,C,E,l,p)))}else 0>=c?d.moveTo(l,p):d.lineTo(l,p)});P&&!D&&d.closePath();d.fill();d.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,
b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,
b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,
a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};m.ctx=m.canvas.getContext("2d");var n=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",
a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=m.shaders.create(a,m.shaders.vertex,m.shaders.types.vertex),c=m.shaders.create(a,m.shaders.fragment,m.shaders.types.fragment);this.program=m.program.create(a,[b,c]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=a.getAttribLocation(this.program,"a_textureCoords");
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(n,{Group:f,Element:l,getStyles:function(a){var b={},c=a.id,e=a._matrix,f=a.stroke,n=a.linewidth,C=a.fill,A=a.opacity,B=a.visible,F=a.cap,I=a.join,J=a.miter,D=a.curved,P=a.closed,M=a.vertices;c&&(b.id=c);_.isObject(e)&&(b.matrix=b._matrix=e.toArray(!0),b.scale=b._scale=1);f&&(b.stroke=f);C&&(b.fill=C);_.isNumber(A)&&(b.opacity=
A);F&&(b.cap=F);I&&(b.join=I);J&&(b.miter=J);n&&(b.linewidth=n);M&&(b.vertices=d(M,D,P),b.commands=b.vertices,b.rect=m.getBoundingClientRect(b.commands,b.linewidth,b.curved),b.triangles=m.getTriangles(b.rect));b.visible=!!B;b.curved=!!D;b.closed=!!P;a instanceof Two.Polygon&&(m.updateBuffer(this.ctx,b,this.program),l.prototype.updateTexture.call(b,this.ctx));return b},setStyles:function(b,c,e,f,l,n){var C=!1;/matrix/.test(c)?(b[c]=e.toArray(!0),_.isNumber(f)&&(C=b.scale!==f,b.scale=f),b.updateMatrix()):
/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(c)?(b[c]=e,b.rect=a(m.getBoundingClientRect(b.commands,b.linewidth,b.curved),b.rect),b.triangles=m.getTriangles(b.rect),m.updateBuffer(this.ctx,b,this.program),C=!0):"vertices"===c?(_.isUndefined(f)||(b.closed=f),_.isUndefined(l)||(b.curved=l),n?b.commands=d(e,b.curved,b.closed):(b.vertices=d(e,b.curved,b.closed),b.commands=b.vertices),b.rect=a(m.getBoundingClientRect(b.vertices,b.linewidth,b.curved),b.rect),b.triangles=m.getTriangles(b.rect),
m.updateBuffer(this.ctx,b,this.program),C=!0):b[c]=e;C&&b.updateTexture(this.ctx)}});_.extend(n.prototype,Backbone.Events,b.prototype,{setSize:function(a,c){b.prototype.setSize.apply(this,arguments);this.ctx.viewport(0,0,a,c);var d=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(d,a,c);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();
(function(){var a=Two.Shape=function(b){this._matrix=new Two.Matrix;var c=this._updateMatrix=_.debounce(_.bind(function(){var a=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",a,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation=a;c()}});this._scale="scale";Object.defineProperty(this,"scale",
{get:function(){return this._scale},set:function(a){this._scale=a;c()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,c);if(b)return this;a.MakeGetterSetter(this,a.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=1};_.extend(a,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(a,c){_.isArray(c)||(c=[c]);_.each(c,
function(c){var e="_"+c;Object.defineProperty(a,c,{get:function(){return this[e]},set:function(a){this[e]=a;this.trigger(Two.Events.change,this.id,c,a,this)}})})}});_.extend(a.prototype,Backbone.Events,{addTo:function(a){a.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var b=new a;b.translation.copy(this.translation);_.each(a.Properties,function(a){b[a]=this[a]},this);return this}})})();
(function(){var a=Two.Group=function(b){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;a.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(a,{MakeGetterSetter:function(a,c){_.isArray(c)||(c=[c]);_.each(c,function(c){var e="_"+c;Object.defineProperty(a,c,{get:function(){return this[e]},set:function(a){this[e]=a;_.each(this.children,function(b){b[c]=a})}})})}});_.extend(a.prototype,
Two.Shape.prototype,{clone:function(b){b=b||this.parent;var c=_.map(this.children,function(a){return a.clone(b)}),d=new a;b.add(d);d.add(c);d.translation.copy(this.translation);d.rotation=this.rotation;d.scale=this.scale;return d},center:function(){var a=this.getBoundingClientRect();a.centroid={x:a.left+a.width/2,y:a.top+a.height/2};_.each(this.children,function(c){c.translation.subSelf(a.centroid)});this.translation.copy(a.centroid);return this},add:function(a){var c=a,d=this.children,e=this.parent,
f=[];_.isArray(a)||(c=_.toArray(arguments));var l=_.bind(function(a,b,c,d,e,f){this.trigger(Two.Events.change,a,b,c,d,e,f)},this);_.each(c,function(a){var b=a.id,c=a.parent;_.isUndefined(b)&&(e.add(a),b=a.id);_.isUndefined(d[b])&&(c&&delete c.children[b],d[b]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,l),f.push(b))},this);0<f.length&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,f);return this},remove:function(a){var c=a,d=this.children,e=this.parent,f=[];
if(0>=arguments.length&&e)return e.remove(this),this;_.isArray(a)||(c=_.toArray(arguments));_.each(c,function(a){var b=a.id;b in d&&(delete d[b],a.unbind(Two.Events.change),f.push(b))});0<f.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,f);return this},getBoundingClientRect:function(a){var c=Infinity,d=-Infinity,e=Infinity,f=-Infinity;_.each(this.children,function(a){a=a.getBoundingClientRect();e&&(c&&d&&f)&&(e=Math.min(a.top,e),c=Math.min(a.left,c),d=Math.max(a.right,d),f=
Math.max(a.bottom,f))},this);var l=a?this._matrix:Two.Utils.getComputedMatrix(this);a=l.multiply(c,e,1);l=l.multiply(d,f,1);return{top:a.y,left:a.x,right:l.x,bottom:l.y,width:l.x-a.x,height:l.y-a.y}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this}})})();
(function(){var a=Math.min,b=Math.max,c=Math.round,d=Two.Polygon=function(d,f,l){Two.Shape.call(this);f=!!f;l=!!l;var m=0,n=1,p=!1,r=d.slice(0),t=_.debounce(_.bind(function(a){var b;if(p)for(a=this.vertices.length,a-=1,b=c(m*a),a=c(n*a),r.length=0;b<a+1;b++){var d=this.vertices[b];r.push(new Two.Vector(d.x,d.y))}this.trigger(Two.Events.change,this.id,"vertices",r,f,l,p);p=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return f},set:function(a){f=!!a;t()}});Object.defineProperty(this,
"curved",{get:function(){return l},set:function(a){l=!!a;t()}});Object.defineProperty(this,"beginning",{get:function(){return m},set:function(c){m=a(b(c,0),1);p=!0;t()}});Object.defineProperty(this,"ending",{get:function(){return n},set:function(c){n=a(b(c,0),1);p=!0;t()}});this.vertices=d.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,t)},this);t()};_.extend(d.prototype,Two.Shape.prototype,{clone:function(){var a=_.map(this.vertices,function(a){return new Two.Vector(a.x,a.y)}),
b=new d(a,this.closed,this.curved);_.each(Two.Shape.Properties,function(a){b[a]=this[a]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},center:function(){var a=this.getBoundingClientRect();a.centroid={x:a.left+a.width/2,y:a.top+a.height/2};_.each(this.vertices,function(b){b.subSelf(a.centroid)});this.translation.addSelf(a.centroid);return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(a){var b=
this.linewidth,c=Infinity,d=-Infinity,n=Infinity,p=-Infinity;_.each(this.vertices,function(a){var b=a.x;a=a.y;n=Math.min(a,n);c=Math.min(b,c);d=Math.max(b,d);p=Math.max(a,p)});n-=b;c-=b;d+=b;p+=b;b=a?this._matrix:Two.Utils.getComputedMatrix(this);a=b.multiply(c,n,1);b=b.multiply(d,p,1);return{top:a.y,left:a.x,right:b.x,bottom:b.y,width:b.x-a.x,height:b.y-a.y}}})})();(function(a){function b(a,b,c){this.x=a;this.y=b;this.z=c}function c(a){return a*a*a*(a*(6*a-15)+10)}function d(a,b,c){return(1-c)*a+c*b}a=a.noise={};b.prototype.dot2=function(a,b){return this.x*a+this.y*b};b.prototype.dot3=function(a,b,c){return this.x*a+this.y*b+this.z*c};var e=[new b(1,1,0),new b(-1,1,0),new b(1,-1,0),new b(-1,-1,0),new b(1,0,1),new b(-1,0,1),new b(1,0,-1),new b(-1,0,-1),new b(0,1,1),new b(0,-1,1),new b(0,1,-1),new b(0,-1,-1)],f=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,
7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,
183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],l=Array(512),m=Array(512);a.seed=function(a){0<a&&1>a&&(a*=65536);a=Math.floor(a);256>a&&(a|=a<<8);for(var b=0;256>b;b++){var c;c=b&1?f[b]^
a&255:f[b]^a>>8&255;l[b]=l[b+256]=c;m[b]=m[b+256]=e[c%12]}};a.seed(0);var n=0.5*(Math.sqrt(3)-1),p=(3-Math.sqrt(3))/6,r=1/3,t=1/6;a.simplex2=function(a,b){var c,d,e;e=(a+b)*n;var f=Math.floor(a+e),r=Math.floor(b+e);e=(f+r)*p;c=a-f+e;var t=b-r+e,J,D;c>t?(J=1,D=0):(J=0,D=1);d=c-J+p;var P=t-D+p;e=c-1+2*p;var M=t-1+2*p,f=f&255,r=r&255,G=m[f+l[r]];J=m[f+J+l[r+D]];f=m[f+1+l[r+1]];r=0.5-c*c-t*t;0>r?c=0:(r*=r,c=r*r*G.dot2(c,t));t=0.5-d*d-P*P;0>t?d=0:(t*=t,d=t*t*J.dot2(d,P));P=0.5-e*e-M*M;0>P?e=0:(P*=P,e=
P*P*f.dot2(e,M));return 70*(c+d+e)};a.simplex3=function(a,b,c){var d,e,f=(a+b+c)*r,p=Math.floor(a+f);d=Math.floor(b+f);var n=Math.floor(c+f),f=(p+d+n)*t;e=a-p+f;var J=b-d+f,D=c-n+f,P,M,G,K,Y,T;e>=J?J>=D?(P=1,G=M=0,Y=K=1,T=0):(e>=D?(P=1,G=M=0):(M=P=0,G=1),K=1,Y=0,T=1):J<D?(M=P=0,G=1,K=0,T=Y=1):e<D?(P=0,M=1,K=G=0,T=Y=1):(P=0,M=1,G=0,Y=K=1,T=0);var O=e-P+t,fa=J-M+t,S=D-G+t;a=e-K+2*t;var X=J-Y+2*t,Q=D-T+2*t;c=e-1+3*t;b=J-1+3*t;f=D-1+3*t;p&=255;d&=255;var n=n&255,Z=m[p+l[d+l[n]]];P=m[p+P+l[d+M+l[n+G]]];
K=m[p+K+l[d+Y+l[n+T]]];p=m[p+1+l[d+1+l[n+1]]];d=0.5-e*e-J*J-D*D;0>d?d=0:(d*=d,d=d*d*Z.dot3(e,J,D));e=0.5-O*O-fa*fa-S*S;0>e?e=0:(e*=e,e=e*e*P.dot3(O,fa,S));n=0.5-a*a-X*X-Q*Q;0>n?a=0:(n*=n,a=n*n*K.dot3(a,X,Q));X=0.5-c*c-b*b-f*f;0>X?c=0:(X*=X,c=X*X*p.dot3(c,b,f));return 32*(d+e+a+c)};a.perlin2=function(a,b){var e=Math.floor(a),f=Math.floor(b);a-=e;b-=f;var e=e&255,f=f&255,p=m[e+l[f]].dot2(a,b),n=m[e+l[f+1]].dot2(a,b-1),r=m[e+1+l[f]].dot2(a-1,b),e=m[e+1+l[f+1]].dot2(a-1,b-1),f=c(a);return d(d(p,r,f),
d(n,e,f),c(b))};a.perlin3=function(a,b,e){var f=Math.floor(a),p=Math.floor(b),n=Math.floor(e);a-=f;b-=p;e-=n;var f=f&255,p=p&255,n=n&255,r=m[f+l[p+l[n]]].dot3(a,b,e),t=m[f+l[p+l[n+1]]].dot3(a,b,e-1),J=m[f+l[p+1+l[n]]].dot3(a,b-1,e),D=m[f+l[p+1+l[n+1]]].dot3(a,b-1,e-1),P=m[f+1+l[p+l[n]]].dot3(a-1,b,e),M=m[f+1+l[p+l[n+1]]].dot3(a-1,b,e-1),G=m[f+1+l[p+1+l[n]]].dot3(a-1,b-1,e),f=m[f+1+l[p+1+l[n+1]]].dot3(a-1,b-1,e-1);a=c(a);b=c(b);e=c(e);return d(d(d(r,P,a),d(t,M,a),e),d(d(J,G,a),d(D,f,a),e),b)}})(this);var SimplexNoise=function(a){void 0==a&&(a=Math);this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.p=[];for(var b=0;256>b;b++)this.p[b]=Math.floor(256*a.random());this.perm=[];for(b=0;512>b;b++)this.perm[b]=this.p[b&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],
[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};
SimplexNoise.prototype.dot=function(a,b,c){return a[0]*b+a[1]*c};
SimplexNoise.prototype.noise=function(a,b){var c,d,e;e=0.5*(Math.sqrt(3)-1);e*=a+b;var f=Math.floor(a+e),l=Math.floor(b+e),m=(3-Math.sqrt(3))/6;e=(f+l)*m;c=a-(f-e);var n=b-(l-e),p,r;c>n?(p=1,r=0):(p=0,r=1);d=c-p+m;var t=n-r+m;e=c-1+2*m;var m=n-1+2*m,u=f&255,l=l&255,f=this.perm[u+this.perm[l]]%12;p=this.perm[u+p+this.perm[l+r]]%12;r=this.perm[u+1+this.perm[l+1]]%12;l=0.5-c*c-n*n;0>l?c=0:(l*=l,c=l*l*this.dot(this.grad3[f],c,n));n=0.5-d*d-t*t;0>n?d=0:(n*=n,d=n*n*this.dot(this.grad3[p],d,t));t=0.5-e*
e-m*m;0>t?e=0:(t*=t,e=t*t*this.dot(this.grad3[r],e,m));return 70*(c+d+e)};
SimplexNoise.prototype.noise3d=function(a,b,c){var d,e,f,l=(a+b+c)*(1/3),m=Math.floor(a+l),n=Math.floor(b+l),p=Math.floor(c+l),l=1/6;f=(m+n+p)*l;d=a-(m-f);e=b-(n-f);var r=c-(p-f),t,u,z,E,C,A;d>=e?e>=r?(t=1,z=u=0,C=E=1,A=0):(d>=r?(t=1,z=u=0):(u=t=0,z=1),E=1,C=0,A=1):e<r?(u=t=0,z=1,E=0,A=C=1):d<r?(t=0,u=1,E=z=0,A=C=1):(t=0,u=1,z=0,C=E=1,A=0);var B=d-t+l,F=e-u+l,I=r-z+l;f=d-E+2*l;a=e-C+2*l;var J=r-A+2*l;c=d-1+3*l;b=e-1+3*l;var l=r-1+3*l,m=m&255,D=n&255,P=p&255,n=this.perm[m+this.perm[D+this.perm[P]]]%
12,p=this.perm[m+t+this.perm[D+u+this.perm[P+z]]]%12;E=this.perm[m+E+this.perm[D+C+this.perm[P+A]]]%12;m=this.perm[m+1+this.perm[D+1+this.perm[P+1]]]%12;C=0.6-d*d-e*e-r*r;0>C?d=0:(C*=C,d=C*C*this.dot(this.grad3[n],d,e,r));e=0.6-B*B-F*F-I*I;0>e?e=0:(e*=e,e=e*e*this.dot(this.grad3[p],B,F,I));B=0.6-f*f-a*a-J*J;0>B?f=0:(B*=B,f=B*B*this.dot(this.grad3[E],f,a,J));a=0.6-c*c-b*b-l*l;0>a?c=0:(a*=a,c=a*a*this.dot(this.grad3[m],c,b,l));return 32*(d+e+f+c)};(function(a,b,c){function d(a){var b=null;"VIDEO"===a.tagName?b=a:(a=a.getElementsByTagName("video"),a[0]&&(b=a[0]));return b}function e(a){var b=d(a);if(b&&b.webkitEnterFullscreen){try{b.readyState<b.HAVE_METADATA?(b.addEventListener("loadedmetadata",function M(){b.removeEventListener("loadedmetadata",M,!1);b.webkitEnterFullscreen();r=!!b.getAttribute("controls")},!1),b.load()):(b.webkitEnterFullscreen(),r=!!b.getAttribute("controls")),p=b}catch(c){return A("not_supported",a)}return!0}return A(void 0===
n.request?"not_supported":"not_enabled",a)}function f(){B.element||(C(),l())}function l(){c&&"webkitfullscreenchange"===n.change&&a.removeEventListener("resize",f,!1)}var m="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,n=function(){var a=b.createElement("video"),c={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen",
"msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},d={},e;for(e in c)for(var f=0,l=c[e].length;f<l;f++)if(c[e][f]in
a||c[e][f]in b||"on"+c[e][f]in b){d[e]=c[e][f];break}return d}(),p=null,r=null,t=function(){},u=[],z=-1<navigator.userAgent.indexOf("Android")&&-1<navigator.userAgent.indexOf("Chrome"),E=function(a){var b=u[u.length-1];if(a!==b.element&&a!==p||!b.hasEntered){"VIDEO"===a.tagName&&(p=a);if(1===u.length)B.onenter(B.element);b.enter.call(b.element,a||b.element);b.hasEntered=!0}},C=function(){p&&!r&&(p.setAttribute("controls","controls"),p.removeAttribute("controls"));r=p=null;var a=u.pop();a&&(a.exit.call(a.element),
B.element||(u.forEach(function(a){a.exit.call(a.element)}),u=[],B.onexit()))},A=function(a,b){if(0<u.length){var c=u.pop();b=b||c.element;c.error.call(b,a);B.onerror(b,a)}},B={request:function(a,d,f,l){a=a||b.body;u.push({element:a,enter:d||t,exit:f||t,error:l||t});if(void 0===n.request||c&&!1===b[n.enabled]||z)return e(a);if(c&&void 0===n.enabled)n.enabled="webkitFullscreenEnabled",a[n.request](),setTimeout(function(){b[n.element]?b[n.enabled]=!0:(b[n.enabled]=!1,e(a))},250);else try{if(/5\.1[\.\d]* Safari/.test(navigator.userAgent))a[n.request]();
else a[n.request](m&&Element.ALLOW_KEYBOARD_INPUT);setTimeout(function(){b[n.element]||A(c?"not_enabled":"not_allowed",a)},100)}catch(p){A("not_enabled",a)}},exit:function(){l();b[n.exit]()},toggle:function(a,b,c,d){B.element?B.exit():B.request(a,b,c,d)},videoEnabled:function(a){if(B.enabled)return!0;a=a||b.body;return(a=d(a))&&void 0!==a.webkitSupportsFullscreen?a.readyState<a.HAVE_METADATA?"maybe":a.webkitSupportsFullscreen:!1},onenter:t,onexit:t,onchange:t,onerror:t};try{Object.defineProperties(B,
{element:{enumerable:!0,get:function(){return p&&p.webkitDisplayingFullscreen?p:b[n.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"!==n.exit||c?z?!1:b[n.enabled]||!1:!0}}})}catch(F){B.element=null,B.enabled=!1}n.change&&b.addEventListener(n.change,function(b){B.onchange(B.element);B.element?(b=u[u.length-2])&&b.element===B.element?C():(E(B.element),c&&"webkitfullscreenchange"===n.change&&a.addEventListener("resize",f,!1)):C()},!1);b.addEventListener("webkitbeginfullscreen",
function(a){u.push({element:a.srcElement,enter:t,exit:t,error:t});B.onchange(a.srcElement);E(a.srcElement)},!0);b.addEventListener("webkitendfullscreen",function(a){B.onchange(a.srcElement);C(a.srcElement)},!0);n.error&&b.addEventListener(n.error,function(a){A("not_allowed")},!1);a.BigScreen=B})(window,document,self!==top);var THREE=THREE||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
THREE.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=c[d];Object.defineProperty(a,f,Object.getOwnPropertyDescriptor(b,f))}else for(f in c={}.hasOwnProperty,b)c.call(b,f)&&(a[f]=b[f]);return a};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),l=window.setTimeout(function(){b(c+f)},f);a=c+f;return l});window.cancelAnimationFrame=window.cancelAnimationFrame||
function(a){window.clearTimeout(a)}})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;
THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;
THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;
THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;
THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){void 0!==a&&this.set(a);return this};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*
c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a};b=0.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a))return a=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(a),this.r=Math.min(100,
parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=a.g;this.b=
a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*
this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var a={h:0,s:0,l:0};return function(){var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),l,m=(f+e)/2;if(f===e)f=l=0;else{var n=e-f,f=0.5>=m?n/(e+f):n/(2-e-f);switch(e){case b:l=(c-d)/n+(c<d?6:0);break;case c:l=(d-b)/n+2;break;case d:l=(b-c)/n+4}l/=6}a.h=l;a.s=f;a.l=m;return a}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEuler:function(a,b){var c=Math.cos(a.x/2),d=Math.cos(a.y/2),e=Math.cos(a.z/2),f=Math.sin(a.x/2),l=Math.sin(a.y/2),m=Math.sin(a.z/2);void 0===b||"XYZ"===b?(this.x=f*d*e+c*l*m,this.y=c*l*e-f*d*m,this.z=c*d*m+f*l*e,this.w=c*d*e-f*l*m):"YXZ"===b?(this.x=f*d*e+c*l*m,this.y=c*l*e-f*d*m,this.z=c*d*
m-f*l*e,this.w=c*d*e+f*l*m):"ZXY"===b?(this.x=f*d*e-c*l*m,this.y=c*l*e+f*d*m,this.z=c*d*m+f*l*e,this.w=c*d*e-f*l*m):"ZYX"===b?(this.x=f*d*e-c*l*m,this.y=c*l*e+f*d*m,this.z=c*d*m-f*l*e,this.w=c*d*e+f*l*m):"YZX"===b?(this.x=f*d*e+c*l*m,this.y=c*l*e+f*d*m,this.z=c*d*m-f*l*e,this.w=c*d*e-f*l*m):"XZY"===b&&(this.x=f*d*e-c*l*m,this.y=c*l*e-f*d*m,this.z=c*d*m+f*l*e,this.w=c*d*e+f*l*m);return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this.x=a.x*d;this.y=a.y*d;this.z=a.z*d;this.w=Math.cos(c);
return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],l=b[9],m=b[2],n=b[6],b=b[10],p=c+f+b;0<p?(c=0.5/Math.sqrt(p+1),this.w=0.25/c,this.x=(n-l)*c,this.y=(d-m)*c,this.z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this.w=(n-l)/c,this.x=0.25*c,this.y=(a+e)/c,this.z=(d+m)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this.w=(d-m)/c,this.x=(a+e)/c,this.y=0.25*c,this.z=(l+n)/c):(c=2*Math.sqrt(1+b-c-f),this.w=(e-a)/c,this.x=(d+m)/c,this.y=(l+n)/c,this.z=0.25*c);return this},
inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,e=a.z,f=a.w,l=b.x,m=b.y,n=b.z,p=b.w;this.x=c*p+f*l+d*n-e*m;this.y=d*p+f*m+e*l-c*n;this.z=e*p+f*n+c*m-d*l;this.w=f*p-c*l-d*m-e*n;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this.x,d=this.y,e=this.z,
f=this.w,l=f*a.w+c*a.x+d*a.y+e*a.z;0>l?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,l=-l):this.copy(a);if(1<=l)return this.w=f,this.x=c,this.y=d,this.z=e,this;var m=Math.acos(l),n=Math.sqrt(1-l*l);if(0.001>Math.abs(n))return this.w=0.5*(f+this.w),this.x=0.5*(c+this.x),this.y=0.5*(d+this.y),this.z=0.5*(e+this.z),this;l=Math.sin((1-b)*m)/n;m=Math.sin(b*m)/n;this.w=f*l+this.w*m;this.x=c*l+this.x*m;this.y=d*l+this.y*m;this.z=e*l+this.z*m;return this},equals:function(a){return a.x===this.x&&a.y===
this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=
a.y;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a):this.set(0,0);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},
negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/
b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+
a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,l=a.z;a=a.w;var m=a*b+f*d-l*c,n=a*c+l*b-e*d,p=a*d+e*c-f*b,b=-e*b-f*c-l*d;this.x=m*a+b*-e+n*-l-p*-f;this.y=n*a+b*-f+p*-e-m*-l;this.z=p*a+b*-l+m*-f-n*-e;return this},transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;
this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);
this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){this.x=
a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,e=d[0],f=d[4],l=d[8],m=d[1],n=d[5],p=d[9],r=d[2],t=d[6],
d=d[10];void 0===b||"XYZ"===b?(this.y=Math.asin(c(l)),0.99999>Math.abs(l)?(this.x=Math.atan2(-p,d),this.z=Math.atan2(-f,e)):(this.x=Math.atan2(t,n),this.z=0)):"YXZ"===b?(this.x=Math.asin(-c(p)),0.99999>Math.abs(p)?(this.y=Math.atan2(l,d),this.z=Math.atan2(m,n)):(this.y=Math.atan2(-r,e),this.z=0)):"ZXY"===b?(this.x=Math.asin(c(t)),0.99999>Math.abs(t)?(this.y=Math.atan2(-r,d),this.z=Math.atan2(-f,n)):(this.y=0,this.z=Math.atan2(m,e))):"ZYX"===b?(this.y=Math.asin(-c(r)),0.99999>Math.abs(r)?(this.x=Math.atan2(t,
d),this.z=Math.atan2(m,e)):(this.x=0,this.z=Math.atan2(-f,n))):"YZX"===b?(this.z=Math.asin(c(m)),0.99999>Math.abs(m)?(this.x=Math.atan2(-p,n),this.y=Math.atan2(-r,e)):(this.x=0,this.y=Math.atan2(l,d))):"XZY"===b&&(this.z=Math.asin(-c(f)),0.99999>Math.abs(f)?(this.x=Math.atan2(t,n),this.y=Math.atan2(l,e)):(this.x=Math.atan2(-p,d),this.y=0));return this},setEulerFromQuaternion:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,e=a.y*a.y,f=a.z*a.z,l=a.w*a.w;void 0===b||"XYZ"===
b?(this.x=Math.atan2(2*(a.x*a.w-a.y*a.z),l-d-e+f),this.y=Math.asin(c(2*(a.x*a.z+a.y*a.w))),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),l+d-e-f)):"YXZ"===b?(this.x=Math.asin(c(2*(a.x*a.w-a.y*a.z))),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),l-d-e+f),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),l-d+e-f)):"ZXY"===b?(this.x=Math.asin(c(2*(a.x*a.w+a.y*a.z))),this.y=Math.atan2(2*(a.y*a.w-a.z*a.x),l-d-e+f),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),l-d+e-f)):"ZYX"===b?(this.x=Math.atan2(2*(a.x*a.w+a.z*a.y),l-d-e+f),this.y=Math.asin(c(2*
(a.y*a.w-a.x*a.z))),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),l+d-e-f)):"YZX"===b?(this.x=Math.atan2(2*(a.x*a.w-a.z*a.y),l-d+e-f),this.y=Math.atan2(2*(a.y*a.w-a.x*a.z),l+d-e-f),this.z=Math.asin(c(2*(a.x*a.y+a.z*a.w)))):"XZY"===b&&(this.x=Math.atan2(2*(a.x*a.w+a.y*a.z),l-d+e-f),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),l+d-e-f),this.z=Math.asin(c(2*(a.z*a.w-a.x*a.y))));return this},getPositionFromMatrix:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},getScaleFromMatrix:function(a){var b=
this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},getColumnFromMatrix:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,
this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromEuler(b,c);this.applyQuaternion(d);return this}}(),applyAxisAngle:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromAxisAngle(b,c);this.applyQuaternion(d);return this}}(),projectOnVector:function(){var a=new THREE.Vector3;return function(b){a.copy(b).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a=new THREE.Vector3;
return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b).multiplyScalar(2);return this.subVectors(a,this)}}()});THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},
applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=
a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],l=a[1],m=a[5],n=a[9];c=a[2];b=a[6];var p=a[10];if(0.01>Math.abs(d-l)&&0.01>Math.abs(f-c)&&0.01>Math.abs(n-b)){if(0.1>Math.abs(d+l)&&0.1>Math.abs(f+c)&&0.1>Math.abs(n+b)&&0.1>Math.abs(e+m+p-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;m=(m+1)/2;p=(p+1)/2;d=(d+l)/4;f=(f+c)/4;n=(n+b)/4;e>m&&e>p?0.01>e?(b=0,d=c=0.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):m>p?0.01>m?(b=
0.707106781,c=0,d=0.707106781):(c=Math.sqrt(m),b=d/c,d=n/c):0.01>p?(c=b=0.707106781,d=0):(d=Math.sqrt(p),b=f/d,c=n/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-n)*(b-n)+(f-c)*(f-c)+(l-d)*(l-d));0.001>Math.abs(a)&&(a=1);this.x=(b-n)/a;this.y=(f-c)/a;this.z=(l-d)/a;this.w=Math.acos((e+m+p-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);
this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&
a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;d&&(e=THREE.Math.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);
this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);
this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a){return new THREE.Vector2((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;
return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},
size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=
this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a){return new THREE.Vector3((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,
this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,
new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,
this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};
THREE.Matrix3=function(a,b,c,d,e,f,l,m,n){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==e?e:1,f||0,l||0,m||0,void 0!==n?n:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,l,m,n){var p=this.elements;p[0]=a;p[3]=b;p[6]=c;p[1]=d;p[4]=e;p[7]=f;p[2]=l;p[5]=m;p[8]=n;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],l=a[5],m=a[6],n=a[7],a=a[8];return b*f*a-b*l*n-c*e*a+c*l*m+d*e*n-d*f*m},getInverse:function(a,
b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};
THREE.Matrix4=function(a,b,c,d,e,f,l,m,n,p,r,t,u,z,E,C){var A=this.elements=new Float32Array(16);A[0]=void 0!==a?a:1;A[4]=b||0;A[8]=c||0;A[12]=d||0;A[1]=e||0;A[5]=void 0!==f?f:1;A[9]=l||0;A[13]=m||0;A[2]=n||0;A[6]=p||0;A[10]=void 0!==r?r:1;A[14]=t||0;A[3]=u||0;A[7]=z||0;A[11]=E||0;A[15]=void 0!==C?C:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,l,m,n,p,r,t,u,z,E,C){var A=this.elements;A[0]=a;A[4]=b;A[8]=c;A[12]=d;A[1]=e;A[5]=f;A[9]=l;A[13]=m;A[2]=n;A[6]=p;A[10]=r;A[14]=t;A[3]=u;A[7]=z;A[11]=E;A[15]=C;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),setRotationFromEuler:function(a,
b){console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code.");return this.makeRotationFromEuler(a,b)},makeRotationFromEuler:function(a,b){var c=this.elements,d=a.x,e=a.y,f=a.z,l=Math.cos(d),d=Math.sin(d),m=Math.cos(e),e=Math.sin(e),n=Math.cos(f),f=Math.sin(f);if(void 0===b||"XYZ"===b){var p=l*n,r=l*f,t=d*n,u=d*f;c[0]=m*n;c[4]=-m*f;c[8]=e;c[1]=r+t*e;c[5]=p-u*e;c[9]=-d*m;c[2]=u-p*e;c[6]=t+r*e;c[10]=l*m}else"YXZ"===b?
(p=m*n,r=m*f,t=e*n,u=e*f,c[0]=p+u*d,c[4]=t*d-r,c[8]=l*e,c[1]=l*f,c[5]=l*n,c[9]=-d,c[2]=r*d-t,c[6]=u+p*d,c[10]=l*m):"ZXY"===b?(p=m*n,r=m*f,t=e*n,u=e*f,c[0]=p-u*d,c[4]=-l*f,c[8]=t+r*d,c[1]=r+t*d,c[5]=l*n,c[9]=u-p*d,c[2]=-l*e,c[6]=d,c[10]=l*m):"ZYX"===b?(p=l*n,r=l*f,t=d*n,u=d*f,c[0]=m*n,c[4]=t*e-r,c[8]=p*e+u,c[1]=m*f,c[5]=u*e+p,c[9]=r*e-t,c[2]=-e,c[6]=d*m,c[10]=l*m):"YZX"===b?(p=l*m,r=l*e,t=d*m,u=d*e,c[0]=m*n,c[4]=u-p*f,c[8]=t*f+r,c[1]=f,c[5]=l*n,c[9]=-d*n,c[2]=-e*n,c[6]=r*f+t,c[10]=p-u*f):"XZY"===b&&
(p=l*m,r=l*e,t=d*m,u=d*e,c[0]=m*n,c[4]=-f,c[8]=e*n,c[1]=p*f+u,c[5]=l*n,c[9]=r*f-t,c[2]=t*f-r,c[6]=d*n,c[10]=u*f+p);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,l=
c+c,m=d+d,n=e+e;a=c*l;var p=c*m,c=c*n,r=d*m,d=d*n,e=e*n,l=f*l,m=f*m,f=f*n;b[0]=1-(r+e);b[4]=p-f;b[8]=c+m;b[1]=p+f;b[5]=1-(a+e);b[9]=d-l;b[2]=c-m;b[6]=d+l;b[10]=1-(a+r);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var l=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());
b.crossVectors(c,a);l[0]=a.x;l[4]=b.x;l[8]=c.x;l[1]=a.y;l[5]=b.y;l[9]=c.y;l[2]=a.z;l[6]=b.z;l[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],l=c[4],m=c[8],n=c[12],p=c[1],r=c[5],t=c[9],u=c[13],z=c[2],E=c[6],C=c[10],A=c[14],
B=c[3],F=c[7],I=c[11],c=c[15],J=d[0],D=d[4],P=d[8],M=d[12],G=d[1],K=d[5],Y=d[9],T=d[13],O=d[2],fa=d[6],S=d[10],X=d[14],Q=d[3],Z=d[7],V=d[11],d=d[15];e[0]=f*J+l*G+m*O+n*Q;e[4]=f*D+l*K+m*fa+n*Z;e[8]=f*P+l*Y+m*S+n*V;e[12]=f*M+l*T+m*X+n*d;e[1]=p*J+r*G+t*O+u*Q;e[5]=p*D+r*K+t*fa+u*Z;e[9]=p*P+r*Y+t*S+u*V;e[13]=p*M+r*T+t*X+u*d;e[2]=z*J+E*G+C*O+A*Q;e[6]=z*D+E*K+C*fa+A*Z;e[10]=z*P+E*Y+C*S+A*V;e[14]=z*M+E*T+C*X+A*d;e[3]=B*J+F*G+I*O+c*Q;e[7]=B*D+F*K+I*fa+c*Z;e[11]=B*P+F*Y+I*S+c*V;e[15]=B*M+F*T+I*X+c*d;return this},
multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],l=a[5],m=a[9],n=a[13],p=a[2],r=a[6],t=a[10],u=a[14];return a[3]*(+e*m*r-d*n*r-e*l*t+c*n*t+d*l*u-c*m*u)+a[7]*(+b*m*u-b*n*t+e*f*t-d*f*u+d*n*p-e*m*p)+a[11]*(+b*n*r-b*l*u-e*f*r+c*f*u+e*l*p-c*n*p)+a[15]*(-d*l*p-b*m*r+b*l*t+d*f*r-c*f*
t+c*m*p)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;
a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;
b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],l=d[8],m=d[12],n=d[1],p=d[5],r=d[9],t=d[13],u=d[2],z=d[6],E=d[10],C=d[14],A=d[3],B=d[7],F=d[11],I=d[15];c[0]=r*C*B-t*E*B+t*z*F-p*C*F-r*z*I+p*E*I;c[4]=m*E*B-l*C*B-m*z*F+f*C*F+l*z*I-f*E*I;c[8]=l*t*B-m*r*B+m*p*F-f*t*F-l*p*I+f*r*I;c[12]=m*r*z-l*t*z-m*p*E+f*t*E+l*p*C-f*r*C;c[1]=t*E*A-r*C*A-t*u*F+n*C*F+r*u*I-n*E*I;c[5]=l*C*A-m*E*A+m*u*F-e*C*F-l*u*I+e*E*I;c[9]=m*r*A-l*t*A-m*n*F+e*t*F+l*n*I-
e*r*I;c[13]=l*t*u-m*r*u+m*n*E-e*t*E-l*n*C+e*r*C;c[2]=p*C*A-t*z*A+t*u*B-n*C*B-p*u*I+n*z*I;c[6]=m*z*A-f*C*A-m*u*B+e*C*B+f*u*I-e*z*I;c[10]=f*t*A-m*p*A+m*n*B-e*t*B-f*n*I+e*p*I;c[14]=m*p*u-f*t*u-m*n*z+e*t*z+f*n*C-e*p*C;c[3]=r*z*A-p*E*A-r*u*B+n*E*B+p*u*F-n*z*F;c[7]=f*E*A-l*z*A+l*u*B-e*E*B-f*u*F+e*z*F;c[11]=l*p*A-f*r*A-l*n*B+e*r*B+f*n*F-e*p*F;c[15]=f*r*u-l*p*u+l*n*z-e*r*z-f*n*E+e*p*E;c=d[0]*c[0]+d[1]*c[4]+d[2]*c[8]+d[3]*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");
console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(a){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(a){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(a){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(a,
b){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},
makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,l=a.y,m=a.z,n=e*f,p=e*l;this.set(n*f+c,n*l-d*m,n*m+d*l,0,n*l+d*m,p*l+c,p*m-d*f,0,n*m-
d*l,p*m+d*f,e*m*m+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code.");return this.makeFromPositionQuaternionScale(a,b,c)},makeFromPositionQuaternionScale:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},makeFromPositionEulerScale:function(a,
b,c,d){this.makeRotationFromEuler(b,c);this.scale(d);this.setPosition(a);return this},makeFrustum:function(a,b,c,d,e,f){var l=this.elements;l[0]=2*e/(b-a);l[4]=0;l[8]=(b+a)/(b-a);l[12]=0;l[1]=0;l[5]=2*e/(d-c);l[9]=(d+c)/(d-c);l[13]=0;l[2]=0;l[6]=0;l[10]=-(f+e)/(f-e);l[14]=-2*f*e/(f-e);l[3]=0;l[7]=0;l[11]=-1;l[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(0.5*a));var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var l=
this.elements,m=b-a,n=c-d,p=f-e;l[0]=2/m;l[4]=0;l[8]=0;l[12]=-((b+a)/m);l[1]=0;l[5]=2/n;l[9]=0;l[13]=-((c+d)/n);l[2]=0;l[6]=0;l[10]=-2/p;l[14]=-((f+e)/p);l[3]=0;l[7]=0;l[11]=0;l[15]=1;return this},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};
THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Matrix4;return function(e,f,l){var m=this.elements;a.set(m[0],m[1],m[2]);b.set(m[4],m[5],m[6]);c.set(m[8],m[9],m[10]);e=e instanceof THREE.Vector3?e:new THREE.Vector3;f=f instanceof THREE.Quaternion?f:new THREE.Quaternion;l=l instanceof THREE.Vector3?l:new THREE.Vector3;l.x=a.length();l.y=b.length();l.z=c.length();e.x=m[12];e.y=m[13];e.z=m[14];d.copy(this);d.elements[0]/=
l.x;d.elements[1]/=l.x;d.elements[2]/=l.x;d.elements[4]/=l.y;d.elements[5]/=l.y;d.elements[6]/=l.y;d.elements[8]/=l.z;d.elements[9]/=l.z;d.elements[10]/=l.z;f.setFromRotationMatrix(d);return[e,f,l]}}()});THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){return 0!=a.normal.dot(this.direction)||0==a.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(a){var b=
a.normal.dot(this.direction);if(0==b){if(0==a.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(a.normal)+a.constant)/b},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return void 0===c?void 0:this.at(c,b)},applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};
THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromCenterAndPoints:function(a,b){for(var c=0,d=0,e=b.length;d<e;d++)var f=a.distanceToSquared(b[d]),c=Math.max(c,f);this.center=a;this.radius=Math.sqrt(c);return this},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-
this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);
this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var l=this.planes;l[0].copy(a);l[1].copy(b);l[2].copy(c);l[3].copy(d);l[4].copy(e);l[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],l=c[4],m=c[5],n=c[6],p=c[7],r=c[8],t=c[9],u=c[10],z=c[11],E=c[12],C=c[13],A=c[14],c=c[15];b[0].setComponents(f-a,p-l,z-r,c-E).normalize();b[1].setComponents(f+
a,p+l,z+r,c+E).normalize();b[2].setComponents(f+d,p+m,z+t,c+C).normalize();b[3].setComponents(f-d,p-m,z-t,c-C).normalize();b[4].setComponents(f-e,p-n,z-u,c-A).normalize();b[5].setComponents(f+e,p+n,z+u,c+A).normalize();return this},intersectsObject:function(){var a=new THREE.Vector3;return function(b){var c=b.matrixWorld,d=this.planes;b=-b.geometry.boundingSphere.radius*c.getMaxScaleOnAxis();a.getPositionFromMatrix(c);for(c=0;6>c;c++)if(d[c].distanceToPoint(a)<b)return!1;return!0}}(),intersectsSphere:function(a){var b=
this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){d=d||(new THREE.Matrix3).getNormalMatrix(c);var e=a.copy(this.normal).applyMatrix3(d),f=this.coplanarPoint(b);f.applyMatrix4(c);this.setFromNormalAndCoplanarPoint(e,f);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,
b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}()};
THREE.Spline=function(a){function b(a,b,c,d,e,f,l){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*l+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c=[],d={x:0,y:0,z:0},e,f,l,m,n,p,r,t,u;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){e=(this.points.length-1)*a;f=Math.floor(e);l=e-f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>this.points.length-2?this.points.length-1:f+1;c[3]=f>this.points.length-3?this.points.length-1:
f+2;p=this.points[c[0]];r=this.points[c[1]];t=this.points[c[2]];u=this.points[c[3]];m=l*l;n=l*m;d.x=b(p.x,r.x,t.x,u.x,l,m,n);d.y=b(p.y,r.y,t.y,u.y,l,m,n);d.z=b(p.z,r.z,t.z,u.z,l,m,n);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,e=b=b=0,f=new THREE.Vector3,l=new THREE.Vector3,p=[],m=0;p[0]=0;a||(a=100);c=this.points.length*a;f.copy(this.points[0]);for(a=1;a<c;a++)b=
a/c,d=this.getPoint(b),l.copy(d),m+=l.distanceTo(f),f.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=e&&(p[b]=m,e=b);p[p.length]=m;return{chunks:p,total:m}};this.reparametrizeByArcLength=function(a){var b,c,d,e,f,l,p=[],m=new THREE.Vector3,n=this.getLength();p.push(m.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=n.chunks[b]-n.chunks[b-1];l=Math.ceil(a*c/n.total);e=(b-1)/(this.points.length-1);f=b/(this.points.length-1);for(c=1;c<l-1;c++)d=e+c*(1/l)*(f-e),d=this.getPoint(d),
p.push(m.copy(d).clone());p.push(m.copy(this.points[b]).clone())}this.points=p}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,l,m){a.subVectors(l,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var n=b.dot(b);l=b.dot(c);var p=d*n-e*e;m=m||new THREE.Vector3;if(0==p)return m.set(-2,-1,-1);p=1/p;n=(n*f-e*l)*p;d=(d*l-e*f)*p;return m.set(1-n-d,d,n)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():
Date.now(),a=0.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners,d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}},dispatchEvent:function(a){if(void 0!==
this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}};
(function(a){a.Raycaster=function(b,c,d,e){this.ray=new a.Ray(b,c);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=d||0;this.far=e||Infinity};var b=new a.Sphere,c=new a.Ray,d=new a.Plane,e=new a.Vector3,f=new a.Vector3,l=new a.Matrix4,m=function(a,b){return a.distance-b.distance},n=function(p,m,u){if(p instanceof a.Particle){f.getPositionFromMatrix(p.matrixWorld);var z=m.ray.distanceToPoint(f);if(z>p.scale.x)return u;u.push({distance:z,point:p.position,face:null,object:p})}else if(p instanceof
a.LOD)f.getPositionFromMatrix(p.matrixWorld),z=m.ray.origin.distanceTo(f),n(p.getObjectForDistance(z),m,u);else if(p instanceof a.Mesh){f.getPositionFromMatrix(p.matrixWorld);b.set(f,p.geometry.boundingSphere.radius*p.matrixWorld.getMaxScaleOnAxis());if(!m.ray.isIntersectionSphere(b))return u;var z=p.geometry,E=z.vertices,C=p.material instanceof a.MeshFaceMaterial,A=!0===C?p.material.materials:null,B=p.material.side,F,I,J,D=m.precision;l.getInverse(p.matrixWorld);c.copy(m.ray).applyMatrix4(l);for(var P=
0,M=z.faces.length;P<M;P++){var G=z.faces[P],B=!0===C?A[G.materialIndex]:p.material;if(void 0!==B){d.setFromNormalAndCoplanarPoint(G.normal,E[G.a]);var K=c.distanceToPlane(d);if(!(Math.abs(K)<D||0>K)){B=B.side;if(B!==a.DoubleSide&&(F=c.direction.dot(d.normal),!(B===a.FrontSide?0>F:0<F)))continue;if(!(K<m.near||K>m.far)){e=c.at(K,e);if(G instanceof a.Face3){if(B=E[G.a],F=E[G.b],I=E[G.c],!a.Triangle.containsPoint(e,B,F,I))continue}else if(G instanceof a.Face4){if(B=E[G.a],F=E[G.b],I=E[G.c],J=E[G.d],
!a.Triangle.containsPoint(e,B,F,J)&&!a.Triangle.containsPoint(e,F,I,J))continue}else throw Error("face type not supported");u.push({distance:K,point:m.ray.at(K),face:G,faceIndex:P,object:p})}}}}}},p=function(a,b,c){a=a.getDescendants();for(var d=0,e=a.length;d<e;d++)n(a[d],b,c)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b);0<this.ray.direction.length()&&this.ray.direction.normalize()};a.Raycaster.prototype.intersectObject=function(a,b){var c=[];!0===
b&&p(a,this,c);n(a,this,c);c.sort(m);return c};a.Raycaster.prototype.intersectObjects=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)n(a[d],this,c),!0===b&&p(a[d],this,c);c.sort(m);return c}})(THREE);
THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder=THREE.Object3D.defaultEulerOrder;this.scale=new THREE.Vector3(1,1,1);this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=
!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};
THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var a=new THREE.Matrix4;return function(b){this.matrix.multiplyMatrices(b,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);a.extractRotation(this.matrix);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}(),rotateOnAxis:function(){var a=new THREE.Quaternion,b=new THREE.Quaternion;return function(c,
d){a.setFromAxisAngle(c,d);!0===this.useQuaternion?this.quaternion.multiply(a):(b.setFromEuler(this.rotation,this.eulerOrder),b.multiply(a),this.rotation.setEulerFromQuaternion(b,this.eulerOrder));return this}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b);!0===this.useQuaternion?a.applyQuaternion(this.quaternion):a.applyEuler(this.rotation,this.eulerOrder);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&
b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},getObjectById:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.id===a||!0===b&&(e=e.getObjectById(a,b),void 0!==e))return e}},
getObjectByName:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.name===a||!0===b&&(e=e.getObjectByName(a,b),void 0!==e))return e}},getChildByName:function(a,b){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getDescendants:function(a){void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<c;b++)this.children[b].getDescendants(a);return a},
updateMatrix:function(){!1===this.useQuaternion?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},clone:function(a){void 0===a&&(a=new THREE.Object3D);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.rotation instanceof THREE.Vector3&&a.rotation.copy(this.rotation);a.eulerOrder=this.eulerOrder;a.scale.copy(this.scale);a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=
this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.quaternion.copy(this.quaternion);a.useQuaternion=this.useQuaternion;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;a.userData=JSON.parse(JSON.stringify(this.userData));for(var b=0;b<this.children.length;b++)a.add(this.children[b].clone());return a}};THREE.Object3D.defaultEulerOrder="XYZ";THREE.Object3DIdCount=0;
THREE.Projector=function(){function a(){if(f===m){var a=new THREE.RenderableObject;l.push(a);m++;f++;return a}return l[f++]}function b(){if(p===t){var a=new THREE.RenderableVertex;r.push(a);t++;p++;return a}return r[p++]}function c(a,b){return b.z-a.z}function d(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,l=-a.z+a.w,p=-b.z+b.w;if(0<=e&&0<=f&&0<=l&&0<=p)return!0;if(0>e&&0>f||0>l&&0>p)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>l?c=Math.max(c,l/(l-p)):0>p&&(d=Math.min(d,l/(l-p)));if(d<
c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var e,f,l=[],m=0,n,p,r=[],t=0,u,z,E=[],C=0,A,B=[],F=0,I,J,D=[],P=0,M,G,K=[],Y=0,T={objects:[],sprites:[],lights:[],elements:[]},O=new THREE.Vector3,fa=new THREE.Vector4,S=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),X=new THREE.Box3,Q=Array(3),Z=Array(4),V=new THREE.Matrix4,da=new THREE.Matrix4,W,ua=new THREE.Matrix4,aa=new THREE.Matrix3,ja=new THREE.Matrix3,N=new THREE.Vector3,ma=new THREE.Frustum,U=new THREE.Vector4,ga=new THREE.Vector4;
this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);da.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);return a.applyProjection(da)};this.unprojectVector=function(a,b){b.projectionMatrixInverse.getInverse(b.projectionMatrix);da.multiplyMatrices(b.matrixWorld,b.projectionMatrixInverse);return a.applyProjection(da)};this.pickingRay=function(a,b){a.z=-1;var c=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(c,b);c.sub(a).normalize();return new THREE.Raycaster(a,
c)};var va=function(b,d){f=0;T.objects.length=0;T.sprites.length=0;T.lights.length=0;var l=function(b){for(var c=0,d=b.children.length;c<d;c++){var f=b.children[c];if(!1!==f.visible){if(f instanceof THREE.Light)T.lights.push(f);else if(f instanceof THREE.Mesh||f instanceof THREE.Line){if(!1===f.frustumCulled||!0===ma.intersectsObject(f))e=a(),e.object=f,null!==f.renderDepth?e.z=f.renderDepth:(O.getPositionFromMatrix(f.matrixWorld),O.applyProjection(da),e.z=O.z),T.objects.push(e)}else f instanceof
THREE.Sprite||f instanceof THREE.Particle?(e=a(),e.object=f,null!==f.renderDepth?e.z=f.renderDepth:(O.getPositionFromMatrix(f.matrixWorld),O.applyProjection(da),e.z=O.z),T.sprites.push(e)):(e=a(),e.object=f,null!==f.renderDepth?e.z=f.renderDepth:(O.getPositionFromMatrix(f.matrixWorld),O.applyProjection(da),e.z=O.z),T.objects.push(e));l(f)}}};l(b);!0===d&&T.objects.sort(c);return T};this.projectScene=function(a,e,f,l){var m=!1,t,O,na,ha,ra,za,wa,Aa,q,db,sa,cb,Ma;G=J=A=z=0;T.elements.length=0;!0===
a.autoUpdate&&a.updateMatrixWorld();void 0===e.parent&&e.updateMatrixWorld();V.copy(e.matrixWorldInverse.getInverse(e.matrixWorld));da.multiplyMatrices(e.projectionMatrix,V);ja.getNormalMatrix(V);ma.setFromMatrix(da);T=va(a,f);a=0;for(f=T.objects.length;a<f;a++)if(Aa=T.objects[a].object,W=Aa.matrixWorld,p=0,Aa instanceof THREE.Mesh){q=Aa.geometry;na=q.vertices;db=q.faces;q=q.faceVertexUvs;aa.getNormalMatrix(W);cb=Aa.material instanceof THREE.MeshFaceMaterial;Ma=!0===cb?Aa.material:null;t=0;for(O=
na.length;t<O;t++)n=b(),n.positionWorld.copy(na[t]).applyMatrix4(W),n.positionScreen.copy(n.positionWorld).applyMatrix4(da),n.positionScreen.x/=n.positionScreen.w,n.positionScreen.y/=n.positionScreen.w,n.positionScreen.z/=n.positionScreen.w,n.visible=!(-1>n.positionScreen.x||1<n.positionScreen.x||-1>n.positionScreen.y||1<n.positionScreen.y||-1>n.positionScreen.z||1<n.positionScreen.z);na=0;for(t=db.length;na<t;na++){O=db[na];var wb=!0===cb?Ma.materials[O.materialIndex]:Aa.material;if(void 0!==wb){za=
wb.side;if(O instanceof THREE.Face3)if(ha=r[O.a],ra=r[O.b],wa=r[O.c],Q[0]=ha.positionScreen,Q[1]=ra.positionScreen,Q[2]=wa.positionScreen,!0===ha.visible||!0===ra.visible||!0===wa.visible||S.isIntersectionBox(X.setFromPoints(Q)))if(m=0>(wa.positionScreen.x-ha.positionScreen.x)*(ra.positionScreen.y-ha.positionScreen.y)-(wa.positionScreen.y-ha.positionScreen.y)*(ra.positionScreen.x-ha.positionScreen.x),za===THREE.DoubleSide||m===(za===THREE.FrontSide))z===C?(sa=new THREE.RenderableFace3,E.push(sa),
C++,z++,u=sa):u=E[z++],u.v1.copy(ha),u.v2.copy(ra),u.v3.copy(wa);else continue;else continue;else if(O instanceof THREE.Face4)if(ha=r[O.a],ra=r[O.b],wa=r[O.c],sa=r[O.d],Z[0]=ha.positionScreen,Z[1]=ra.positionScreen,Z[2]=wa.positionScreen,Z[3]=sa.positionScreen,!0===ha.visible||!0===ra.visible||!0===wa.visible||!0===sa.visible||S.isIntersectionBox(X.setFromPoints(Z)))if(m=0>(sa.positionScreen.x-ha.positionScreen.x)*(ra.positionScreen.y-ha.positionScreen.y)-(sa.positionScreen.y-ha.positionScreen.y)*
(ra.positionScreen.x-ha.positionScreen.x)||0>(ra.positionScreen.x-wa.positionScreen.x)*(sa.positionScreen.y-wa.positionScreen.y)-(ra.positionScreen.y-wa.positionScreen.y)*(sa.positionScreen.x-wa.positionScreen.x),za===THREE.DoubleSide||m===(za===THREE.FrontSide)){if(A===F){var tb=new THREE.RenderableFace4;B.push(tb);F++;A++;u=tb}else u=B[A++];u.v1.copy(ha);u.v2.copy(ra);u.v3.copy(wa);u.v4.copy(sa)}else continue;else continue;u.normalModel.copy(O.normal);!1!==m||za!==THREE.BackSide&&za!==THREE.DoubleSide||
u.normalModel.negate();u.normalModel.applyMatrix3(aa).normalize();u.normalModelView.copy(u.normalModel).applyMatrix3(ja);u.centroidModel.copy(O.centroid).applyMatrix4(W);wa=O.vertexNormals;ha=0;for(ra=wa.length;ha<ra;ha++)sa=u.vertexNormalsModel[ha],sa.copy(wa[ha]),!1!==m||za!==THREE.BackSide&&za!==THREE.DoubleSide||sa.negate(),sa.applyMatrix3(aa).normalize(),u.vertexNormalsModelView[ha].copy(sa).applyMatrix3(ja);u.vertexNormalsLength=wa.length;ha=0;for(ra=q.length;ha<ra;ha++)if(sa=q[ha][na],void 0!==
sa)for(za=0,wa=sa.length;za<wa;za++)u.uvs[ha][za]=sa[za];u.color=O.color;u.material=wb;N.copy(u.centroidModel).applyProjection(da);u.z=N.z;T.elements.push(u)}}}else if(Aa instanceof THREE.Line)for(ua.multiplyMatrices(da,W),na=Aa.geometry.vertices,ha=b(),ha.positionScreen.copy(na[0]).applyMatrix4(ua),db=Aa.type===THREE.LinePieces?2:1,t=1,O=na.length;t<O;t++)ha=b(),ha.positionScreen.copy(na[t]).applyMatrix4(ua),0<(t+1)%db||(ra=r[p-2],U.copy(ha.positionScreen),ga.copy(ra.positionScreen),!0===d(U,ga)&&
(U.multiplyScalar(1/U.w),ga.multiplyScalar(1/ga.w),J===P?(q=new THREE.RenderableLine,D.push(q),P++,J++,I=q):I=D[J++],I.v1.positionScreen.copy(U),I.v2.positionScreen.copy(ga),I.z=Math.max(U.z,ga.z),I.material=Aa.material,Aa.material.vertexColors===THREE.VertexColors&&(I.vertexColors[0].copy(Aa.geometry.colors[t]),I.vertexColors[1].copy(Aa.geometry.colors[t-1])),T.elements.push(I)));a=0;for(f=T.sprites.length;a<f;a++)Aa=T.sprites[a].object,W=Aa.matrixWorld,Aa instanceof THREE.Particle&&(fa.set(W.elements[12],
W.elements[13],W.elements[14],1),fa.applyMatrix4(da),fa.z/=fa.w,0<fa.z&&1>fa.z&&(G===Y?(m=new THREE.RenderableParticle,K.push(m),Y++,G++,M=m):M=K[G++],M.object=Aa,M.x=fa.x/fa.w,M.y=fa.y/fa.w,M.z=fa.z,M.rotation=Aa.rotation.z,M.scale.x=Aa.scale.x*Math.abs(M.x-(fa.x+e.projectionMatrix.elements[0])/(fa.w+e.projectionMatrix.elements[12])),M.scale.y=Aa.scale.y*Math.abs(M.y-(fa.y+e.projectionMatrix.elements[5])/(fa.w+e.projectionMatrix.elements[13])),M.material=Aa.material,T.elements.push(M)));!0===l&&
T.elements.sort(c);return T}};THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,d,e,f,l){this.a=a;this.b=b;this.c=c;this.d=d;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=void 0!==l?l:0;this.centroid=new THREE.Vector3};
THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var a=new THREE.Face4(this.a,this.b,this.c,this.d);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};
THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){var e=
this.faces[c];e.normal.applyMatrix3(b).normalize();for(var f=0,l=e.vertexNormals.length;f<l;f++)e.vertexNormals[f].applyMatrix3(b).normalize();e.centroid.applyMatrix4(a)}},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,0,0),c instanceof THREE.Face3?(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.add(this.vertices[c.a]),
c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.add(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],l=this.vertices[e.b];a.subVectors(this.vertices[e.c],l);b.subVectors(f,l);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d,e;if(void 0===this.__tmpVertices){e=this.__tmpVertices=
Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)e[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:d instanceof THREE.Face4&&(d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(e=this.__tmpVertices,b=0,c=this.vertices.length;b<c;b++)e[b].set(0,0,0);if(a){var f,l,m,n=new THREE.Vector3,p=new THREE.Vector3,r=new THREE.Vector3,
t=new THREE.Vector3,u=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(a=this.vertices[d.a],f=this.vertices[d.b],l=this.vertices[d.c],n.subVectors(l,f),p.subVectors(a,f),n.cross(p),e[d.a].add(n),e[d.b].add(n),e[d.c].add(n)):d instanceof THREE.Face4&&(a=this.vertices[d.a],f=this.vertices[d.b],l=this.vertices[d.c],m=this.vertices[d.d],r.subVectors(m,f),p.subVectors(a,f),r.cross(p),e[d.a].add(r),e[d.b].add(r),e[d.d].add(r),t.subVectors(m,l),u.subVectors(f,
l),t.cross(u),e[d.b].add(t),e[d.c].add(t),e[d.d].add(t))}else for(b=0,c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal)):d instanceof THREE.Face4&&(e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal),e[d.d].add(d.normal));b=0;for(c=this.vertices.length;b<c;b++)e[b].normalize();b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),
d.vertexNormals[2].copy(e[d.c])):d instanceof THREE.Face4&&(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),d.vertexNormals[2].copy(e[d.c]),d.vertexNormals[3].copy(e[d.d]))},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++)for(e=this.faces[c],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),a=0,b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?
e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone();var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];var l=this.morphNormals[a].faceNormals,m=this.morphNormals[a].vertexNormals,n,p;c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],n=new THREE.Vector3,p=e instanceof THREE.Face3?
{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},l.push(n),m.push(p)}l=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],n=l.faceNormals[c],p=l.vertexNormals[c],n.copy(e.normal),e instanceof THREE.Face3?(p.a.copy(e.vertexNormals[0]),p.b.copy(e.vertexNormals[1]),p.c.copy(e.vertexNormals[2])):(p.a.copy(e.vertexNormals[0]),
p.b.copy(e.vertexNormals[1]),p.c.copy(e.vertexNormals[2]),p.d.copy(e.vertexNormals[3]))}c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function a(a,b,c,d,e,f,G){m=a.vertices[b];n=a.vertices[c];p=a.vertices[d];r=l[e];t=l[f];u=l[G];z=n.x-m.x;E=p.x-m.x;C=n.y-m.y;A=p.y-m.y;B=n.z-m.z;F=p.z-m.z;I=t.x-r.x;J=u.x-r.x;D=t.y-r.y;P=u.y-r.y;M=1/(I*P-J*D);T.set((P*z-D*E)*M,(P*C-D*A)*M,(P*B-D*F)*M);O.set((I*
E-J*z)*M,(I*A-J*C)*M,(I*F-J*B)*M);K[b].add(T);K[c].add(T);K[d].add(T);Y[b].add(O);Y[c].add(O);Y[d].add(O)}var b,c,d,e,f,l,m,n,p,r,t,u,z,E,C,A,B,F,I,J,D,P,M,G,K=[],Y=[],T=new THREE.Vector3,O=new THREE.Vector3,fa=new THREE.Vector3,S=new THREE.Vector3,X=new THREE.Vector3;b=0;for(c=this.vertices.length;b<c;b++)K[b]=new THREE.Vector3,Y[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)f=this.faces[b],l=this.faceVertexUvs[0][b],f instanceof THREE.Face3?a(this,f.a,f.b,f.c,0,1,2):f instanceof THREE.Face4&&
(a(this,f.a,f.b,f.d,0,1,3),a(this,f.b,f.c,f.d,1,2,3));var Q=["a","b","c","d"];b=0;for(c=this.faces.length;b<c;b++)for(f=this.faces[b],d=0;d<f.vertexNormals.length;d++)X.copy(f.vertexNormals[d]),e=f[Q[d]],G=K[e],fa.copy(G),fa.sub(X.multiplyScalar(X.dot(G))).normalize(),S.crossVectors(f.vertexNormals[d],G),e=S.dot(Y[e]),e=0>e?-1:1,f.vertexTangents[d]=new THREE.Vector4(fa.x,fa.y,fa.z,e);this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-
1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,l,m,n,p;this.__tmpVertices=void 0;f=0;for(l=this.vertices.length;f<l;f++)d=this.vertices[f],
d=[Math.round(d.x*e),Math.round(d.y*e),Math.round(d.z*e)].join("_"),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];e=[];f=0;for(l=this.faces.length;f<l;f++)if(a=this.faces[f],a instanceof THREE.Face3)for(a.a=c[a.a],a.b=c[a.b],a.c=c[a.c],m=[a.a,a.b,a.c],d=-1,n=0;3>n;n++){if(m[n]==m[(n+1)%3]){e.push(f);break}}else if(a instanceof THREE.Face4){a.a=c[a.a];a.b=c[a.b];a.c=c[a.c];a.d=c[a.d];m=[a.a,a.b,a.c,a.d];d=-1;for(n=0;4>n;n++)m[n]==m[(n+1)%4]&&(0<=d&&e.push(f),d=n);if(0<=
d){m.splice(d,1);var r=new THREE.Face3(m[0],m[1],m[2],a.normal,a.color,a.materialIndex);m=0;for(n=this.faceVertexUvs.length;m<n;m++)(p=this.faceVertexUvs[m][f])&&p.splice(d,1);a.vertexNormals&&0<a.vertexNormals.length&&(r.vertexNormals=a.vertexNormals,r.vertexNormals.splice(d,1));a.vertexColors&&0<a.vertexColors.length&&(r.vertexColors=a.vertexColors,r.vertexColors.splice(d,1));this.faces[f]=r}}for(f=e.length-1;0<=f;f--)for(this.faces.splice(f,1),m=0,n=this.faceVertexUvs.length;m<n;m++)this.faceVertexUvs[m].splice(f,
1);c=this.vertices.length-b.length;this.vertices=b;return c},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(d=b.length;c<d;c++){for(var e=b[c],f=[],l=0,m=e.length;l<m;l++)f.push(new THREE.Vector2(e[l].x,e[l].y));a.faceVertexUvs[0].push(f)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.GeometryIdCount=0;
THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.attributes={};this.dynamic=!1;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(a){var b,c;this.attributes.position&&(b=this.attributes.position.array);this.attributes.normal&&(c=this.attributes.normal.array);void 0!==b&&(a.multiplyVector3Array(b),
this.verticesNeedUpdate=!0);void 0!==c&&((new THREE.Matrix3).getNormalMatrix(a).multiplyVector3Array(c),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var a=this.attributes.position.array;if(a){var b=this.boundingBox,c,d,e;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var f=3,l=a.length;f<l;f+=3)c=a[f],d=a[f+1],e=a[f+2],c<b.min.x?b.min.x=c:c>b.max.x&&(b.max.x=c),d<b.min.y?
b.min.y=d:d>b.max.y&&(b.max.y=d),e<b.min.z?b.min.z=e:e>b.max.z&&(b.max.z=e)}if(void 0===a||0===a.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var a=this.attributes.position.array;if(a){for(var b,c=0,d,e,f=0,l=a.length;f<l;f+=3)b=a[f],d=a[f+1],e=a[f+2],b=b*b+d*d+e*e,b>c&&(c=b);this.boundingSphere.radius=Math.sqrt(c)}},computeVertexNormals:function(){if(this.attributes.position){var a,
b,c,d;a=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(a),numItems:a};else for(a=0,b=this.attributes.normal.array.length;a<b;a++)this.attributes.normal.array[a]=0;var e=this.attributes.position.array,f=this.attributes.normal.array,l,m,n,p,r,t,u=new THREE.Vector3,z=new THREE.Vector3,E=new THREE.Vector3,C=new THREE.Vector3,A=new THREE.Vector3;if(this.attributes.index){var B=this.attributes.index.array,F=this.offsets;
c=0;for(d=F.length;c<d;++c){b=F[c].start;l=F[c].count;var I=F[c].index;a=b;for(b+=l;a<b;a+=3)l=I+B[a],m=I+B[a+1],n=I+B[a+2],p=e[3*l],r=e[3*l+1],t=e[3*l+2],u.set(p,r,t),p=e[3*m],r=e[3*m+1],t=e[3*m+2],z.set(p,r,t),p=e[3*n],r=e[3*n+1],t=e[3*n+2],E.set(p,r,t),C.subVectors(E,z),A.subVectors(u,z),C.cross(A),f[3*l]+=C.x,f[3*l+1]+=C.y,f[3*l+2]+=C.z,f[3*m]+=C.x,f[3*m+1]+=C.y,f[3*m+2]+=C.z,f[3*n]+=C.x,f[3*n+1]+=C.y,f[3*n+2]+=C.z}}else for(a=0,b=e.length;a<b;a+=9)p=e[a],r=e[a+1],t=e[a+2],u.set(p,r,t),p=e[a+
3],r=e[a+4],t=e[a+5],z.set(p,r,t),p=e[a+6],r=e[a+7],t=e[a+8],E.set(p,r,t),C.subVectors(E,z),A.subVectors(u,z),C.cross(A),f[a]=C.x,f[a+1]=C.y,f[a+2]=C.z,f[a+3]=C.x,f[a+4]=C.y,f[a+5]=C.z,f[a+6]=C.x,f[a+7]=C.y,f[a+8]=C.z;this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,e=0,f=a.length;e<f;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},computeTangents:function(){function a(a,b,c){t=d[3*a];
u=d[3*a+1];z=d[3*a+2];E=d[3*b];C=d[3*b+1];A=d[3*b+2];B=d[3*c];F=d[3*c+1];I=d[3*c+2];J=f[2*a];D=f[2*a+1];P=f[2*b];M=f[2*b+1];G=f[2*c];K=f[2*c+1];Y=E-t;T=B-t;O=C-u;fa=F-u;S=A-z;X=I-z;Q=P-J;Z=G-J;V=M-D;da=K-D;W=1/(Q*da-Z*V);ua.set((da*Y-V*T)*W,(da*O-V*fa)*W,(da*S-V*X)*W);aa.set((Q*T-Z*Y)*W,(Q*fa-Z*O)*W,(Q*X-Z*S)*W);p[a].add(ua);p[b].add(ua);p[c].add(ua);r[a].add(aa);r[b].add(aa);r[c].add(aa)}function b(a){Ka.x=e[3*a];Ka.y=e[3*a+1];Ka.z=e[3*a+2];bb.copy(Ka);ya=p[a];Pa.copy(ya);Pa.sub(Ka.multiplyScalar(Ka.dot(ya))).normalize();
jb.crossVectors(bb,ya);na=jb.dot(r[a]);ta=0>na?-1:1;n[4*a]=Pa.x;n[4*a+1]=Pa.y;n[4*a+2]=Pa.z;n[4*a+3]=ta}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,d=this.attributes.position.array,e=this.attributes.normal.array,f=this.attributes.uv.array,l=d.length/3;if(void 0===
this.attributes.tangent){var m=4*l;this.attributes.tangent={itemSize:4,array:new Float32Array(m),numItems:m}}for(var n=this.attributes.tangent.array,p=[],r=[],m=0;m<l;m++)p[m]=new THREE.Vector3,r[m]=new THREE.Vector3;var t,u,z,E,C,A,B,F,I,J,D,P,M,G,K,Y,T,O,fa,S,X,Q,Z,V,da,W,ua=new THREE.Vector3,aa=new THREE.Vector3,ja,N,ma,U,ga,va=this.offsets,m=0;for(N=va.length;m<N;++m){ja=va[m].start;ma=va[m].count;var ia=va[m].index,l=ja;for(ja+=ma;l<ja;l+=3)ma=ia+c[l],U=ia+c[l+1],ga=ia+c[l+2],a(ma,U,ga)}var Pa=
new THREE.Vector3,jb=new THREE.Vector3,Ka=new THREE.Vector3,bb=new THREE.Vector3,ta,ya,na,m=0;for(N=va.length;m<N;++m)for(ja=va[m].start,ma=va[m].count,ia=va[m].index,l=ja,ja+=ma;l<ja;l+=3)ma=ia+c[l],U=ia+c[l+1],ga=ia+c[l+2],b(ma),b(U),b(ga);this.tangentsNeedUpdate=this.hasTangents=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}};
THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}();
THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);
THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,
0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.position.set(0,100,0);this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};
THREE.SpotLight=function(a,b,c,d,e){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.exponent=void 0!==e?e:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=
this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};
THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/
a.total).toFixed(0)+"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=THREE.Loader.prototype.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function e(a,b){var e=new Image;e.onload=function(){if(c(this.width)&&c(this.height))a.image=this;else{var b=d(this.width),e=d(this.height);a.image.width=b;a.image.height=e;a.image.getContext("2d").drawImage(this,0,0,b,e)}a.needsUpdate=!0};e.crossOrigin=m.crossOrigin;e.src=b}function f(a,c,d,f,l,p,m){var n=/\.dds$/i.test(d),r=b+"/"+d;if(n){var J=THREE.ImageUtils.loadCompressedTexture(r);a[c]=J}else J=document.createElement("canvas"),
a[c]=new THREE.Texture(J);a[c].sourceFile=d;f&&(a[c].repeat.set(f[0],f[1]),1!==f[0]&&(a[c].wrapS=THREE.RepeatWrapping),1!==f[1]&&(a[c].wrapT=THREE.RepeatWrapping));l&&a[c].offset.set(l[0],l[1]);p&&(d={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==d[p[0]]&&(a[c].wrapS=d[p[0]]),void 0!==d[p[1]]&&(a[c].wrapT=d[p[1]]));m&&(a[c].anisotropy=m);n||e(a[c],r)}function l(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var m=this,n="MeshLambertMaterial",p={color:15658734,opacity:1,
map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var r=a.shading.toLowerCase();"phong"===r?n="MeshPhongMaterial":"basic"===r&&(n="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(p.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)p.transparent=a.transparent;void 0!==a.depthTest&&(p.depthTest=a.depthTest);void 0!==a.depthWrite&&(p.depthWrite=a.depthWrite);void 0!==a.visible&&(p.visible=a.visible);void 0!==a.flipSided&&(p.side=THREE.BackSide);
void 0!==a.doubleSided&&(p.side=THREE.DoubleSide);void 0!==a.wireframe&&(p.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?p.vertexColors=THREE.FaceColors:a.vertexColors&&(p.vertexColors=THREE.VertexColors));a.colorDiffuse?p.color=l(a.colorDiffuse):a.DbgColor&&(p.color=a.DbgColor);a.colorSpecular&&(p.specular=l(a.colorSpecular));a.colorAmbient&&(p.ambient=l(a.colorAmbient));a.transparency&&(p.opacity=a.transparency);a.specularCoef&&(p.shininess=a.specularCoef);a.mapDiffuse&&
b&&f(p,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&f(p,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&f(p,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&f(p,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&f(p,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(p.bumpScale=a.mapBumpScale);a.mapNormal?(n=THREE.ShaderLib.normalmap,r=THREE.UniformsUtils.clone(n.uniforms),r.tNormal.value=p.normalMap,a.mapNormalFactor&&r.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),p.map&&(r.tDiffuse.value=p.map,r.enableDiffuse.value=!0),p.specularMap&&(r.tSpecular.value=p.specularMap,r.enableSpecular.value=!0),p.lightMap&&(r.tAO.value=p.lightMap,r.enableAO.value=!0),r.uDiffuseColor.value.setHex(p.color),
r.uSpecularColor.value.setHex(p.specular),r.uAmbientColor.value.setHex(p.ambient),r.uShininess.value=p.shininess,void 0!==p.opacity&&(r.uOpacity.value=p.opacity),n=new THREE.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:r,lights:!0,fog:!0}),p.transparent&&(n.transparent=!0)):n=new THREE[n](p);void 0!==a.DbgName&&(n.name=a.DbgName);return n}};THREE.ImageLoader=function(){this.crossOrigin=null};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(a,b){var c=this;void 0===b&&(b=new Image);b.addEventListener("load",function(){c.dispatchEvent({type:"load",content:b})},!1);b.addEventListener("error",function(){c.dispatchEvent({type:"error",
message:"Couldn't load URL ["+a+"]"})},!1);c.crossOrigin&&(b.crossOrigin=c.crossOrigin);b.src=a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,l=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var m=JSON.parse(f.responseText),m=a.parse(m,d);c(m.geometry,m.materials)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");a.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING?e&&(0===l&&
(l=f.getResponseHeader("Content-Length")),e({total:l,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&void 0!==e&&(l=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};
THREE.JSONLoader.prototype.parse=function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1;(function(b){var d,l,m,n,p,r,t,u,z,E,C,A,B,F,I=a.faces;r=a.vertices;var J=a.normals,D=a.colors,P=0;for(d=0;d<a.uvs.length;d++)a.uvs[d].length&&P++;for(d=0;d<P;d++)c.faceUvs[d]=[],c.faceVertexUvs[d]=[];n=0;for(p=r.length;n<p;)t=new THREE.Vector3,t.x=r[n++]*b,t.y=r[n++]*b,t.z=r[n++]*b,c.vertices.push(t);n=0;for(p=I.length;n<p;){b=I[n++];r=b&1;m=b&2;d=b&4;l=b&8;u=b&16;t=b&32;E=b&64;b&=128;r?(C=new THREE.Face4,
C.a=I[n++],C.b=I[n++],C.c=I[n++],C.d=I[n++],r=4):(C=new THREE.Face3,C.a=I[n++],C.b=I[n++],C.c=I[n++],r=3);m&&(m=I[n++],C.materialIndex=m);m=c.faces.length;if(d)for(d=0;d<P;d++)A=a.uvs[d],z=I[n++],F=A[2*z],z=A[2*z+1],c.faceUvs[d][m]=new THREE.Vector2(F,z);if(l)for(d=0;d<P;d++){A=a.uvs[d];B=[];for(l=0;l<r;l++)z=I[n++],F=A[2*z],z=A[2*z+1],B[l]=new THREE.Vector2(F,z);c.faceVertexUvs[d][m]=B}u&&(u=3*I[n++],l=new THREE.Vector3,l.x=J[u++],l.y=J[u++],l.z=J[u],C.normal=l);if(t)for(d=0;d<r;d++)u=3*I[n++],l=
new THREE.Vector3,l.x=J[u++],l.y=J[u++],l.z=J[u],C.vertexNormals.push(l);E&&(t=I[n++],t=new THREE.Color(D[t]),C.color=t);if(b)for(d=0;d<r;d++)t=I[n++],t=new THREE.Color(D[t]),C.vertexColors.push(t);c.faces.push(C)}})(d);(function(){var b,d,l,m;if(a.skinWeights)for(b=0,d=a.skinWeights.length;b<d;b+=2)l=a.skinWeights[b],m=a.skinWeights[b+1],c.skinWeights.push(new THREE.Vector4(l,m,0,0));if(a.skinIndices)for(b=0,d=a.skinIndices.length;b<d;b+=2)l=a.skinIndices[b],m=a.skinIndices[b+1],c.skinIndices.push(new THREE.Vector4(l,
m,0,0));c.bones=a.bones;c.animation=a.animation})();(function(b){if(void 0!==a.morphTargets){var d,l,m,n,p,r;d=0;for(l=a.morphTargets.length;d<l;d++)for(c.morphTargets[d]={},c.morphTargets[d].name=a.morphTargets[d].name,c.morphTargets[d].vertices=[],p=c.morphTargets[d].vertices,r=a.morphTargets[d].vertices,m=0,n=r.length;m<n;m+=3){var t=new THREE.Vector3;t.x=r[m]*b;t.y=r[m+1]*b;t.z=r[m+2]*b;p.push(t)}}if(void 0!==a.morphColors)for(d=0,l=a.morphColors.length;d<l;d++)for(c.morphColors[d]={},c.morphColors[d].name=
a.morphColors[d].name,c.morphColors[d].colors=[],n=c.morphColors[d].colors,p=a.morphColors[d].colors,b=0,m=p.length;b<m;b+=3)r=new THREE.Color(16755200),r.setRGB(p[b],p[b+1],p[b+2]),n.push(r)})(d);c.computeCentroids();c.computeFaceNormals();if(void 0===a.materials)return{geometry:c};d=this.initMaterials(a.materials,b);this.needsTangents(d)&&c.computeTangents();return{geometry:c,materials:d}};
THREE.LoadingMonitor=function(){var a=this,b=0,c=0,d=function(d){b++;a.dispatchEvent({type:"progress",loaded:b,total:c});b===c&&a.dispatchEvent({type:"load"})};this.add=function(a){c++;a.addEventListener("load",d,!1)}};THREE.LoadingMonitor.prototype={constructor:THREE.LoadingMonitor,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent};
THREE.GeometryLoader=function(){};
THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(a){var b=this,c=new XMLHttpRequest;c.addEventListener("load",function(a){a=b.parse(JSON.parse(a.target.responseText));b.dispatchEvent({type:"load",content:a})},
!1);c.addEventListener("progress",function(a){b.dispatchEvent({type:"progress",loaded:a.loaded,total:a.total})},!1);c.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.open("GET",a,!0);c.send(null)},parse:function(a){}};THREE.MaterialLoader=function(){};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(a){var b=this,c=new XMLHttpRequest;c.addEventListener("load",function(a){a=b.parse(JSON.parse(a.target.responseText));b.dispatchEvent({type:"load",content:a})},
!1);c.addEventListener("progress",function(a){b.dispatchEvent({type:"progress",loaded:a.loaded,total:a.total})},!1);c.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.open("GET",a,!0);c.send(null)},parse:function(a){var b;switch(a.type){case "MeshBasicMaterial":b=new THREE.MeshBasicMaterial({color:a.color,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshLambertMaterial":b=new THREE.MeshLambertMaterial({color:a.color,
ambient:a.ambient,emissive:a.emissive,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshPhongMaterial":b=new THREE.MeshPhongMaterial({color:a.color,ambient:a.ambient,emissive:a.emissive,specular:a.specular,shininess:a.shininess,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshNormalMaterial":b=new THREE.MeshNormalMaterial({opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshDepthMaterial":b=new THREE.MeshDepthMaterial({opacity:a.opacity,
transparent:a.transparent,wireframe:a.wireframe})}return b}};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlerMap={};this.hierarchyHandlerMap={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype.constructor=THREE.SceneLoader;
THREE.SceneLoader.prototype.load=function(a,b){var c=this,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status||0===d.status){var e=JSON.parse(d.responseText);c.parse(e,b,a)}else console.error("THREE.SceneLoader: Couldn't load ["+a+"] ["+d.status+"]")};d.open("GET",a,!0);d.send(null)};THREE.SceneLoader.prototype.addGeometryHandler=function(a,b){this.geometryHandlerMap[a]={loaderClass:b}};
THREE.SceneLoader.prototype.addHierarchyHandler=function(a,b){this.hierarchyHandlerMap[a]={loaderClass:b}};
THREE.SceneLoader.prototype.parse=function(a,b,c){function d(a,b){return"relativeToHTML"==b?a:u+"/"+a}function e(){f(K.scene,T.objects)}function f(a,b){var c,e,l,p,m,r,u;for(u in b)if(void 0===K.objects[u]){var A=b[u],B=null;if(A.type&&A.type in t.hierarchyHandlerMap){if(void 0===A.loading){e={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};l={};for(var D in A)D in e||(l[D]=A[D]);E=K.materials[A.material];A.loading=!0;
e=t.hierarchyHandlerMap[A.type].loaderObject;e.options?e.load(d(A.url,T.urlBaseType),n(u,a,E,A)):e.load(d(A.url,T.urlBaseType),n(u,a,E,A),l)}}else if(void 0!==A.geometry){if(z=K.geometries[A.geometry]){B=!1;E=K.materials[A.material];B=E instanceof THREE.ShaderMaterial;l=A.position;p=A.rotation;m=A.scale;c=A.matrix;r=A.quaternion;A.material||(E=new THREE.MeshFaceMaterial(K.face_materials[A.geometry]));E instanceof THREE.MeshFaceMaterial&&0===E.materials.length&&(E=new THREE.MeshFaceMaterial(K.face_materials[A.geometry]));
if(E instanceof THREE.MeshFaceMaterial)for(e=0;e<E.materials.length;e++)B=B||E.materials[e]instanceof THREE.ShaderMaterial;B&&z.computeTangents();A.skin?B=new THREE.SkinnedMesh(z,E):A.morph?(B=new THREE.MorphAnimMesh(z,E),void 0!==A.duration&&(B.duration=A.duration),void 0!==A.time&&(B.time=A.time),void 0!==A.mirroredLoop&&(B.mirroredLoop=A.mirroredLoop),E.morphNormals&&z.computeMorphNormals()):B=new THREE.Mesh(z,E);B.name=u;c?(B.matrixAutoUpdate=!1,B.matrix.set(c[0],c[1],c[2],c[3],c[4],c[5],c[6],
c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])):(B.position.set(l[0],l[1],l[2]),r?(B.quaternion.set(r[0],r[1],r[2],r[3]),B.useQuaternion=!0):B.rotation.set(p[0],p[1],p[2]),B.scale.set(m[0],m[1],m[2]));B.visible=A.visible;B.castShadow=A.castShadow;B.receiveShadow=A.receiveShadow;a.add(B);K.objects[u]=B}}else"DirectionalLight"===A.type||"PointLight"===A.type||"AmbientLight"===A.type?(I=void 0!==A.color?A.color:16777215,J=void 0!==A.intensity?A.intensity:1,"DirectionalLight"===A.type?(l=A.direction,
F=new THREE.DirectionalLight(I,J),F.position.set(l[0],l[1],l[2]),A.target&&(Y.push({object:F,targetName:A.target}),F.target=null)):"PointLight"===A.type?(l=A.position,e=A.distance,F=new THREE.PointLight(I,J,e),F.position.set(l[0],l[1],l[2])):"AmbientLight"===A.type&&(F=new THREE.AmbientLight(I)),a.add(F),F.name=u,K.lights[u]=F,K.objects[u]=F):"PerspectiveCamera"===A.type||"OrthographicCamera"===A.type?(l=A.position,p=A.rotation,r=A.quaternion,"PerspectiveCamera"===A.type?C=new THREE.PerspectiveCamera(A.fov,
A.aspect,A.near,A.far):"OrthographicCamera"===A.type&&(C=new THREE.OrthographicCamera(A.left,A.right,A.top,A.bottom,A.near,A.far)),C.name=u,C.position.set(l[0],l[1],l[2]),void 0!==r?(C.quaternion.set(r[0],r[1],r[2],r[3]),C.useQuaternion=!0):void 0!==p&&C.rotation.set(p[0],p[1],p[2]),a.add(C),K.cameras[u]=C,K.objects[u]=C):(l=A.position,p=A.rotation,m=A.scale,r=A.quaternion,B=new THREE.Object3D,B.name=u,B.position.set(l[0],l[1],l[2]),r?(B.quaternion.set(r[0],r[1],r[2],r[3]),B.useQuaternion=!0):B.rotation.set(p[0],
p[1],p[2]),B.scale.set(m[0],m[1],m[2]),B.visible=void 0!==A.visible?A.visible:!1,a.add(B),K.objects[u]=B,K.empties[u]=B);if(B){if(void 0!==A.userData)for(var G in A.userData)B.userData[G]=A.userData[G];if(void 0!==A.groups)for(e=0;e<A.groups.length;e++)l=A.groups[e],void 0===K.groups[l]&&(K.groups[l]=[]),K.groups[l].push(u);void 0!==A.children&&f(B,A.children)}}}function l(a,b,c,d,f){var l=f.position,p=f.rotation,m=f.quaternion,n=f.scale;a.position.set(l[0],l[1],l[2]);m?(a.quaternion.set(m[0],m[1],
m[2],m[3]),a.useQuaternion=!0):a.rotation.set(p[0],p[1],p[2]);a.scale.set(n[0],n[1],n[2]);d&&a.traverse(function(a){a.material=d});var r=void 0!==f.visible?f.visible:!0;a.traverse(function(a){a.visible=r});c.add(a);a.name=b;K.objects[b]=a;e()}function m(a){return function(b,c){b.name=a;K.geometries[a]=b;K.face_materials[a]=c;e();D-=1;t.onLoadComplete();r()}}function n(a,b,c,d){return function(e){l(e.content?e.content:e.dae?e.scene:e,a,b,c,d);D-=1;t.onLoadComplete();r()}}function p(a){return function(b,
c){b.name=a;K.geometries[a]=b;K.face_materials[a]=c}}function r(){t.callbackProgress({totalModels:M,totalTextures:G,loadedModels:M-D,loadedTextures:G-P},K);t.onLoadProgress();if(0===D&&0===P){for(var a=0;a<Y.length;a++){var c=Y[a],d=K.objects[c.targetName];d?c.object.target=d:(c.object.target=new THREE.Object3D,K.scene.add(c.object.target));c.object.target.userData.targetInverse=c.object}b(K)}}var t=this,u=THREE.Loader.prototype.extractUrlBase(c),z,E,C,A,B,F,I,J,D,P,M,G,K,Y=[],T=a,O;for(O in this.geometryHandlerMap)a=
this.geometryHandlerMap[O].loaderClass,this.geometryHandlerMap[O].loaderObject=new a;for(O in this.hierarchyHandlerMap)a=this.hierarchyHandlerMap[O].loaderClass,this.hierarchyHandlerMap[O].loaderObject=new a;P=D=0;K={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};T.transform&&(O=T.transform.position,a=T.transform.rotation,c=T.transform.scale,O&&K.scene.position.set(O[0],O[1],O[2]),a&&K.scene.rotation.set(a[0],
a[1],a[2]),c&&K.scene.scale.set(c[0],c[1],c[2]),O||a||c)&&(K.scene.updateMatrix(),K.scene.updateMatrixWorld());O=function(a){return function(){P-=a;r();t.onLoadComplete()}};for(var fa in T.fogs)a=T.fogs[fa],"linear"===a.type?A=new THREE.Fog(0,a.near,a.far):"exp2"===a.type&&(A=new THREE.FogExp2(0,a.density)),a=a.color,A.color.setRGB(a[0],a[1],a[2]),K.fogs[fa]=A;for(var S in T.geometries)A=T.geometries[S],A.type in this.geometryHandlerMap&&(D+=1,t.onLoadStart());for(var X in T.objects)A=T.objects[X],
A.type&&A.type in this.hierarchyHandlerMap&&(D+=1,t.onLoadStart());M=D;for(S in T.geometries)if(A=T.geometries[S],"cube"===A.type)z=new THREE.CubeGeometry(A.width,A.height,A.depth,A.widthSegments,A.heightSegments,A.depthSegments),z.name=S,K.geometries[S]=z;else if("plane"===A.type)z=new THREE.PlaneGeometry(A.width,A.height,A.widthSegments,A.heightSegments),z.name=S,K.geometries[S]=z;else if("sphere"===A.type)z=new THREE.SphereGeometry(A.radius,A.widthSegments,A.heightSegments),z.name=S,K.geometries[S]=
z;else if("cylinder"===A.type)z=new THREE.CylinderGeometry(A.topRad,A.botRad,A.height,A.radSegs,A.heightSegs),z.name=S,K.geometries[S]=z;else if("torus"===A.type)z=new THREE.TorusGeometry(A.radius,A.tube,A.segmentsR,A.segmentsT),z.name=S,K.geometries[S]=z;else if("icosahedron"===A.type)z=new THREE.IcosahedronGeometry(A.radius,A.subdivisions),z.name=S,K.geometries[S]=z;else if(A.type in this.geometryHandlerMap){X={};for(B in A)"type"!==B&&"url"!==B&&(X[B]=A[B]);this.geometryHandlerMap[A.type].loaderObject.load(d(A.url,
T.urlBaseType),m(S),X)}else"embedded"===A.type&&(X=T.embeds[A.id],X.metadata=T.metadata,X&&(X=this.geometryHandlerMap.ascii.loaderObject.parse(X,""),p(S)(X.geometry,X.materials)));for(var Q in T.textures)if(S=T.textures[Q],S.url instanceof Array)for(P+=S.url.length,B=0;B<S.url.length;B++)t.onLoadStart();else P+=1,t.onLoadStart();G=P;for(Q in T.textures){S=T.textures[Q];void 0!==S.mapping&&void 0!==THREE[S.mapping]&&(S.mapping=new THREE[S.mapping]);if(S.url instanceof Array){X=S.url.length;A=[];for(B=
0;B<X;B++)A[B]=d(S.url[B],T.urlBaseType);B=(B=/\.dds$/i.test(A[0]))?THREE.ImageUtils.loadCompressedTextureCube(A,S.mapping,O(X)):THREE.ImageUtils.loadTextureCube(A,S.mapping,O(X))}else B=/\.dds$/i.test(S.url),X=d(S.url,T.urlBaseType),A=O(1),B=B?THREE.ImageUtils.loadCompressedTexture(X,S.mapping,A):THREE.ImageUtils.loadTexture(X,S.mapping,A),void 0!==THREE[S.minFilter]&&(B.minFilter=THREE[S.minFilter]),void 0!==THREE[S.magFilter]&&(B.magFilter=THREE[S.magFilter]),S.anisotropy&&(B.anisotropy=S.anisotropy),
S.repeat&&(B.repeat.set(S.repeat[0],S.repeat[1]),1!==S.repeat[0]&&(B.wrapS=THREE.RepeatWrapping),1!==S.repeat[1]&&(B.wrapT=THREE.RepeatWrapping)),S.offset&&B.offset.set(S.offset[0],S.offset[1]),S.wrap&&(X={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==X[S.wrap[0]]&&(B.wrapS=X[S.wrap[0]]),void 0!==X[S.wrap[1]]&&(B.wrapT=X[S.wrap[1]]));K.textures[Q]=B}var Z,V;for(Z in T.materials){Q=T.materials[Z];for(V in Q.parameters)"envMap"===V||"map"===V||"lightMap"===V||"bumpMap"===
V?Q.parameters[V]=K.textures[Q.parameters[V]]:"shading"===V?Q.parameters[V]="flat"===Q.parameters[V]?THREE.FlatShading:THREE.SmoothShading:"side"===V?Q.parameters[V]="double"==Q.parameters[V]?THREE.DoubleSide:"back"==Q.parameters[V]?THREE.BackSide:THREE.FrontSide:"blending"===V?Q.parameters[V]=Q.parameters[V]in THREE?THREE[Q.parameters[V]]:THREE.NormalBlending:"combine"===V?Q.parameters[V]=Q.parameters[V]in THREE?THREE[Q.parameters[V]]:THREE.MultiplyOperation:"vertexColors"===V?"face"==Q.parameters[V]?
Q.parameters[V]=THREE.FaceColors:Q.parameters[V]&&(Q.parameters[V]=THREE.VertexColors):"wrapRGB"===V&&(O=Q.parameters[V],Q.parameters[V]=new THREE.Vector3(O[0],O[1],O[2]));void 0!==Q.parameters.opacity&&1>Q.parameters.opacity&&(Q.parameters.transparent=!0);Q.parameters.normalMap?(O=THREE.ShaderLib.normalmap,S=THREE.UniformsUtils.clone(O.uniforms),B=Q.parameters.color,X=Q.parameters.specular,A=Q.parameters.ambient,fa=Q.parameters.shininess,S.tNormal.value=K.textures[Q.parameters.normalMap],Q.parameters.normalScale&&
S.uNormalScale.value.set(Q.parameters.normalScale[0],Q.parameters.normalScale[1]),Q.parameters.map&&(S.tDiffuse.value=Q.parameters.map,S.enableDiffuse.value=!0),Q.parameters.envMap&&(S.tCube.value=Q.parameters.envMap,S.enableReflection.value=!0,S.uReflectivity.value=Q.parameters.reflectivity),Q.parameters.lightMap&&(S.tAO.value=Q.parameters.lightMap,S.enableAO.value=!0),Q.parameters.specularMap&&(S.tSpecular.value=K.textures[Q.parameters.specularMap],S.enableSpecular.value=!0),Q.parameters.displacementMap&&
(S.tDisplacement.value=K.textures[Q.parameters.displacementMap],S.enableDisplacement.value=!0,S.uDisplacementBias.value=Q.parameters.displacementBias,S.uDisplacementScale.value=Q.parameters.displacementScale),S.uDiffuseColor.value.setHex(B),S.uSpecularColor.value.setHex(X),S.uAmbientColor.value.setHex(A),S.uShininess.value=fa,Q.parameters.opacity&&(S.uOpacity.value=Q.parameters.opacity),E=new THREE.ShaderMaterial({fragmentShader:O.fragmentShader,vertexShader:O.vertexShader,uniforms:S,lights:!0,fog:!0})):
E=new THREE[Q.type](Q.parameters);E.name=Z;K.materials[Z]=E}for(Z in T.materials)if(Q=T.materials[Z],Q.parameters.materials){V=[];for(B=0;B<Q.parameters.materials.length;B++)V.push(K.materials[Q.parameters.materials[B]]);K.materials[Z].materials=V}e();K.cameras&&T.defaults.camera&&(K.currentCamera=K.cameras[T.defaults.camera]);K.fogs&&T.defaults.fog&&(K.scene.fog=K.fogs[T.defaults.fog]);t.callbackSync(K);r()};THREE.TextureLoader=function(){this.crossOrigin=null};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(a){var b=this,c=new Image;c.addEventListener("load",function(){var a=new THREE.Texture(c);a.needsUpdate=!0;b.dispatchEvent({type:"load",content:a})},!1);c.addEventListener("error",
function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);b.crossOrigin&&(c.crossOrigin=b.crossOrigin);c.src=a}};
THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.overdraw=!1;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof
THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]=c}}},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=
this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;
this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.perPixel=this.perPixel;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleBasicMaterial.prototype.clone=function(){var a=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.size=this.size;a.sizeAttenuation=this.sizeAttenuation;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.ParticleCanvasMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(a,c){};this.setValues(a)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleCanvasMaterial.prototype.clone=function(){var a=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.program=this.program;return a};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(a);a=a||{};void 0===a.depthTest&&(this.depthTest=!this.useScreenCoordinates);
void 0===a.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===a.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.SpriteMaterial.prototype.clone=function(){var a=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.useScreenCoordinates=this.useScreenCoordinates;a.sizeAttenuation=this.sizeAttenuation;a.scaleByViewport=this.scaleByViewport;a.alignment.copy(this.alignment);a.uvOffset.copy(this.uvOffset);a.uvScale.copy(this.uvScale);a.fog=this.fog;return a};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);
THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);
THREE.Texture=function(a,b,c,d,e,f,l,m,n){this.id=THREE.TextureIdCount++;this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==n?n:1;this.format=void 0!==l?l:THREE.RGBAFormat;this.type=void 0!==m?m:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,
0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;
a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.TextureIdCount=0;
THREE.CompressedTexture=function(a,b,c,d,e,f,l,m,n,p,r){THREE.Texture.call(this,null,f,l,m,n,p,d,e,r);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};
THREE.DataTexture=function(a,b,c,d,e,f,l,m,n,p,r){THREE.Texture.call(this,null,f,l,m,n,p,d,e,r);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Particle=function(a){THREE.Object3D.call(this);this.material=a};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);
THREE.Particle.prototype.clone=function(a){void 0===a&&(a=new THREE.Particle(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.ParticleSystem=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.sortParticles=!1;this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere();this.frustumCulled=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);
THREE.ParticleSystem.prototype.clone=function(a){void 0===a&&(a=new THREE.ParticleSystem(this.geometry,this.material));a.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};
THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.material=this.geometry=null;this.setGeometry(a);this.setMaterial(b)};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.setGeometry=function(a){void 0!==a&&(this.geometry=a,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())};THREE.Mesh.prototype.setMaterial=function(a){this.material=void 0!==a?a:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})};
THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};
THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.skinMatrix,b)};
THREE.SkinnedMesh=function(a,b,c){THREE.Mesh.call(this,a,b);this.useVertexTexture=void 0!==c?c:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var d,e,f;if(this.geometry&&void 0!==this.geometry.bones){for(a=0;a<this.geometry.bones.length;a++)c=this.geometry.bones[a],d=c.pos,e=c.rotq,f=c.scl,b=this.addBone(),b.name=c.name,b.position.set(d[0],d[1],d[2]),b.quaternion.set(e[0],e[1],e[2],e[3]),b.useQuaternion=!0,void 0!==f?b.scale.set(f[0],f[1],f[2]):b.scale.set(1,1,1);for(a=
0;a<this.bones.length;a++)c=this.geometry.bones[a],b=this.bones[a],-1===c.parent?this.add(b):this.bones[c.parent].add(b);a=this.bones.length;this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=a=256<a?64:64<a?32:16<a?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,
this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*a);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(a){void 0===a&&(a=new THREE.Bone(this));this.bones.push(a);return a};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;a=0;for(var b=this.children.length;a<b;a++){var c=this.children[a];c instanceof THREE.Bone?c.update(this.identityMatrix,!1):c.updateMatrixWorld(!0)}if(void 0==this.boneInverses)for(this.boneInverses=[],a=0,b=this.bones.length;a<
b;a++)c=new THREE.Matrix4,c.getInverse(this.bones[a].skinMatrix),this.boneInverses.push(c);a=0;for(b=this.bones.length;a<b;a++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[a].skinMatrix,this.boneInverses[a]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*a);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)};
THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var a=0;a<this.geometry.skinIndices.length;a++){var b=this.geometry.skinWeights[a],c=1/b.lengthManhattan();Infinity!==c?b.multiplyScalar(c):b.set(1)}};THREE.SkinnedMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,a);return a};THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4;
THREE.MorphAnimMesh=function(a,b){THREE.Mesh.call(this,a,b);this.duration=1E3;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(a,b){this.startKeyframe=a;this.endKeyframe=b;this.length=this.endKeyframe-this.startKeyframe+1};
THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};
THREE.MorphAnimMesh.prototype.parseAnimations=function(){var a=this.geometry;a.animations||(a.animations={});for(var b,c=a.animations,d=/([a-z]+)(\d+)/,e=0,f=a.morphTargets.length;e<f;e++){var l=a.morphTargets[e].name.match(d);if(l&&1<l.length){l=l[1];c[l]||(c[l]={start:Infinity,end:-Infinity});var m=c[l];e<m.start&&(m.start=e);e>m.end&&(m.end=e);b||(b=l)}}a.firstAnimation=b};
THREE.MorphAnimMesh.prototype.setAnimationLabel=function(a,b,c){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[a]={start:b,end:c}};THREE.MorphAnimMesh.prototype.playAnimation=function(a,b){var c=this.geometry.animations[a];c?(this.setFrameRange(c.start,c.end),this.duration=1E3*((c.end-c.start)/b),this.time=0):console.warn("animation["+a+"] undefined")};
THREE.MorphAnimMesh.prototype.updateAnimation=function(a){var b=this.duration/this.length;this.time+=this.direction*a;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);a=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/b),0,this.length-1);a!==this.currentKeyframe&&
(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[a]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=a);b=this.time%b/b;this.directionBackwards&&(b=1-b);this.morphTargetInfluences[this.currentKeyframe]=b;this.morphTargetInfluences[this.lastKeyframe]=1-b};
THREE.MorphAnimMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.MorphAnimMesh(this.geometry,this.material));a.duration=this.duration;a.mirroredLoop=this.mirroredLoop;a.time=this.time;a.lastKeyframe=this.lastKeyframe;a.currentKeyframe=this.currentKeyframe;a.direction=this.direction;a.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,a);return a};THREE.Ribbon=function(a,b){THREE.Object3D.call(this);this.geometry=a;this.material=b};THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype);
THREE.Ribbon.prototype.clone=function(a){void 0===a&&(a=new THREE.Ribbon(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};
THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.getPositionFromMatrix(c.matrixWorld);b.getPositionFromMatrix(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var d=1,e=this.objects.length;d<e;d++)if(c>=this.objects[d].distance)this.objects[d-1].object.visible=!1,this.objects[d].object.visible=!0;else break;for(;d<e;d++)this.objects[d].object.visible=!1}}}();THREE.LOD.prototype.clone=function(){};
THREE.Sprite=function(a){THREE.Object3D.call(this);this.material=void 0!==a?a:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation);this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder);this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};
THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)&&-1===this.__objects.indexOf(a)){this.__objects.push(a);this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1)}else a instanceof THREE.Camera||(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};
THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};
THREE.CanvasRenderer=function(a){function b(a){M!==a&&(M=J.globalAlpha=a)}function c(a){G!==a&&(a===THREE.NormalBlending?J.globalCompositeOperation="source-over":a===THREE.AdditiveBlending?J.globalCompositeOperation="lighter":a===THREE.SubtractiveBlending&&(J.globalCompositeOperation="darker"),G=a)}function d(a){T!==a&&(T=J.lineWidth=a)}function e(a){O!==a&&(O=J.lineCap=a)}function f(a){fa!==a&&(fa=J.lineJoin=a)}function l(a){K!==a&&(K=J.strokeStyle=a)}function m(a){Y!==a&&(Y=J.fillStyle=a)}function n(a,
b){if(S!==a||X!==b)J.setLineDash([a,b]),S=a,X=b}console.log("THREE.CanvasRenderer",THREE.REVISION);var p=THREE.Math.smoothstep;a=a||{};var r=this,t,u,z,E=new THREE.Projector,C=void 0!==a.canvas?a.canvas:document.createElement("canvas"),A,B,F,I,J=C.getContext("2d"),D=new THREE.Color(0),P=0,M=1,G=0,K=null,Y=null,T=null,O=null,fa=null,S=null,X=0,Q,Z,V,da,W=new THREE.RenderableVertex,ua=new THREE.RenderableVertex,aa,ja,N,ma,U,ga,va,ia,Pa,jb,Ka,bb,ta=new THREE.Color,ya=new THREE.Color,na=new THREE.Color,
ha=new THREE.Color,ra=new THREE.Color,za=new THREE.Color,wa=new THREE.Color,Aa=new THREE.Color,q={},db={},sa,cb,Ma,wb,tb,Pb,Qb,Rb,hc,Yb,eb=new THREE.Box2,Ba=new THREE.Box2,Sa=new THREE.Box2,Ab=new THREE.Color,$a=new THREE.Color,Fa=new THREE.Color,Ja=new THREE.Vector3,Cb,s,Fb,sb,lb,kb,gb=16;Cb=document.createElement("canvas");Cb.width=Cb.height=2;s=Cb.getContext("2d");s.fillStyle="rgba(0,0,0,1)";s.fillRect(0,0,2,2);Fb=s.getImageData(0,0,2,2);sb=Fb.data;lb=document.createElement("canvas");lb.width=
lb.height=gb;kb=lb.getContext("2d");kb.translate(-gb/2,-gb/2);kb.scale(gb,gb);gb--;void 0===J.setLineDash&&(J.setLineDash=void 0!==J.mozDash?function(a){J.mozDash=null!==a[0]?a:null}:function(){});this.domElement=C;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};
this.setSize=function(a,b,c){A=a*this.devicePixelRatio;B=b*this.devicePixelRatio;F=Math.floor(A/2);I=Math.floor(B/2);C.width=A;C.height=B;1!==this.devicePixelRatio&&!1!==c&&(C.style.width=a+"px",C.style.height=b+"px");eb.set(new THREE.Vector2(-F,-I),new THREE.Vector2(F,I));Ba.set(new THREE.Vector2(-F,-I),new THREE.Vector2(F,I));M=1;G=0;fa=O=T=Y=K=null};this.setClearColor=function(a,b){D.set(a);P=void 0!==b?b:1;Ba.set(new THREE.Vector2(-F,-I),new THREE.Vector2(F,I))};this.setClearColorHex=function(a,
b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){J.setTransform(1,0,0,-1,F,I);!1===Ba.empty()&&(Ba.intersect(eb),Ba.expandByScalar(2),1>P&&J.clearRect(Ba.min.x|0,Ba.min.y|0,Ba.max.x-Ba.min.x|0,Ba.max.y-Ba.min.y|0),0<P&&(c(THREE.NormalBlending),b(1),m("rgba("+Math.floor(255*D.r)+","+Math.floor(255*D.g)+","+Math.floor(255*D.b)+","+P+")"),J.fillRect(Ba.min.x|0,Ba.min.y|
0,Ba.max.x-Ba.min.x|0,Ba.max.y-Ba.min.y|0)),Ba.makeEmpty())};this.render=function(a,C){function A(){Ab.setRGB(0,0,0);$a.setRGB(0,0,0);Fa.setRGB(0,0,0);for(var a=0,b=z.length;a<b;a++){var c=z[a],d=c.color;c instanceof THREE.AmbientLight?Ab.add(d):c instanceof THREE.DirectionalLight?$a.add(d):c instanceof THREE.PointLight&&Fa.add(d)}}function B(a,b,c){for(var d=0,e=z.length;d<e;d++){var f=z[d];Aa.copy(f.color);if(f instanceof THREE.DirectionalLight){var l=Ja.getPositionFromMatrix(f.matrixWorld).normalize(),
p=b.dot(l);0>=p||(p*=f.intensity,c.add(Aa.multiplyScalar(p)))}else f instanceof THREE.PointLight&&(l=Ja.getPositionFromMatrix(f.matrixWorld),p=b.dot(Ja.subVectors(l,a).normalize()),0>=p||(p*=0==f.distance?1:1-Math.min(a.distanceTo(l)/f.distance,1),0!=p&&(p*=f.intensity,c.add(Aa.multiplyScalar(p)))))}}function D(a,d,e){b(e.opacity);c(e.blending);var f,p,n,r,t,s;e instanceof THREE.ParticleBasicMaterial?null===e.map?(n=d.object.scale.x,r=d.object.scale.y,n*=d.scale.x*F,r*=d.scale.y*I,Sa.min.set(a.x-
n,a.y-r),Sa.max.set(a.x+n,a.y+r),!1===eb.isIntersectionBox(Sa)?Sa.makeEmpty():(m(e.color.getStyle()),J.save(),J.translate(a.x,a.y),J.rotate(-d.rotation),J.scale(n,r),J.fillRect(-1,-1,2,2),J.restore())):(e=e.map.image,t=e.width>>1,s=e.height>>1,n=d.scale.x*F,r=d.scale.y*I,f=n*t,p=r*s,Sa.min.set(a.x-f,a.y-p),Sa.max.set(a.x+f,a.y+p),!1===eb.isIntersectionBox(Sa)?Sa.makeEmpty():(J.save(),J.translate(a.x,a.y),J.rotate(-d.rotation),J.scale(n,-r),J.translate(-t,-s),J.drawImage(e,0,0),J.restore())):e instanceof
THREE.ParticleCanvasMaterial&&(f=d.scale.x*F,p=d.scale.y*I,Sa.min.set(a.x-f,a.y-p),Sa.max.set(a.x+f,a.y+p),!1===eb.isIntersectionBox(Sa)?Sa.makeEmpty():(l(e.color.getStyle()),m(e.color.getStyle()),J.save(),J.translate(a.x,a.y),J.rotate(-d.rotation),J.scale(f,p),e.program(J),J.restore()))}function G(a,p,m,r){b(r.opacity);c(r.blending);J.beginPath();J.moveTo(a.positionScreen.x,a.positionScreen.y);J.lineTo(p.positionScreen.x,p.positionScreen.y);if(r instanceof THREE.LineBasicMaterial){d(r.linewidth);
e(r.linecap);f(r.linejoin);if(r.vertexColors!==THREE.VertexColors)l(r.color.getStyle());else{var t=m.vertexColors[0].getStyle();m=m.vertexColors[1].getStyle();if(t===m)l(t);else{try{var s=J.createLinearGradient(a.positionScreen.x,a.positionScreen.y,p.positionScreen.x,p.positionScreen.y);s.addColorStop(0,t);s.addColorStop(1,m)}catch(q){s=t}l(s)}}J.stroke();Sa.expandByScalar(2*r.linewidth)}else r instanceof THREE.LineDashedMaterial&&(d(r.linewidth),e(r.linecap),f(r.linejoin),l(r.color.getStyle()),n(r.dashSize,
r.gapSize),J.stroke(),Sa.expandByScalar(2*r.linewidth),n(null,null))}function P(a,d,e,f,l,m,n,t){r.info.render.vertices+=3;r.info.render.faces++;b(t.opacity);c(t.blending);aa=a.positionScreen.x;ja=a.positionScreen.y;N=d.positionScreen.x;ma=d.positionScreen.y;U=e.positionScreen.x;ga=e.positionScreen.y;M(aa,ja,N,ma,U,ga);(t instanceof THREE.MeshLambertMaterial||t instanceof THREE.MeshPhongMaterial)&&null===t.map?(za.copy(t.color),wa.copy(t.emissive),t.vertexColors===THREE.FaceColors&&za.multiply(n.color),
!1===t.wireframe&&t.shading==THREE.SmoothShading&&3==n.vertexNormalsLength?(ya.copy(Ab),na.copy(Ab),ha.copy(Ab),B(n.v1.positionWorld,n.vertexNormalsModel[0],ya),B(n.v2.positionWorld,n.vertexNormalsModel[1],na),B(n.v3.positionWorld,n.vertexNormalsModel[2],ha),ya.multiply(za).add(wa),na.multiply(za).add(wa),ha.multiply(za).add(wa),ra.addColors(na,ha).multiplyScalar(0.5),Ma=Za(ya,na,ha,ra),mb(aa,ja,N,ma,U,ga,0,0,1,0,0,1,Ma)):(ta.copy(Ab),B(n.centroidModel,n.normalModel,ta),ta.multiply(za).add(wa),!0===
t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta))):t instanceof THREE.MeshBasicMaterial||t instanceof THREE.MeshLambertMaterial||t instanceof THREE.MeshPhongMaterial?null!==t.map?t.map.mapping instanceof THREE.UVMapping&&(wb=n.uvs[0],Ea(aa,ja,N,ma,U,ga,wb[f].x,wb[f].y,wb[l].x,wb[l].y,wb[m].x,wb[m].y,t.map)):null!==t.envMap?t.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(Ja.copy(n.vertexNormalsModelView[f]),tb=0.5*Ja.x+0.5,Pb=0.5*Ja.y+0.5,Ja.copy(n.vertexNormalsModelView[l]),
Qb=0.5*Ja.x+0.5,Rb=0.5*Ja.y+0.5,Ja.copy(n.vertexNormalsModelView[m]),hc=0.5*Ja.x+0.5,Yb=0.5*Ja.y+0.5,Ea(aa,ja,N,ma,U,ga,tb,Pb,Qb,Rb,hc,Yb,t.envMap)):(ta.copy(t.color),t.vertexColors===THREE.FaceColors&&ta.multiply(n.color),!0===t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta)):t instanceof THREE.MeshDepthMaterial?(sa=C.near,cb=C.far,ya.r=ya.g=ya.b=1-p(a.positionScreen.z*a.positionScreen.w,sa,cb),na.r=na.g=na.b=1-p(d.positionScreen.z*d.positionScreen.w,sa,cb),ha.r=
ha.g=ha.b=1-p(e.positionScreen.z*e.positionScreen.w,sa,cb),ra.addColors(na,ha).multiplyScalar(0.5),Ma=Za(ya,na,ha,ra),mb(aa,ja,N,ma,U,ga,0,0,1,0,0,1,Ma)):t instanceof THREE.MeshNormalMaterial&&(t.shading==THREE.FlatShading?(a=n.normalModelView,ta.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),!0===t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta)):t.shading==THREE.SmoothShading&&(a=n.vertexNormalsModelView[f],ya.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),
a=n.vertexNormalsModelView[l],na.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=n.vertexNormalsModelView[m],ha.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),ra.addColors(na,ha).multiplyScalar(0.5),Ma=Za(ya,na,ha,ra),mb(aa,ja,N,ma,U,ga,0,0,1,0,0,1,Ma)))}function K(a,d,e,f,l,m,n,t){r.info.render.vertices+=4;r.info.render.faces++;b(t.opacity);c(t.blending);void 0!==t.map&&null!==t.map||void 0!==t.envMap&&null!==t.envMap?(P(a,d,f,0,1,3,n,t),P(l,e,m,1,2,3,n,t)):(aa=a.positionScreen.x,
ja=a.positionScreen.y,N=d.positionScreen.x,ma=d.positionScreen.y,U=e.positionScreen.x,ga=e.positionScreen.y,va=f.positionScreen.x,ia=f.positionScreen.y,Pa=l.positionScreen.x,jb=l.positionScreen.y,Ka=m.positionScreen.x,bb=m.positionScreen.y,t instanceof THREE.MeshLambertMaterial||t instanceof THREE.MeshPhongMaterial?(za.copy(t.color),wa.copy(t.emissive),t.vertexColors===THREE.FaceColors&&za.multiply(n.color),!1===t.wireframe&&t.shading==THREE.SmoothShading&&4==n.vertexNormalsLength?(ya.copy(Ab),na.copy(Ab),
ha.copy(Ab),ra.copy(Ab),B(n.v1.positionWorld,n.vertexNormalsModel[0],ya),B(n.v2.positionWorld,n.vertexNormalsModel[1],na),B(n.v4.positionWorld,n.vertexNormalsModel[3],ha),B(n.v3.positionWorld,n.vertexNormalsModel[2],ra),ya.multiply(za).add(wa),na.multiply(za).add(wa),ha.multiply(za).add(wa),ra.multiply(za).add(wa),Ma=Za(ya,na,ha,ra),M(aa,ja,N,ma,va,ia),mb(aa,ja,N,ma,va,ia,0,0,1,0,0,1,Ma),M(Pa,jb,U,ga,Ka,bb),mb(Pa,jb,U,ga,Ka,bb,1,0,1,1,0,1,Ma)):(ta.copy(Ab),B(n.centroidModel,n.normalModel,ta),ta.multiply(za).add(wa),
T(aa,ja,N,ma,U,ga,va,ia),!0===t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta))):t instanceof THREE.MeshBasicMaterial?(ta.copy(t.color),t.vertexColors===THREE.FaceColors&&ta.multiply(n.color),T(aa,ja,N,ma,U,ga,va,ia),!0===t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta)):t instanceof THREE.MeshNormalMaterial?t.shading==THREE.FlatShading?(a=n.normalModelView,ta.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),T(aa,ja,N,ma,
U,ga,va,ia),!0===t.wireframe?X(ta,t.wireframeLinewidth,t.wireframeLinecap,t.wireframeLinejoin):S(ta)):t.shading==THREE.SmoothShading&&(a=n.vertexNormalsModelView[0],ya.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=n.vertexNormalsModelView[1],na.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=n.vertexNormalsModelView[3],ha.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=n.vertexNormalsModelView[2],ra.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),Ma=Za(ya,na,ha,
ra),M(aa,ja,N,ma,va,ia),mb(aa,ja,N,ma,va,ia,0,0,1,0,0,1,Ma),M(Pa,jb,U,ga,Ka,bb),mb(Pa,jb,U,ga,Ka,bb,1,0,1,1,0,1,Ma)):t instanceof THREE.MeshDepthMaterial&&(sa=C.near,cb=C.far,ya.r=ya.g=ya.b=1-p(a.positionScreen.z*a.positionScreen.w,sa,cb),na.r=na.g=na.b=1-p(d.positionScreen.z*d.positionScreen.w,sa,cb),ha.r=ha.g=ha.b=1-p(f.positionScreen.z*f.positionScreen.w,sa,cb),ra.r=ra.g=ra.b=1-p(e.positionScreen.z*e.positionScreen.w,sa,cb),Ma=Za(ya,na,ha,ra),M(aa,ja,N,ma,va,ia),mb(aa,ja,N,ma,va,ia,0,0,1,0,0,1,
Ma),M(Pa,jb,U,ga,Ka,bb),mb(Pa,jb,U,ga,Ka,bb,1,0,1,1,0,1,Ma)))}function M(a,b,c,d,e,f){J.beginPath();J.moveTo(a,b);J.lineTo(c,d);J.lineTo(e,f);J.closePath()}function T(a,b,c,d,e,f,l,p){J.beginPath();J.moveTo(a,b);J.lineTo(c,d);J.lineTo(e,f);J.lineTo(l,p);J.closePath()}function X(a,b,c,p){d(b);e(c);f(p);l(a.getStyle());J.stroke();Sa.expandByScalar(2*b)}function S(a){m(a.getStyle());J.fill()}function Ea(a,b,c,d,e,f,l,p,n,t,r,s,u){if(!(u instanceof THREE.DataTexture||void 0===u.image||0==u.image.width)){if(!0===
u.needsUpdate){var Ea=u.wrapS==THREE.RepeatWrapping,z=u.wrapT==THREE.RepeatWrapping;q[u.id]=J.createPattern(u.image,!0===Ea&&!0===z?"repeat":!0===Ea&&!1===z?"repeat-x":!1===Ea&&!0===z?"repeat-y":"no-repeat");u.needsUpdate=!1}void 0===q[u.id]?m("rgba(0,0,0,1)"):m(q[u.id]);var Ea=u.offset.x/u.repeat.x,z=u.offset.y/u.repeat.y,C=u.image.width*u.repeat.x,A=u.image.height*u.repeat.y;l=(l+Ea)*C;p=(1-p+z)*A;c-=a;d-=b;e-=a;f-=b;n=(n+Ea)*C-l;t=(1-t+z)*A-p;r=(r+Ea)*C-l;s=(1-s+z)*A-p;Ea=n*s-r*t;0===Ea?(void 0===
db[u.id]&&(b=document.createElement("canvas"),b.width=u.image.width,b.height=u.image.height,b=b.getContext("2d"),b.drawImage(u.image,0,0),db[u.id]=b.getImageData(0,0,u.image.width,u.image.height).data),b=db[u.id],l=4*(Math.floor(l)+Math.floor(p)*u.image.width),ta.setRGB(b[l]/255,b[l+1]/255,b[l+2]/255),S(ta)):(Ea=1/Ea,u=(s*c-t*e)*Ea,t=(s*d-t*f)*Ea,c=(n*e-r*c)*Ea,d=(n*f-r*d)*Ea,a=a-u*l-c*p,l=b-t*l-d*p,J.save(),J.transform(u,t,c,d,a,l),J.fill(),J.restore())}}function mb(a,b,c,d,e,f,l,p,m,n,t,r,s){var q,
u;q=s.width-1;u=s.height-1;l*=q;p*=u;c-=a;d-=b;e-=a;f-=b;m=m*q-l;n=n*u-p;t=t*q-l;r=r*u-p;u=1/(m*r-t*n);q=(r*c-n*e)*u;n=(r*d-n*f)*u;c=(m*e-t*c)*u;d=(m*f-t*d)*u;a=a-q*l-c*p;b=b-n*l-d*p;J.save();J.transform(q,n,c,d,a,b);J.clip();J.drawImage(s,0,0);J.restore()}function Za(a,b,c,d){sb[0]=255*a.r|0;sb[1]=255*a.g|0;sb[2]=255*a.b|0;sb[4]=255*b.r|0;sb[5]=255*b.g|0;sb[6]=255*b.b|0;sb[8]=255*c.r|0;sb[9]=255*c.g|0;sb[10]=255*c.b|0;sb[12]=255*d.r|0;sb[13]=255*d.g|0;sb[14]=255*d.b|0;s.putImageData(Fb,0,0);kb.drawImage(Cb,
0,0);return lb}function Ga(a,b){var c=b.x-a.x,d=b.y-a.y,e=c*c+d*d;0!==e&&(e=1/Math.sqrt(e),c*=e,d*=e,b.x+=c,b.y+=d,a.x-=c,a.y-=d)}if(!1===C instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();J.setTransform(1,0,0,-1,F,I);r.info.render.vertices=0;r.info.render.faces=0;t=E.projectScene(a,C,this.sortObjects,this.sortElements);u=t.elements;z=t.lights;A();for(var vc=0,yb=u.length;vc<yb;vc++){var Ca=u[vc],
Jb=Ca.material;if(void 0!==Jb&&!1!==Jb.visible){Sa.makeEmpty();if(Ca instanceof THREE.RenderableParticle)Q=Ca,Q.x*=F,Q.y*=I,D(Q,Ca,Jb);else if(Ca instanceof THREE.RenderableLine)Q=Ca.v1,Z=Ca.v2,Q.positionScreen.x*=F,Q.positionScreen.y*=I,Z.positionScreen.x*=F,Z.positionScreen.y*=I,Sa.setFromPoints([Q.positionScreen,Z.positionScreen]),!0===eb.isIntersectionBox(Sa)&&G(Q,Z,Ca,Jb);else if(Ca instanceof THREE.RenderableFace3){Q=Ca.v1;Z=Ca.v2;V=Ca.v3;if(-1>Q.positionScreen.z||1<Q.positionScreen.z)continue;
if(-1>Z.positionScreen.z||1<Z.positionScreen.z)continue;if(-1>V.positionScreen.z||1<V.positionScreen.z)continue;Q.positionScreen.x*=F;Q.positionScreen.y*=I;Z.positionScreen.x*=F;Z.positionScreen.y*=I;V.positionScreen.x*=F;V.positionScreen.y*=I;!0===Jb.overdraw&&(Ga(Q.positionScreen,Z.positionScreen),Ga(Z.positionScreen,V.positionScreen),Ga(V.positionScreen,Q.positionScreen));Sa.setFromPoints([Q.positionScreen,Z.positionScreen,V.positionScreen]);!0===eb.isIntersectionBox(Sa)&&P(Q,Z,V,0,1,2,Ca,Jb)}else if(Ca instanceof
THREE.RenderableFace4){Q=Ca.v1;Z=Ca.v2;V=Ca.v3;da=Ca.v4;if(-1>Q.positionScreen.z||1<Q.positionScreen.z)continue;if(-1>Z.positionScreen.z||1<Z.positionScreen.z)continue;if(-1>V.positionScreen.z||1<V.positionScreen.z)continue;if(-1>da.positionScreen.z||1<da.positionScreen.z)continue;Q.positionScreen.x*=F;Q.positionScreen.y*=I;Z.positionScreen.x*=F;Z.positionScreen.y*=I;V.positionScreen.x*=F;V.positionScreen.y*=I;da.positionScreen.x*=F;da.positionScreen.y*=I;W.positionScreen.copy(Z.positionScreen);ua.positionScreen.copy(da.positionScreen);
!0===Jb.overdraw&&(Ga(Q.positionScreen,Z.positionScreen),Ga(Z.positionScreen,da.positionScreen),Ga(da.positionScreen,Q.positionScreen),Ga(V.positionScreen,W.positionScreen),Ga(V.positionScreen,ua.positionScreen));Sa.setFromPoints([Q.positionScreen,Z.positionScreen,V.positionScreen,da.positionScreen]);!0===eb.isIntersectionBox(Sa)&&K(Q,Z,V,da,W,ua,Ca,Jb)}Ba.union(Sa)}}J.setTransform(1,0,0,1,0,0)}}};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",
lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",
lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};
THREE.UniformsUtils={merge:function(a){var b,c,d,e={};for(b=0;b<a.length;b++)for(c in d=this.clone(a[b]),d)e[c]=d[c];return e},clone:function(a){var b,c,d,e={};for(b in a)for(c in e[b]={},a[b])d=a[b][c],e[b][c]=d instanceof THREE.Color||d instanceof THREE.Vector2||d instanceof THREE.Vector3||d instanceof THREE.Vector4||d instanceof THREE.Matrix4||d instanceof THREE.Texture?d.clone():d instanceof Array?d.slice():d;return e}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",
value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",
value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",
value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,
THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,
THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,
THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,
THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,
THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",
value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,
"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,
THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,
THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",
value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",
value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",
value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},
depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderer=function(a){function b(a){if(a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)s.deleteBuffer(a.__webglCustomAttributesList[b].buffer)}function c(a,b){var c=a.vertices.length,d=b.material;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var e in d.attributes){var f=d.attributes[e];if(!f.__webglInitialized||f.createUniqueBuffers){f.__webglInitialized=!0;var l=1;"v2"===f.type?l=2:"v3"===f.type?l=3:"v4"===f.type?
l=4:"c"===f.type&&(l=3);f.size=l;f.array=new Float32Array(c*l);f.buffer=s.createBuffer();f.buffer.belongsToAttribute=e;f.needsUpdate=!0}a.__webglCustomAttributesList.push(f)}}}function d(a,b){var c=b.geometry,d=a.faces3,p=a.faces4,m=3*d.length+4*p.length,n=1*d.length+2*p.length,p=3*d.length+4*p.length,d=e(b,a),t=l(d),r=f(d),q=d.vertexColors?d.vertexColors:!1;a.__vertexArray=new Float32Array(3*m);r&&(a.__normalArray=new Float32Array(3*m));c.hasTangents&&(a.__tangentArray=new Float32Array(4*m));q&&
(a.__colorArray=new Float32Array(3*m));if(t){if(0<c.faceUvs.length||0<c.faceVertexUvs.length)a.__uvArray=new Float32Array(2*m);if(1<c.faceUvs.length||1<c.faceVertexUvs.length)a.__uv2Array=new Float32Array(2*m)}b.geometry.skinWeights.length&&b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*m),a.__skinWeightArray=new Float32Array(4*m));a.__faceArray=new Uint16Array(3*n);a.__lineArray=new Uint16Array(2*p);if(a.numMorphTargets)for(a.__morphTargetsArrays=[],c=0,t=a.numMorphTargets;c<
t;c++)a.__morphTargetsArrays.push(new Float32Array(3*m));if(a.numMorphNormals)for(a.__morphNormalsArrays=[],c=0,t=a.numMorphNormals;c<t;c++)a.__morphNormalsArrays.push(new Float32Array(3*m));a.__webglFaceCount=3*n;a.__webglLineCount=2*p;if(d.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var u in d.attributes){var n=d.attributes[u],c={},z;for(z in n)c[z]=n[z];if(!c.__webglInitialized||c.createUniqueBuffers)c.__webglInitialized=!0,p=1,"v2"===c.type?p=2:"v3"===
c.type?p=3:"v4"===c.type?p=4:"c"===c.type&&(p=3),c.size=p,c.array=new Float32Array(m*p),c.buffer=s.createBuffer(),c.buffer.belongsToAttribute=u,n.needsUpdate=!0,c.__original=n;a.__webglCustomAttributesList.push(c)}}a.__inittedArrays=!0}function e(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function f(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===THREE.SmoothShading?
THREE.SmoothShading:THREE.FlatShading}function l(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a instanceof THREE.ShaderMaterial?!0:!1}function m(a){eb[a]||(s.enableVertexAttribArray(a),eb[a]=!0)}function n(){for(var a in eb)eb[a]&&(s.disableVertexAttribArray(a),eb[a]=!1)}function p(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function r(a,b){return b[0]-a[0]}function t(a,b,c){if(a.length)for(var d=0,e=a.length;d<e;d++)bb=ia=null,jb=Ka=ha=na=db=q=ra=-1,Ja=!0,a[d].render(b,c,hc,Yb),
bb=ia=null,jb=Ka=ha=na=db=q=ra=-1,Ja=!0}function u(a,b,c,d,e,f,l,p){var m,n,t,r;b?(n=a.length-1,r=b=-1):(n=0,b=a.length,r=1);for(var s=n;s!==b;s+=r)if(m=a[s],m.render){n=m.object;t=m.buffer;if(p)m=p;else{m=m[c];if(!m)continue;l&&U.setBlending(m.blending,m.blendEquation,m.blendSrc,m.blendDst);U.setDepthTest(m.depthTest);U.setDepthWrite(m.depthWrite);Y(m.polygonOffset,m.polygonOffsetFactor,m.polygonOffsetUnits)}U.setMaterialFaces(m);t instanceof THREE.BufferGeometry?U.renderBufferDirect(d,e,f,m,t,n):
U.renderBuffer(d,e,f,m,t,n)}}function z(a,b,c,d,e,f,l){for(var p,m,n=0,t=a.length;n<t;n++)if(p=a[n],m=p.object,m.visible){if(l)p=l;else{p=p[b];if(!p)continue;f&&U.setBlending(p.blending,p.blendEquation,p.blendSrc,p.blendDst);U.setDepthTest(p.depthTest);U.setDepthWrite(p.depthWrite);Y(p.polygonOffset,p.polygonOffsetFactor,p.polygonOffsetUnits)}U.renderImmediateObject(c,d,e,p,m)}}function E(a,b){var e,f,l,p;if(void 0===a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new THREE.Matrix4,a._normalMatrix=
new THREE.Matrix3,void 0!==a.geometry&&void 0===a.geometry.__webglInit&&(a.geometry.__webglInit=!0,a.geometry.addEventListener("dispose",lc)),f=a.geometry,void 0!==f))if(f instanceof THREE.BufferGeometry){var m,n;for(m in f.attributes)n="index"===m?s.ELEMENT_ARRAY_BUFFER:s.ARRAY_BUFFER,p=f.attributes[m],p.buffer=s.createBuffer(),s.bindBuffer(n,p.buffer),s.bufferData(n,p.array,s.STATIC_DRAW)}else if(a instanceof THREE.Mesh){l=a.material;if(void 0===f.geometryGroups){m=f;var t,r,q,u,z;n={};var A=m.morphTargets.length,
B=m.morphNormals.length,E=l instanceof THREE.MeshFaceMaterial;m.geometryGroups={};l=0;for(t=m.faces.length;l<t;l++)r=m.faces[l],q=E?r.materialIndex:0,void 0===n[q]&&(n[q]={hash:q,counter:0}),z=n[q].hash+"_"+n[q].counter,void 0===m.geometryGroups[z]&&(m.geometryGroups[z]={faces3:[],faces4:[],materialIndex:q,vertices:0,numMorphTargets:A,numMorphNormals:B}),u=r instanceof THREE.Face3?3:4,65535<m.geometryGroups[z].vertices+u&&(n[q].counter+=1,z=n[q].hash+"_"+n[q].counter,void 0===m.geometryGroups[z]&&
(m.geometryGroups[z]={faces3:[],faces4:[],materialIndex:q,vertices:0,numMorphTargets:A,numMorphNormals:B})),r instanceof THREE.Face3?m.geometryGroups[z].faces3.push(l):m.geometryGroups[z].faces4.push(l),m.geometryGroups[z].vertices+=u;m.geometryGroupsList=[];for(p in m.geometryGroups)m.geometryGroups[p].id=ta++,m.geometryGroupsList.push(m.geometryGroups[p])}for(e in f.geometryGroups)if(p=f.geometryGroups[e],!p.__webglVertexBuffer){m=p;m.__webglVertexBuffer=s.createBuffer();m.__webglNormalBuffer=s.createBuffer();
m.__webglTangentBuffer=s.createBuffer();m.__webglColorBuffer=s.createBuffer();m.__webglUVBuffer=s.createBuffer();m.__webglUV2Buffer=s.createBuffer();m.__webglSkinIndicesBuffer=s.createBuffer();m.__webglSkinWeightsBuffer=s.createBuffer();m.__webglFaceBuffer=s.createBuffer();m.__webglLineBuffer=s.createBuffer();A=n=void 0;if(m.numMorphTargets)for(m.__webglMorphTargetsBuffers=[],n=0,A=m.numMorphTargets;n<A;n++)m.__webglMorphTargetsBuffers.push(s.createBuffer());if(m.numMorphNormals)for(m.__webglMorphNormalsBuffers=
[],n=0,A=m.numMorphNormals;n<A;n++)m.__webglMorphNormalsBuffers.push(s.createBuffer());U.info.memory.geometries++;d(p,a);f.verticesNeedUpdate=!0;f.morphTargetsNeedUpdate=!0;f.elementsNeedUpdate=!0;f.uvsNeedUpdate=!0;f.normalsNeedUpdate=!0;f.tangentsNeedUpdate=!0;f.colorsNeedUpdate=!0}}else a instanceof THREE.Ribbon?f.__webglVertexBuffer||(p=f,p.__webglVertexBuffer=s.createBuffer(),p.__webglColorBuffer=s.createBuffer(),p.__webglNormalBuffer=s.createBuffer(),U.info.memory.geometries++,p=f,m=p.vertices.length,
p.__vertexArray=new Float32Array(3*m),p.__colorArray=new Float32Array(3*m),p.__normalArray=new Float32Array(3*m),p.__webglVertexCount=m,c(p,a),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=!0,f.normalsNeedUpdate=!0):a instanceof THREE.Line?f.__webglVertexBuffer||(p=f,p.__webglVertexBuffer=s.createBuffer(),p.__webglColorBuffer=s.createBuffer(),p.__webglLineDistanceBuffer=s.createBuffer(),U.info.memory.geometries++,p=f,m=p.vertices.length,p.__vertexArray=new Float32Array(3*m),p.__colorArray=new Float32Array(3*
m),p.__lineDistanceArray=new Float32Array(1*m),p.__webglLineCount=m,c(p,a),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=!0,f.lineDistancesNeedUpdate=!0):a instanceof THREE.ParticleSystem&&!f.__webglVertexBuffer&&(p=f,p.__webglVertexBuffer=s.createBuffer(),p.__webglColorBuffer=s.createBuffer(),U.info.memory.geometries++,p=f,m=p.vertices.length,p.__vertexArray=new Float32Array(3*m),p.__colorArray=new Float32Array(3*m),p.__sortArray=[],p.__webglParticleCount=m,c(p,a),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=
!0);if(void 0===a.__webglActive){if(a instanceof THREE.Mesh)if(f=a.geometry,f instanceof THREE.BufferGeometry)C(b.__webglObjects,f,a);else{if(f instanceof THREE.Geometry)for(e in f.geometryGroups)p=f.geometryGroups[e],C(b.__webglObjects,p,a)}else a instanceof THREE.Ribbon||a instanceof THREE.Line||a instanceof THREE.ParticleSystem?(f=a.geometry,C(b.__webglObjects,f,a)):a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback?b.__webglObjectsImmediate.push({object:a,opaque:null,transparent:null}):
a instanceof THREE.Sprite?b.__webglSprites.push(a):a instanceof THREE.LensFlare&&b.__webglFlares.push(a);a.__webglActive=!0}}function C(a,b,c){a.push({buffer:b,object:c,opaque:null,transparent:null})}function A(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function B(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function F(a,b){a instanceof THREE.Mesh||a instanceof THREE.ParticleSystem||a instanceof THREE.Ribbon||a instanceof THREE.Line?I(b.__webglObjects,
a):a instanceof THREE.Sprite?J(b.__webglSprites,a):a instanceof THREE.LensFlare?J(b.__webglFlares,a):(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)&&I(b.__webglObjectsImmediate,a);delete a.__webglActive}function I(a,b){for(var c=a.length-1;0<=c;c--)a[c].object===b&&a.splice(c,1)}function J(a,b){for(var c=a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)}function D(a,b,c,d,e){ya=0;d.needsUpdate&&(d.program&&nc(d),U.initMaterial(d,b,c,e),d.needsUpdate=!1);d.morphTargets&&!e.__webglMorphTargetInfluences&&
(e.__webglMorphTargetInfluences=new Float32Array(U.maxMorphTargets));var f=!1,l=d.program,p=l.uniforms,m=d.uniforms;l!==ia&&(s.useProgram(l),ia=l,f=!0);d.id!==jb&&(jb=d.id,f=!0);if(f||a!==bb)s.uniformMatrix4fv(p.projectionMatrix,!1,a.projectionMatrix.elements),a!==bb&&(bb=a);if(d.skinning)if(jc&&e.useVertexTexture){if(null!==p.boneTexture){var n=P();s.uniform1i(p.boneTexture,n);U.setTexture(e.boneTexture,n)}}else null!==p.boneGlobalMatrices&&s.uniformMatrix4fv(p.boneGlobalMatrices,!1,e.boneMatrices);
if(f){c&&d.fog&&(m.fogColor.value=c.color,c instanceof THREE.Fog?(m.fogNear.value=c.near,m.fogFar.value=c.far):c instanceof THREE.FogExp2&&(m.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Ja){var t,r=n=0,q=0,u,z,C,A=Cb,B=A.directional.colors,E=A.directional.positions,D=A.point.colors,F=A.point.positions,I=A.point.distances,J=A.spot.colors,K=A.spot.positions,V=A.spot.distances,R=A.spot.directions,X=A.spot.anglesCos,T=A.spot.exponents,
S=A.hemi.skyColors,O=A.hemi.groundColors,N=A.hemi.positions,Y=0,va=0,da=0,ha=0,W=0,ba=0,ea=0,ca=0,aa=t=0;c=C=aa=0;for(f=b.length;c<f;c++)if(t=b[c],!t.onlyShadow)if(u=t.color,z=t.intensity,C=t.distance,t instanceof THREE.AmbientLight)t.visible&&(U.gammaInput?(n+=u.r*u.r,r+=u.g*u.g,q+=u.b*u.b):(n+=u.r,r+=u.g,q+=u.b));else if(t instanceof THREE.DirectionalLight){if(W+=1,t.visible&&(Fa.getPositionFromMatrix(t.matrixWorld),$a.getPositionFromMatrix(t.target.matrixWorld),Fa.sub($a),Fa.normalize(),0!==Fa.x||
0!==Fa.y||0!==Fa.z))t=3*Y,E[t]=Fa.x,E[t+1]=Fa.y,E[t+2]=Fa.z,U.gammaInput?M(B,t,u,z*z):G(B,t,u,z),Y+=1}else t instanceof THREE.PointLight?(ba+=1,t.visible&&(aa=3*va,U.gammaInput?M(D,aa,u,z*z):G(D,aa,u,z),$a.getPositionFromMatrix(t.matrixWorld),F[aa]=$a.x,F[aa+1]=$a.y,F[aa+2]=$a.z,I[va]=C,va+=1)):t instanceof THREE.SpotLight?(ea+=1,t.visible&&(aa=3*da,U.gammaInput?M(J,aa,u,z*z):G(J,aa,u,z),$a.getPositionFromMatrix(t.matrixWorld),K[aa]=$a.x,K[aa+1]=$a.y,K[aa+2]=$a.z,V[da]=C,Fa.copy($a),$a.getPositionFromMatrix(t.target.matrixWorld),
Fa.sub($a),Fa.normalize(),R[aa]=Fa.x,R[aa+1]=Fa.y,R[aa+2]=Fa.z,X[da]=Math.cos(t.angle),T[da]=t.exponent,da+=1)):t instanceof THREE.HemisphereLight&&(ca+=1,t.visible&&(Fa.getPositionFromMatrix(t.matrixWorld),Fa.normalize(),0!==Fa.x||0!==Fa.y||0!==Fa.z))&&(C=3*ha,N[C]=Fa.x,N[C+1]=Fa.y,N[C+2]=Fa.z,u=t.color,t=t.groundColor,U.gammaInput?(z*=z,M(S,C,u,z),M(O,C,t,z)):(G(S,C,u,z),G(O,C,t,z)),ha+=1);c=3*Y;for(f=Math.max(B.length,3*W);c<f;c++)B[c]=0;c=3*va;for(f=Math.max(D.length,3*ba);c<f;c++)D[c]=0;c=3*
da;for(f=Math.max(J.length,3*ea);c<f;c++)J[c]=0;c=3*ha;for(f=Math.max(S.length,3*ca);c<f;c++)S[c]=0;c=3*ha;for(f=Math.max(O.length,3*ca);c<f;c++)O[c]=0;A.directional.length=Y;A.point.length=va;A.spot.length=da;A.hemi.length=ha;A.ambient[0]=n;A.ambient[1]=r;A.ambient[2]=q;Ja=!1}c=Cb;m.ambientLightColor.value=c.ambient;m.directionalLightColor.value=c.directional.colors;m.directionalLightDirection.value=c.directional.positions;m.pointLightColor.value=c.point.colors;m.pointLightPosition.value=c.point.positions;
m.pointLightDistance.value=c.point.distances;m.spotLightColor.value=c.spot.colors;m.spotLightPosition.value=c.spot.positions;m.spotLightDistance.value=c.spot.distances;m.spotLightDirection.value=c.spot.directions;m.spotLightAngleCos.value=c.spot.anglesCos;m.spotLightExponent.value=c.spot.exponents;m.hemisphereLightSkyColor.value=c.hemi.skyColors;m.hemisphereLightGroundColor.value=c.hemi.groundColors;m.hemisphereLightDirection.value=c.hemi.positions}if(d instanceof THREE.MeshBasicMaterial||d instanceof
THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){m.opacity.value=d.opacity;U.gammaInput?m.diffuse.value.copyGammaToLinear(d.color):m.diffuse.value=d.color;m.map.value=d.map;m.lightMap.value=d.lightMap;m.specularMap.value=d.specularMap;d.bumpMap&&(m.bumpMap.value=d.bumpMap,m.bumpScale.value=d.bumpScale);d.normalMap&&(m.normalMap.value=d.normalMap,m.normalScale.value.copy(d.normalScale));var ga;d.map?ga=d.map:d.specularMap?ga=d.specularMap:d.normalMap?ga=d.normalMap:d.bumpMap&&(ga=d.bumpMap);
void 0!==ga&&(c=ga.offset,ga=ga.repeat,m.offsetRepeat.value.set(c.x,c.y,ga.x,ga.y));m.envMap.value=d.envMap;m.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;m.reflectivity.value=d.reflectivity;m.refractionRatio.value=d.refractionRatio;m.combine.value=d.combine;m.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(m.diffuse.value=d.color,m.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(m.diffuse.value=
d.color,m.opacity.value=d.opacity,m.dashSize.value=d.dashSize,m.totalSize.value=d.dashSize+d.gapSize,m.scale.value=d.scale):d instanceof THREE.ParticleBasicMaterial?(m.psColor.value=d.color,m.opacity.value=d.opacity,m.size.value=d.size,m.scale.value=Z.height/2,m.map.value=d.map):d instanceof THREE.MeshPhongMaterial?(m.shininess.value=d.shininess,U.gammaInput?(m.ambient.value.copyGammaToLinear(d.ambient),m.emissive.value.copyGammaToLinear(d.emissive),m.specular.value.copyGammaToLinear(d.specular)):
(m.ambient.value=d.ambient,m.emissive.value=d.emissive,m.specular.value=d.specular),d.wrapAround&&m.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(U.gammaInput?(m.ambient.value.copyGammaToLinear(d.ambient),m.emissive.value.copyGammaToLinear(d.emissive)):(m.ambient.value=d.ambient,m.emissive.value=d.emissive),d.wrapAround&&m.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(m.mNear.value=a.near,m.mFar.value=a.far,m.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&
(m.opacity.value=d.opacity);if(e.receiveShadow&&!d._shadowPass&&m.shadowMatrix)for(c=ga=0,f=b.length;c<f;c++)n=b[c],n.castShadow&&(n instanceof THREE.SpotLight||n instanceof THREE.DirectionalLight&&!n.shadowCascade)&&(m.shadowMap.value[ga]=n.shadowMap,m.shadowMapSize.value[ga]=n.shadowMapSize,m.shadowMatrix.value[ga]=n.shadowMatrix,m.shadowDarkness.value[ga]=n.shadowDarkness,m.shadowBias.value[ga]=n.shadowBias,ga++);b=d.uniformsList;m=0;for(ga=b.length;m<ga;m++)if(f=l.uniforms[b[m][1]])if(c=b[m][0],
r=c.type,n=c.value,"i"===r)s.uniform1i(f,n);else if("f"===r)s.uniform1f(f,n);else if("v2"===r)s.uniform2f(f,n.x,n.y);else if("v3"===r)s.uniform3f(f,n.x,n.y,n.z);else if("v4"===r)s.uniform4f(f,n.x,n.y,n.z,n.w);else if("c"===r)s.uniform3f(f,n.r,n.g,n.b);else if("iv1"===r)s.uniform1iv(f,n);else if("iv"===r)s.uniform3iv(f,n);else if("fv1"===r)s.uniform1fv(f,n);else if("fv"===r)s.uniform3fv(f,n);else if("v2v"===r){void 0===c._array&&(c._array=new Float32Array(2*n.length));r=0;for(q=n.length;r<q;r++)A=
2*r,c._array[A]=n[r].x,c._array[A+1]=n[r].y;s.uniform2fv(f,c._array)}else if("v3v"===r){void 0===c._array&&(c._array=new Float32Array(3*n.length));r=0;for(q=n.length;r<q;r++)A=3*r,c._array[A]=n[r].x,c._array[A+1]=n[r].y,c._array[A+2]=n[r].z;s.uniform3fv(f,c._array)}else if("v4v"===r){void 0===c._array&&(c._array=new Float32Array(4*n.length));r=0;for(q=n.length;r<q;r++)A=4*r,c._array[A]=n[r].x,c._array[A+1]=n[r].y,c._array[A+2]=n[r].z,c._array[A+3]=n[r].w;s.uniform4fv(f,c._array)}else if("m4"===r)void 0===
c._array&&(c._array=new Float32Array(16)),n.flattenToArray(c._array),s.uniformMatrix4fv(f,!1,c._array);else if("m4v"===r){void 0===c._array&&(c._array=new Float32Array(16*n.length));r=0;for(q=n.length;r<q;r++)n[r].flattenToArrayOffset(c._array,16*r);s.uniformMatrix4fv(f,!1,c._array)}else if("t"===r){if(A=n,n=P(),s.uniform1i(f,n),A)if(A.image instanceof Array&&6===A.image.length){if(c=A,f=n,6===c.image.length)if(c.needsUpdate){c.image.__webglTextureCube||(c.image.__webglTextureCube=s.createTexture(),
U.info.memory.textures++);s.activeTexture(s.TEXTURE0+f);s.bindTexture(s.TEXTURE_CUBE_MAP,c.image.__webglTextureCube);s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,c.flipY);f=c instanceof THREE.CompressedTexture;n=[];for(r=0;6>r;r++)U.autoScaleCubemaps&&!f?(q=n,A=r,B=c.image[r],D=sc,B.width<=D&&B.height<=D||(F=Math.max(B.width,B.height),E=Math.floor(B.width*D/F),D=Math.floor(B.height*D/F),F=document.createElement("canvas"),F.width=E,F.height=D,F.getContext("2d").drawImage(B,0,0,B.width,B.height,0,0,E,D),B=F),
q[A]=B):n[r]=c.image[r];r=n[0];q=0===(r.width&r.width-1)&&0===(r.height&r.height-1);A=Q(c.format);B=Q(c.type);fa(s.TEXTURE_CUBE_MAP,c,q);for(r=0;6>r;r++)if(f)for(D=n[r].mipmaps,F=0,I=D.length;F<I;F++)E=D[F],s.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+r,F,A,E.width,E.height,0,E.data);else s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,A,A,B,n[r]);c.generateMipmaps&&q&&s.generateMipmap(s.TEXTURE_CUBE_MAP);c.needsUpdate=!1;if(c.onUpdate)c.onUpdate()}else s.activeTexture(s.TEXTURE0+f),s.bindTexture(s.TEXTURE_CUBE_MAP,
c.image.__webglTextureCube)}else A instanceof THREE.WebGLRenderTargetCube?(c=A,s.activeTexture(s.TEXTURE0+n),s.bindTexture(s.TEXTURE_CUBE_MAP,c.__webglTexture)):U.setTexture(A,n)}else if("tv"===r){void 0===c._array&&(c._array=[]);r=0;for(q=c.value.length;r<q;r++)c._array[r]=P();s.uniform1iv(f,c._array);r=0;for(q=c.value.length;r<q;r++)A=c.value[r],n=c._array[r],A&&U.setTexture(A,n)}(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==p.cameraPosition&&($a.getPositionFromMatrix(a.matrixWorld),
s.uniform3f(p.cameraPosition,$a.x,$a.y,$a.z));(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==p.viewMatrix&&s.uniformMatrix4fv(p.viewMatrix,!1,a.matrixWorldInverse.elements)}s.uniformMatrix4fv(p.modelViewMatrix,!1,e._modelViewMatrix.elements);p.normalMatrix&&s.uniformMatrix3fv(p.normalMatrix,!1,e._normalMatrix.elements);null!==p.modelMatrix&&s.uniformMatrix4fv(p.modelMatrix,!1,e.matrixWorld.elements);return l}function P(){var a=
ya;a>=gb&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+gb);ya+=1;return a}function M(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function G(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function K(a){a!==wb&&(s.lineWidth(a),wb=a)}function Y(a,b,c){sa!==a&&(a?s.enable(s.POLYGON_OFFSET_FILL):s.disable(s.POLYGON_OFFSET_FILL),sa=a);!a||cb===b&&Ma===c||(s.polygonOffset(b,c),cb=b,Ma=c)}function T(a){a=a.split("\n");for(var b=0,c=a.length;b<
c;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function O(a,b){var c;"fragment"===a?c=s.createShader(s.FRAGMENT_SHADER):"vertex"===a&&(c=s.createShader(s.VERTEX_SHADER));s.shaderSource(c,b);s.compileShader(c);return s.getShaderParameter(c,s.COMPILE_STATUS)?c:(console.error(s.getShaderInfoLog(c)),console.error(T(b)),null)}function fa(a,b,c){c?(s.texParameteri(a,s.TEXTURE_WRAP_S,Q(b.wrapS)),s.texParameteri(a,s.TEXTURE_WRAP_T,Q(b.wrapT)),s.texParameteri(a,s.TEXTURE_MAG_FILTER,Q(b.magFilter)),s.texParameteri(a,
s.TEXTURE_MIN_FILTER,Q(b.minFilter))):(s.texParameteri(a,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(a,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(a,s.TEXTURE_MAG_FILTER,X(b.magFilter)),s.texParameteri(a,s.TEXTURE_MIN_FILTER,X(b.minFilter)));lb&&b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy)&&(s.texParameterf(a,lb.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,tc)),b.__oldAnisotropy=b.anisotropy)}function S(a,b){s.bindRenderbuffer(s.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?
(s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_COMPONENT16,b.width,b.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,b.width,b.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)):s.renderbufferStorage(s.RENDERBUFFER,s.RGBA4,b.width,b.height)}function X(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?
s.NEAREST:s.LINEAR}function Q(a){if(a===THREE.RepeatWrapping)return s.REPEAT;if(a===THREE.ClampToEdgeWrapping)return s.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return s.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return s.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return s.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return s.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return s.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return s.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return s.LINEAR_MIPMAP_LINEAR;
if(a===THREE.UnsignedByteType)return s.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return s.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return s.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return s.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return s.BYTE;if(a===THREE.ShortType)return s.SHORT;if(a===THREE.UnsignedShortType)return s.UNSIGNED_SHORT;if(a===THREE.IntType)return s.INT;if(a===THREE.UnsignedIntType)return s.UNSIGNED_INT;if(a===THREE.FloatType)return s.FLOAT;
if(a===THREE.AlphaFormat)return s.ALPHA;if(a===THREE.RGBFormat)return s.RGB;if(a===THREE.RGBAFormat)return s.RGBA;if(a===THREE.LuminanceFormat)return s.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return s.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return s.FUNC_ADD;if(a===THREE.SubtractEquation)return s.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return s.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return s.ZERO;if(a===THREE.OneFactor)return s.ONE;if(a===THREE.SrcColorFactor)return s.SRC_COLOR;
if(a===THREE.OneMinusSrcColorFactor)return s.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return s.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return s.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return s.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return s.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return s.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return s.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return s.SRC_ALPHA_SATURATE;if(void 0!==kb){if(a===THREE.RGB_S3TC_DXT1_Format)return kb.COMPRESSED_RGB_S3TC_DXT1_EXT;
if(a===THREE.RGBA_S3TC_DXT1_Format)return kb.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return kb.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return kb.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var Z=void 0!==a.canvas?a.canvas:document.createElement("canvas"),V=void 0!==a.precision?a.precision:"highp",da=void 0!==a.alpha?a.alpha:!0,W=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,ua=void 0!==a.antialias?
a.antialias:!1,aa=void 0!==a.stencil?a.stencil:!0,ja=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,N=new THREE.Color(0),ma=0;void 0!==a.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),N.setHex(a.clearColor));void 0!==a.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),ma=a.clearAlpha);this.domElement=Z;this.context=
null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=
8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var U=this,ga=[],va=0,ia=null,Pa=null,jb=-1,Ka=null,bb=null,ta=0,ya=0,na=-1,ha=-1,ra=-1,za=-1,wa=-1,Aa=-1,q=-1,db=-1,sa=null,cb=null,Ma=null,wb=null,tb=0,Pb=0,Qb=0,Rb=0,hc=0,Yb=0,eb={},Ba=new THREE.Frustum,Sa=new THREE.Matrix4,Ab=new THREE.Matrix4,$a=new THREE.Vector3,Fa=new THREE.Vector3,Ja=!0,Cb=
{ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},s,Fb,sb,lb,kb;(function(){try{if(!(s=Z.getContext("experimental-webgl",{alpha:da,premultipliedAlpha:W,antialias:ua,stencil:aa,preserveDrawingBuffer:ja})))throw"Error creating WebGL context.";}catch(a){console.error(a)}Fb=s.getExtension("OES_texture_float");
sb=s.getExtension("OES_standard_derivatives");lb=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");kb=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");Fb||console.log("THREE.WebGLRenderer: Float textures not supported.");sb||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");
lb||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");kb||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===s.getShaderPrecisionFormat&&(s.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})})();s.clearColor(0,0,0,1);s.clearDepth(1);s.clearStencil(0);s.enable(s.DEPTH_TEST);s.depthFunc(s.LEQUAL);s.frontFace(s.CCW);s.cullFace(s.BACK);s.enable(s.CULL_FACE);s.enable(s.BLEND);s.blendEquation(s.FUNC_ADD);s.blendFunc(s.SRC_ALPHA,
s.ONE_MINUS_SRC_ALPHA);s.clearColor(N.r,N.g,N.b,ma);this.context=s;var gb=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS);a=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS);s.getParameter(s.MAX_TEXTURE_SIZE);var sc=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),tc=lb?s.getParameter(lb.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,ic=0<a,jc=ic&&Fb;kb&&s.getParameter(s.COMPRESSED_TEXTURE_FORMATS);var uc=s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT);a=s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT);
s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.LOW_FLOAT);var kc=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT),Gc=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT);s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.LOW_FLOAT);s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_INT);s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_INT);s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.LOW_INT);s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_INT);s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,
s.MEDIUM_INT);s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.LOW_INT);uc=0<uc.precision&&0<kc.precision;a=0<a.precision&&0<Gc.precision;"highp"!==V||uc||(a?(V="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(V="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==V||a||(V="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return s};this.supportsVertexTextures=function(){return ic};
this.supportsFloatTextures=function(){return Fb};this.supportsStandardDerivatives=function(){return sb};this.supportsCompressedTextureS3TC=function(){return kb};this.getMaxAnisotropy=function(){return tc};this.getPrecision=function(){return V};this.setSize=function(a,b,c){Z.width=a*this.devicePixelRatio;Z.height=b*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==c&&(Z.style.width=a+"px",Z.style.height=b+"px");this.setViewport(0,0,Z.width,Z.height)};this.setViewport=function(a,b,c,d){tb=void 0!==
a?a:0;Pb=void 0!==b?b:0;Qb=void 0!==c?c:Z.width;Rb=void 0!==d?d:Z.height;s.viewport(tb,Pb,Qb,Rb)};this.setScissor=function(a,b,c,d){s.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?s.enable(s.SCISSOR_TEST):s.disable(s.SCISSOR_TEST)};this.setClearColor=function(a,b){N.set(a);ma=void 0!==b?b:1;s.clearColor(N.r,N.g,N.b,ma)};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=
function(){return N};this.getClearAlpha=function(){return ma};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=s.COLOR_BUFFER_BIT;if(void 0===b||b)d|=s.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=s.STENCIL_BUFFER_BIT;s.clear(d)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this);this.renderPluginsPre.push(a)};this.updateShadowMap=function(a,b){ia=null;jb=
Ka=db=q=ra=-1;Ja=!0;ha=na=-1;this.shadowMapPlugin.update(a,b)};var lc=function(a){a=a.target;a.removeEventListener("dispose",lc);a.__webglInit=void 0;void 0!==a.__webglVertexBuffer&&s.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&s.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&s.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&s.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&s.deleteBuffer(a.__webglUVBuffer);void 0!==
a.__webglUV2Buffer&&s.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&s.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&s.deleteBuffer(a.__webglSkinWeightsBuffer);void 0!==a.__webglFaceBuffer&&s.deleteBuffer(a.__webglFaceBuffer);void 0!==a.__webglLineBuffer&&s.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&s.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.geometryGroups)for(var c in a.geometryGroups){var d=a.geometryGroups[c];
if(void 0!==d.numMorphTargets)for(var e=0,f=d.numMorphTargets;e<f;e++)s.deleteBuffer(d.__webglMorphTargetsBuffers[e]);if(void 0!==d.numMorphNormals)for(e=0,f=d.numMorphNormals;e<f;e++)s.deleteBuffer(d.__webglMorphNormalsBuffers[e]);b(d)}b(a);U.info.memory.geometries--},$b=function(a){a=a.target;a.removeEventListener("dispose",$b);a.image&&a.image.__webglTextureCube?s.deleteTexture(a.image.__webglTextureCube):a.__webglInit&&(a.__webglInit=!1,s.deleteTexture(a.__webglTexture));U.info.memory.textures--},
mc=function(a){a=a.target;a.removeEventListener("dispose",mc);if(a&&a.__webglTexture)if(s.deleteTexture(a.__webglTexture),a instanceof THREE.WebGLRenderTargetCube)for(var b=0;6>b;b++)s.deleteFramebuffer(a.__webglFramebuffer[b]),s.deleteRenderbuffer(a.__webglRenderbuffer[b]);else s.deleteFramebuffer(a.__webglFramebuffer),s.deleteRenderbuffer(a.__webglRenderbuffer);U.info.memory.textures--},yc=function(a){a=a.target;a.removeEventListener("dispose",yc);nc(a)},nc=function(a){var b=a.program;if(void 0!==
b){a.program=void 0;var c,d,e=!1;a=0;for(c=ga.length;a<c;a++)if(d=ga[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=[];a=0;for(c=ga.length;a<c;a++)d=ga[a],d.program!==b&&e.push(d);ga=e;s.deleteProgram(b);U.info.memory.programs--}}};this.renderBufferImmediate=function(a,b,c){a.hasPositions&&!a.__webglVertexBuffer&&(a.__webglVertexBuffer=s.createBuffer());a.hasNormals&&!a.__webglNormalBuffer&&(a.__webglNormalBuffer=s.createBuffer());a.hasUvs&&!a.__webglUvBuffer&&(a.__webglUvBuffer=
s.createBuffer());a.hasColors&&!a.__webglColorBuffer&&(a.__webglColorBuffer=s.createBuffer());a.hasPositions&&(s.bindBuffer(s.ARRAY_BUFFER,a.__webglVertexBuffer),s.bufferData(s.ARRAY_BUFFER,a.positionArray,s.DYNAMIC_DRAW),s.enableVertexAttribArray(b.attributes.position),s.vertexAttribPointer(b.attributes.position,3,s.FLOAT,!1,0,0));if(a.hasNormals){s.bindBuffer(s.ARRAY_BUFFER,a.__webglNormalBuffer);if(c.shading===THREE.FlatShading){var d,e,f,l,p,m,n,r,t,q,u,z=3*a.count;for(u=0;u<z;u+=9)q=a.normalArray,
d=q[u],e=q[u+1],f=q[u+2],l=q[u+3],m=q[u+4],r=q[u+5],p=q[u+6],n=q[u+7],t=q[u+8],d=(d+l+p)/3,e=(e+m+n)/3,f=(f+r+t)/3,q[u]=d,q[u+1]=e,q[u+2]=f,q[u+3]=d,q[u+4]=e,q[u+5]=f,q[u+6]=d,q[u+7]=e,q[u+8]=f}s.bufferData(s.ARRAY_BUFFER,a.normalArray,s.DYNAMIC_DRAW);s.enableVertexAttribArray(b.attributes.normal);s.vertexAttribPointer(b.attributes.normal,3,s.FLOAT,!1,0,0)}a.hasUvs&&c.map&&(s.bindBuffer(s.ARRAY_BUFFER,a.__webglUvBuffer),s.bufferData(s.ARRAY_BUFFER,a.uvArray,s.DYNAMIC_DRAW),s.enableVertexAttribArray(b.attributes.uv),
s.vertexAttribPointer(b.attributes.uv,2,s.FLOAT,!1,0,0));a.hasColors&&c.vertexColors!==THREE.NoColors&&(s.bindBuffer(s.ARRAY_BUFFER,a.__webglColorBuffer),s.bufferData(s.ARRAY_BUFFER,a.colorArray,s.DYNAMIC_DRAW),s.enableVertexAttribArray(b.attributes.color),s.vertexAttribPointer(b.attributes.color,3,s.FLOAT,!1,0,0));s.drawArrays(s.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,b,c,d,e,f){if(!1!==d.visible){var l,p,r;l=D(a,b,c,d,f);a=l.attributes;b=e.attributes;c=!1;l=16777215*e.id+
2*l.id+(d.wireframe?1:0);l!==Ka&&(Ka=l,c=!0);c&&n();if(f instanceof THREE.Mesh)if(d=b.index){e=e.offsets;1<e.length&&(c=!0);for(var t=0,q=e.length;t<q;t++){var u=e[t].index;if(c){for(p in b)"index"!==p&&(l=a[p],f=b[p],r=f.itemSize,0<=l&&(s.bindBuffer(s.ARRAY_BUFFER,f.buffer),m(l),s.vertexAttribPointer(l,r,s.FLOAT,!1,0,4*u*r)));s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,d.buffer)}s.drawElements(s.TRIANGLES,e[t].count,s.UNSIGNED_SHORT,2*e[t].start);U.info.render.calls++;U.info.render.vertices+=e[t].count;
U.info.render.faces+=e[t].count/3}}else{if(c)for(p in b)"index"!==p&&(l=a[p],f=b[p],r=f.itemSize,0<=l&&(s.bindBuffer(s.ARRAY_BUFFER,f.buffer),m(l),s.vertexAttribPointer(l,r,s.FLOAT,!1,0,0)));p=e.attributes.position;s.drawArrays(s.TRIANGLES,0,p.numItems/3);U.info.render.calls++;U.info.render.vertices+=p.numItems/3;U.info.render.faces+=p.numItems/3/3}else if(f instanceof THREE.ParticleSystem){if(c){for(p in b)l=a[p],f=b[p],r=f.itemSize,0<=l&&(s.bindBuffer(s.ARRAY_BUFFER,f.buffer),m(l),s.vertexAttribPointer(l,
r,s.FLOAT,!1,0,0));p=b.position;s.drawArrays(s.POINTS,0,p.numItems/3);U.info.render.calls++;U.info.render.points+=p.numItems/3}}else if(f instanceof THREE.Line&&c){for(p in b)l=a[p],f=b[p],r=f.itemSize,0<=l&&(s.bindBuffer(s.ARRAY_BUFFER,f.buffer),m(l),s.vertexAttribPointer(l,r,s.FLOAT,!1,0,0));K(d.linewidth);p=b.position;s.drawArrays(s.LINE_STRIP,0,p.numItems/3);U.info.render.calls++;U.info.render.points+=p.numItems}}};this.renderBuffer=function(a,b,c,d,e,f){if(!1!==d.visible){var l,p;c=D(a,b,c,d,
f);a=c.attributes;b=!1;c=16777215*e.id+2*c.id+(d.wireframe?1:0);c!==Ka&&(Ka=c,b=!0);b&&n();if(!d.morphTargets&&0<=a.position)b&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglVertexBuffer),m(a.position),s.vertexAttribPointer(a.position,3,s.FLOAT,!1,0,0));else if(f.morphTargetBase){c=d.program.attributes;-1!==f.morphTargetBase&&0<=c.position?(s.bindBuffer(s.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[f.morphTargetBase]),m(c.position),s.vertexAttribPointer(c.position,3,s.FLOAT,!1,0,0)):0<=c.position&&(s.bindBuffer(s.ARRAY_BUFFER,
e.__webglVertexBuffer),m(c.position),s.vertexAttribPointer(c.position,3,s.FLOAT,!1,0,0));if(f.morphTargetForcedOrder.length){var t=0;p=f.morphTargetForcedOrder;for(l=f.morphTargetInfluences;t<d.numSupportedMorphTargets&&t<p.length;)0<=c["morphTarget"+t]&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[p[t]]),m(c["morphTarget"+t]),s.vertexAttribPointer(c["morphTarget"+t],3,s.FLOAT,!1,0,0)),0<=c["morphNormal"+t]&&d.morphNormals&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[p[t]]),
m(c["morphNormal"+t]),s.vertexAttribPointer(c["morphNormal"+t],3,s.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[t]=l[p[t]],t++}else{p=[];l=f.morphTargetInfluences;var q,u=l.length;for(q=0;q<u;q++)t=l[q],0<t&&p.push([t,q]);p.length>d.numSupportedMorphTargets?(p.sort(r),p.length=d.numSupportedMorphTargets):p.length>d.numSupportedMorphNormals?p.sort(r):0===p.length&&p.push([0,0]);for(t=0;t<d.numSupportedMorphTargets;)p[t]?(q=p[t][1],0<=c["morphTarget"+t]&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[q]),
m(c["morphTarget"+t]),s.vertexAttribPointer(c["morphTarget"+t],3,s.FLOAT,!1,0,0)),0<=c["morphNormal"+t]&&d.morphNormals&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[q]),m(c["morphNormal"+t]),s.vertexAttribPointer(c["morphNormal"+t],3,s.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[t]=l[q]):f.__webglMorphTargetInfluences[t]=0,t++}null!==d.program.uniforms.morphTargetInfluences&&s.uniform1fv(d.program.uniforms.morphTargetInfluences,f.__webglMorphTargetInfluences)}if(b){if(e.__webglCustomAttributesList)for(l=
0,p=e.__webglCustomAttributesList.length;l<p;l++)c=e.__webglCustomAttributesList[l],0<=a[c.buffer.belongsToAttribute]&&(s.bindBuffer(s.ARRAY_BUFFER,c.buffer),m(a[c.buffer.belongsToAttribute]),s.vertexAttribPointer(a[c.buffer.belongsToAttribute],c.size,s.FLOAT,!1,0,0));0<=a.color&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglColorBuffer),m(a.color),s.vertexAttribPointer(a.color,3,s.FLOAT,!1,0,0));0<=a.normal&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglNormalBuffer),m(a.normal),s.vertexAttribPointer(a.normal,3,
s.FLOAT,!1,0,0));0<=a.tangent&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglTangentBuffer),m(a.tangent),s.vertexAttribPointer(a.tangent,4,s.FLOAT,!1,0,0));0<=a.uv&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglUVBuffer),m(a.uv),s.vertexAttribPointer(a.uv,2,s.FLOAT,!1,0,0));0<=a.uv2&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglUV2Buffer),m(a.uv2),s.vertexAttribPointer(a.uv2,2,s.FLOAT,!1,0,0));d.skinning&&(0<=a.skinIndex&&0<=a.skinWeight)&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),m(a.skinIndex),s.vertexAttribPointer(a.skinIndex,
4,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),m(a.skinWeight),s.vertexAttribPointer(a.skinWeight,4,s.FLOAT,!1,0,0));0<=a.lineDistance&&(s.bindBuffer(s.ARRAY_BUFFER,e.__webglLineDistanceBuffer),m(a.lineDistance),s.vertexAttribPointer(a.lineDistance,1,s.FLOAT,!1,0,0))}f instanceof THREE.Mesh?(d.wireframe?(K(d.wireframeLinewidth),b&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),s.drawElements(s.LINES,e.__webglLineCount,s.UNSIGNED_SHORT,0)):(b&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,
e.__webglFaceBuffer),s.drawElements(s.TRIANGLES,e.__webglFaceCount,s.UNSIGNED_SHORT,0)),U.info.render.calls++,U.info.render.vertices+=e.__webglFaceCount,U.info.render.faces+=e.__webglFaceCount/3):f instanceof THREE.Line?(f=f.type===THREE.LineStrip?s.LINE_STRIP:s.LINES,K(d.linewidth),s.drawArrays(f,0,e.__webglLineCount),U.info.render.calls++):f instanceof THREE.ParticleSystem?(s.drawArrays(s.POINTS,0,e.__webglParticleCount),U.info.render.calls++,U.info.render.points+=e.__webglParticleCount):f instanceof
THREE.Ribbon&&(s.drawArrays(s.TRIANGLE_STRIP,0,e.__webglVertexCount),U.info.render.calls++)}};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e,f,l,m,n=a.__lights,r=a.fog;jb=-1;Ja=!0;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);Sa.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);Ba.setFromMatrix(Sa);
this.autoUpdateObjects&&this.initWebGLObjects(a);t(this.renderPluginsPre,a,b);U.info.render.calls=0;U.info.render.vertices=0;U.info.render.faces=0;U.info.render.points=0;this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);m=a.__webglObjects;d=0;for(e=m.length;d<e;d++)if(f=m[d],l=f.object,f.id=d,f.render=!1,l.visible&&(!(l instanceof THREE.Mesh||l instanceof THREE.ParticleSystem)||!l.frustumCulled||Ba.intersectsObject(l))){var q=l;
q._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,q.matrixWorld);q._normalMatrix.getNormalMatrix(q._modelViewMatrix);var q=f,A=q.buffer,C=void 0,B=C=void 0,B=q.object.material;if(B instanceof THREE.MeshFaceMaterial)C=A.materialIndex,C=B.materials[C],C.transparent?(q.transparent=C,q.opaque=null):(q.opaque=C,q.transparent=null);else if(C=B)C.transparent?(q.transparent=C,q.opaque=null):(q.opaque=C,q.transparent=null);f.render=!0;!0===this.sortObjects&&(null!==l.renderDepth?f.z=l.renderDepth:($a.getPositionFromMatrix(l.matrixWorld),
$a.applyProjection(Sa),f.z=$a.z))}this.sortObjects&&m.sort(p);m=a.__webglObjectsImmediate;d=0;for(e=m.length;d<e;d++)f=m[d],l=f.object,l.visible&&(l._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,l.matrixWorld),l._normalMatrix.getNormalMatrix(l._modelViewMatrix),l=f.object.material,l.transparent?(f.transparent=l,f.opaque=null):(f.opaque=l,f.transparent=null));a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),
this.setDepthWrite(d.depthWrite),Y(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),u(a.__webglObjects,!1,"",b,n,r,!0,d),z(a.__webglObjectsImmediate,"",b,n,r,!1,d)):(d=null,this.setBlending(THREE.NoBlending),u(a.__webglObjects,!0,"opaque",b,n,r,!1,d),z(a.__webglObjectsImmediate,"opaque",b,n,r,!1,d),u(a.__webglObjects,!1,"transparent",b,n,r,!0,d),z(a.__webglObjectsImmediate,"transparent",b,n,r,!0,d));t(this.renderPluginsPost,a,b);c&&(c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&
c.minFilter!==THREE.LinearFilter)&&(c instanceof THREE.WebGLRenderTargetCube?(s.bindTexture(s.TEXTURE_CUBE_MAP,c.__webglTexture),s.generateMipmap(s.TEXTURE_CUBE_MAP),s.bindTexture(s.TEXTURE_CUBE_MAP,null)):(s.bindTexture(s.TEXTURE_2D,c.__webglTexture),s.generateMipmap(s.TEXTURE_2D),s.bindTexture(s.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.renderImmediateObject=function(a,b,c,d,e){var f=D(a,b,c,d,e);Ka=-1;U.setMaterialFaces(d);e.immediateRenderCallback?e.immediateRenderCallback(f,
s,Ba):e.render(function(a){U.renderBufferImmediate(a,f,d)})};this.initWebGLObjects=function(a){a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);for(;a.__objectsAdded.length;)E(a.__objectsAdded[0],a),a.__objectsAdded.splice(0,1);for(;a.__objectsRemoved.length;)F(a.__objectsRemoved[0],a),a.__objectsRemoved.splice(0,1);for(var b=0,c=a.__webglObjects.length;b<c;b++){var p=a.__webglObjects[b].object;void 0===p.__webglInit&&(void 0!==p.__webglActive&&
F(p,a),E(p,a));var m=p,n=m.geometry,t=void 0,q=void 0,u=void 0;if(n instanceof THREE.BufferGeometry){var z=s.DYNAMIC_DRAW,C=!n.dynamic,D=n.attributes,G=void 0,I=void 0;for(G in D)I=D[G],I.needsUpdate&&("index"===G?(s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,I.buffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,I.array,z)):(s.bindBuffer(s.ARRAY_BUFFER,I.buffer),s.bufferData(s.ARRAY_BUFFER,I.array,z)),I.needsUpdate=!1),C&&!I.dynamic&&delete I.array}else if(m instanceof THREE.Mesh){for(var J=0,Q=n.geometryGroupsList.length;J<
Q;J++)if(t=n.geometryGroupsList[J],u=e(m,t),n.buffersNeedUpdate&&d(t,m),q=u.attributes&&A(u),n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||q){var K=t,P=m,M=s.DYNAMIC_DRAW,V=!n.dynamic,X=u;if(K.__inittedArrays){var T=f(X),S=X.vertexColors?X.vertexColors:!1,Z=l(X),U=T===THREE.SmoothShading,R=void 0,O=void 0,Y=void 0,N=void 0,ia=void 0,va=void 0,da=void 0,fa=void 0,aa=void 0,ha=void 0,ga=void 0,ba=
void 0,ea=void 0,ca=void 0,W=void 0,na=void 0,ta=void 0,ja=void 0,ma=void 0,ya=void 0,ra=void 0,Pa=void 0,wa=void 0,sa=void 0,ua=void 0,Ka=void 0,jb=void 0,za=void 0,Aa=void 0,Ba=void 0,bb=void 0,Fa=void 0,Ja=void 0,Ma=void 0,db=void 0,La=void 0,sb=void 0,cb=void 0,ka=void 0,kb=void 0,ob=void 0,wb=void 0,hb=void 0,nb=void 0,gb=void 0,eb=void 0,ab=0,ib=0,lb=0,tb=0,Kb=0,pb=0,Qa=0,Bb=0,fb=0,oa=0,xa=0,L=0,Na=void 0,rb=K.__vertexArray,Cb=K.__uvArray,Fb=K.__uv2Array,Mb=K.__normalArray,Wa=K.__tangentArray,
qb=K.__colorArray,Xa=K.__skinIndexArray,Ya=K.__skinWeightArray,Pb=K.__morphTargetsArrays,Qb=K.__morphNormalsArrays,Rb=K.__webglCustomAttributesList,H=void 0,Zb=K.__faceArray,Ib=K.__lineArray,Db=P.geometry,hc=Db.elementsNeedUpdate,Yb=Db.uvsNeedUpdate,sc=Db.normalsNeedUpdate,tc=Db.tangentsNeedUpdate,uc=Db.colorsNeedUpdate,yc=Db.morphTargetsNeedUpdate,Ac=Db.vertices,Ia=K.faces3,Ha=K.faces4,xb=Db.faces,ic=Db.faceVertexUvs[0],jc=Db.faceVertexUvs[1],Bc=Db.skinIndices,qc=Db.skinWeights,rc=Db.morphTargets,
$b=Db.morphNormals;if(Db.verticesNeedUpdate){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],ba=Ac[N.a],ea=Ac[N.b],ca=Ac[N.c],rb[ib]=ba.x,rb[ib+1]=ba.y,rb[ib+2]=ba.z,rb[ib+3]=ea.x,rb[ib+4]=ea.y,rb[ib+5]=ea.z,rb[ib+6]=ca.x,rb[ib+7]=ca.y,rb[ib+8]=ca.z,ib+=9;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],ba=Ac[N.a],ea=Ac[N.b],ca=Ac[N.c],W=Ac[N.d],rb[ib]=ba.x,rb[ib+1]=ba.y,rb[ib+2]=ba.z,rb[ib+3]=ea.x,rb[ib+4]=ea.y,rb[ib+5]=ea.z,rb[ib+6]=ca.x,rb[ib+7]=ca.y,rb[ib+8]=ca.z,rb[ib+9]=W.x,rb[ib+10]=W.y,rb[ib+11]=W.z,ib+=12;
s.bindBuffer(s.ARRAY_BUFFER,K.__webglVertexBuffer);s.bufferData(s.ARRAY_BUFFER,rb,M)}if(yc)for(ob=0,wb=rc.length;ob<wb;ob++){R=xa=0;for(O=Ia.length;R<O;R++)gb=Ia[R],N=xb[gb],ba=rc[ob].vertices[N.a],ea=rc[ob].vertices[N.b],ca=rc[ob].vertices[N.c],hb=Pb[ob],hb[xa]=ba.x,hb[xa+1]=ba.y,hb[xa+2]=ba.z,hb[xa+3]=ea.x,hb[xa+4]=ea.y,hb[xa+5]=ea.z,hb[xa+6]=ca.x,hb[xa+7]=ca.y,hb[xa+8]=ca.z,X.morphNormals&&(U?(eb=$b[ob].vertexNormals[gb],ya=eb.a,ra=eb.b,Pa=eb.c):Pa=ra=ya=$b[ob].faceNormals[gb],nb=Qb[ob],nb[xa]=
ya.x,nb[xa+1]=ya.y,nb[xa+2]=ya.z,nb[xa+3]=ra.x,nb[xa+4]=ra.y,nb[xa+5]=ra.z,nb[xa+6]=Pa.x,nb[xa+7]=Pa.y,nb[xa+8]=Pa.z),xa+=9;R=0;for(O=Ha.length;R<O;R++)gb=Ha[R],N=xb[gb],ba=rc[ob].vertices[N.a],ea=rc[ob].vertices[N.b],ca=rc[ob].vertices[N.c],W=rc[ob].vertices[N.d],hb=Pb[ob],hb[xa]=ba.x,hb[xa+1]=ba.y,hb[xa+2]=ba.z,hb[xa+3]=ea.x,hb[xa+4]=ea.y,hb[xa+5]=ea.z,hb[xa+6]=ca.x,hb[xa+7]=ca.y,hb[xa+8]=ca.z,hb[xa+9]=W.x,hb[xa+10]=W.y,hb[xa+11]=W.z,X.morphNormals&&(U?(eb=$b[ob].vertexNormals[gb],ya=eb.a,ra=eb.b,
Pa=eb.c,wa=eb.d):wa=Pa=ra=ya=$b[ob].faceNormals[gb],nb=Qb[ob],nb[xa]=ya.x,nb[xa+1]=ya.y,nb[xa+2]=ya.z,nb[xa+3]=ra.x,nb[xa+4]=ra.y,nb[xa+5]=ra.z,nb[xa+6]=Pa.x,nb[xa+7]=Pa.y,nb[xa+8]=Pa.z,nb[xa+9]=wa.x,nb[xa+10]=wa.y,nb[xa+11]=wa.z),xa+=12;s.bindBuffer(s.ARRAY_BUFFER,K.__webglMorphTargetsBuffers[ob]);s.bufferData(s.ARRAY_BUFFER,Pb[ob],M);X.morphNormals&&(s.bindBuffer(s.ARRAY_BUFFER,K.__webglMorphNormalsBuffers[ob]),s.bufferData(s.ARRAY_BUFFER,Qb[ob],M))}if(qc.length){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],
za=qc[N.a],Aa=qc[N.b],Ba=qc[N.c],Ya[oa]=za.x,Ya[oa+1]=za.y,Ya[oa+2]=za.z,Ya[oa+3]=za.w,Ya[oa+4]=Aa.x,Ya[oa+5]=Aa.y,Ya[oa+6]=Aa.z,Ya[oa+7]=Aa.w,Ya[oa+8]=Ba.x,Ya[oa+9]=Ba.y,Ya[oa+10]=Ba.z,Ya[oa+11]=Ba.w,Fa=Bc[N.a],Ja=Bc[N.b],Ma=Bc[N.c],Xa[oa]=Fa.x,Xa[oa+1]=Fa.y,Xa[oa+2]=Fa.z,Xa[oa+3]=Fa.w,Xa[oa+4]=Ja.x,Xa[oa+5]=Ja.y,Xa[oa+6]=Ja.z,Xa[oa+7]=Ja.w,Xa[oa+8]=Ma.x,Xa[oa+9]=Ma.y,Xa[oa+10]=Ma.z,Xa[oa+11]=Ma.w,oa+=12;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],za=qc[N.a],Aa=qc[N.b],Ba=qc[N.c],bb=qc[N.d],Ya[oa]=za.x,
Ya[oa+1]=za.y,Ya[oa+2]=za.z,Ya[oa+3]=za.w,Ya[oa+4]=Aa.x,Ya[oa+5]=Aa.y,Ya[oa+6]=Aa.z,Ya[oa+7]=Aa.w,Ya[oa+8]=Ba.x,Ya[oa+9]=Ba.y,Ya[oa+10]=Ba.z,Ya[oa+11]=Ba.w,Ya[oa+12]=bb.x,Ya[oa+13]=bb.y,Ya[oa+14]=bb.z,Ya[oa+15]=bb.w,Fa=Bc[N.a],Ja=Bc[N.b],Ma=Bc[N.c],db=Bc[N.d],Xa[oa]=Fa.x,Xa[oa+1]=Fa.y,Xa[oa+2]=Fa.z,Xa[oa+3]=Fa.w,Xa[oa+4]=Ja.x,Xa[oa+5]=Ja.y,Xa[oa+6]=Ja.z,Xa[oa+7]=Ja.w,Xa[oa+8]=Ma.x,Xa[oa+9]=Ma.y,Xa[oa+10]=Ma.z,Xa[oa+11]=Ma.w,Xa[oa+12]=db.x,Xa[oa+13]=db.y,Xa[oa+14]=db.z,Xa[oa+15]=db.w,oa+=16;0<oa&&
(s.bindBuffer(s.ARRAY_BUFFER,K.__webglSkinIndicesBuffer),s.bufferData(s.ARRAY_BUFFER,Xa,M),s.bindBuffer(s.ARRAY_BUFFER,K.__webglSkinWeightsBuffer),s.bufferData(s.ARRAY_BUFFER,Ya,M))}if(uc&&S){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],da=N.vertexColors,fa=N.color,3===da.length&&S===THREE.VertexColors?(sa=da[0],ua=da[1],Ka=da[2]):Ka=ua=sa=fa,qb[fb]=sa.r,qb[fb+1]=sa.g,qb[fb+2]=sa.b,qb[fb+3]=ua.r,qb[fb+4]=ua.g,qb[fb+5]=ua.b,qb[fb+6]=Ka.r,qb[fb+7]=Ka.g,qb[fb+8]=Ka.b,fb+=9;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],
da=N.vertexColors,fa=N.color,4===da.length&&S===THREE.VertexColors?(sa=da[0],ua=da[1],Ka=da[2],jb=da[3]):jb=Ka=ua=sa=fa,qb[fb]=sa.r,qb[fb+1]=sa.g,qb[fb+2]=sa.b,qb[fb+3]=ua.r,qb[fb+4]=ua.g,qb[fb+5]=ua.b,qb[fb+6]=Ka.r,qb[fb+7]=Ka.g,qb[fb+8]=Ka.b,qb[fb+9]=jb.r,qb[fb+10]=jb.g,qb[fb+11]=jb.b,fb+=12;0<fb&&(s.bindBuffer(s.ARRAY_BUFFER,K.__webglColorBuffer),s.bufferData(s.ARRAY_BUFFER,qb,M))}if(tc&&Db.hasTangents){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],aa=N.vertexTangents,na=aa[0],ta=aa[1],ja=aa[2],Wa[Qa]=
na.x,Wa[Qa+1]=na.y,Wa[Qa+2]=na.z,Wa[Qa+3]=na.w,Wa[Qa+4]=ta.x,Wa[Qa+5]=ta.y,Wa[Qa+6]=ta.z,Wa[Qa+7]=ta.w,Wa[Qa+8]=ja.x,Wa[Qa+9]=ja.y,Wa[Qa+10]=ja.z,Wa[Qa+11]=ja.w,Qa+=12;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],aa=N.vertexTangents,na=aa[0],ta=aa[1],ja=aa[2],ma=aa[3],Wa[Qa]=na.x,Wa[Qa+1]=na.y,Wa[Qa+2]=na.z,Wa[Qa+3]=na.w,Wa[Qa+4]=ta.x,Wa[Qa+5]=ta.y,Wa[Qa+6]=ta.z,Wa[Qa+7]=ta.w,Wa[Qa+8]=ja.x,Wa[Qa+9]=ja.y,Wa[Qa+10]=ja.z,Wa[Qa+11]=ja.w,Wa[Qa+12]=ma.x,Wa[Qa+13]=ma.y,Wa[Qa+14]=ma.z,Wa[Qa+15]=ma.w,Qa+=16;s.bindBuffer(s.ARRAY_BUFFER,
K.__webglTangentBuffer);s.bufferData(s.ARRAY_BUFFER,Wa,M)}if(sc&&T){R=0;for(O=Ia.length;R<O;R++)if(N=xb[Ia[R]],ia=N.vertexNormals,va=N.normal,3===ia.length&&U)for(La=0;3>La;La++)cb=ia[La],Mb[pb]=cb.x,Mb[pb+1]=cb.y,Mb[pb+2]=cb.z,pb+=3;else for(La=0;3>La;La++)Mb[pb]=va.x,Mb[pb+1]=va.y,Mb[pb+2]=va.z,pb+=3;R=0;for(O=Ha.length;R<O;R++)if(N=xb[Ha[R]],ia=N.vertexNormals,va=N.normal,4===ia.length&&U)for(La=0;4>La;La++)cb=ia[La],Mb[pb]=cb.x,Mb[pb+1]=cb.y,Mb[pb+2]=cb.z,pb+=3;else for(La=0;4>La;La++)Mb[pb]=
va.x,Mb[pb+1]=va.y,Mb[pb+2]=va.z,pb+=3;s.bindBuffer(s.ARRAY_BUFFER,K.__webglNormalBuffer);s.bufferData(s.ARRAY_BUFFER,Mb,M)}if(Yb&&ic&&Z){R=0;for(O=Ia.length;R<O;R++)if(Y=Ia[R],ha=ic[Y],void 0!==ha)for(La=0;3>La;La++)ka=ha[La],Cb[lb]=ka.x,Cb[lb+1]=ka.y,lb+=2;R=0;for(O=Ha.length;R<O;R++)if(Y=Ha[R],ha=ic[Y],void 0!==ha)for(La=0;4>La;La++)ka=ha[La],Cb[lb]=ka.x,Cb[lb+1]=ka.y,lb+=2;0<lb&&(s.bindBuffer(s.ARRAY_BUFFER,K.__webglUVBuffer),s.bufferData(s.ARRAY_BUFFER,Cb,M))}if(Yb&&jc&&Z){R=0;for(O=Ia.length;R<
O;R++)if(Y=Ia[R],ga=jc[Y],void 0!==ga)for(La=0;3>La;La++)kb=ga[La],Fb[tb]=kb.x,Fb[tb+1]=kb.y,tb+=2;R=0;for(O=Ha.length;R<O;R++)if(Y=Ha[R],ga=jc[Y],void 0!==ga)for(La=0;4>La;La++)kb=ga[La],Fb[tb]=kb.x,Fb[tb+1]=kb.y,tb+=2;0<tb&&(s.bindBuffer(s.ARRAY_BUFFER,K.__webglUV2Buffer),s.bufferData(s.ARRAY_BUFFER,Fb,M))}if(hc){R=0;for(O=Ia.length;R<O;R++)Zb[Kb]=ab,Zb[Kb+1]=ab+1,Zb[Kb+2]=ab+2,Kb+=3,Ib[Bb]=ab,Ib[Bb+1]=ab+1,Ib[Bb+2]=ab,Ib[Bb+3]=ab+2,Ib[Bb+4]=ab+1,Ib[Bb+5]=ab+2,Bb+=6,ab+=3;R=0;for(O=Ha.length;R<
O;R++)Zb[Kb]=ab,Zb[Kb+1]=ab+1,Zb[Kb+2]=ab+3,Zb[Kb+3]=ab+1,Zb[Kb+4]=ab+2,Zb[Kb+5]=ab+3,Kb+=6,Ib[Bb]=ab,Ib[Bb+1]=ab+1,Ib[Bb+2]=ab,Ib[Bb+3]=ab+3,Ib[Bb+4]=ab+1,Ib[Bb+5]=ab+2,Ib[Bb+6]=ab+2,Ib[Bb+7]=ab+3,Bb+=8,ab+=4;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,K.__webglFaceBuffer);s.bufferData(s.ELEMENT_ARRAY_BUFFER,Zb,M);s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,K.__webglLineBuffer);s.bufferData(s.ELEMENT_ARRAY_BUFFER,Ib,M)}if(Rb)for(La=0,sb=Rb.length;La<sb;La++)if(H=Rb[La],H.__original.needsUpdate){L=0;if(1===H.size)if(void 0===
H.boundTo||"vertices"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],H.array[L]=H.value[N.a],H.array[L+1]=H.value[N.b],H.array[L+2]=H.value[N.c],L+=3;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],H.array[L]=H.value[N.a],H.array[L+1]=H.value[N.b],H.array[L+2]=H.value[N.c],H.array[L+3]=H.value[N.d],L+=4}else{if("faces"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)Na=H.value[Ia[R]],H.array[L]=Na,H.array[L+1]=Na,H.array[L+2]=Na,L+=3;R=0;for(O=Ha.length;R<O;R++)Na=H.value[Ha[R]],H.array[L]=Na,H.array[L+1]=
Na,H.array[L+2]=Na,H.array[L+3]=Na,L+=4}}else if(2===H.size)if(void 0===H.boundTo||"vertices"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ea.x,H.array[L+3]=ea.y,H.array[L+4]=ca.x,H.array[L+5]=ca.y,L+=6;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],W=H.value[N.d],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ea.x,H.array[L+3]=ea.y,H.array[L+4]=ca.x,H.array[L+
5]=ca.y,H.array[L+6]=W.x,H.array[L+7]=W.y,L+=8}else{if("faces"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)ca=ea=ba=Na=H.value[Ia[R]],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ea.x,H.array[L+3]=ea.y,H.array[L+4]=ca.x,H.array[L+5]=ca.y,L+=6;R=0;for(O=Ha.length;R<O;R++)W=ca=ea=ba=Na=H.value[Ha[R]],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ea.x,H.array[L+3]=ea.y,H.array[L+4]=ca.x,H.array[L+5]=ca.y,H.array[L+6]=W.x,H.array[L+7]=W.y,L+=8}}else if(3===H.size){var la;la="c"===H.type?["r","g","b"]:
["x","y","z"];if(void 0===H.boundTo||"vertices"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],H.array[L]=ba[la[0]],H.array[L+1]=ba[la[1]],H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],H.array[L+8]=ca[la[2]],L+=9;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],W=H.value[N.d],H.array[L]=ba[la[0]],H.array[L+1]=ba[la[1]],
H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],H.array[L+8]=ca[la[2]],H.array[L+9]=W[la[0]],H.array[L+10]=W[la[1]],H.array[L+11]=W[la[2]],L+=12}else if("faces"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)ca=ea=ba=Na=H.value[Ia[R]],H.array[L]=ba[la[0]],H.array[L+1]=ba[la[1]],H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],
H.array[L+8]=ca[la[2]],L+=9;R=0;for(O=Ha.length;R<O;R++)W=ca=ea=ba=Na=H.value[Ha[R]],H.array[L]=ba[la[0]],H.array[L+1]=ba[la[1]],H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],H.array[L+8]=ca[la[2]],H.array[L+9]=W[la[0]],H.array[L+10]=W[la[1]],H.array[L+11]=W[la[2]],L+=12}else if("faceVertices"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)Na=H.value[Ia[R]],ba=Na[0],ea=Na[1],ca=Na[2],H.array[L]=ba[la[0]],H.array[L+
1]=ba[la[1]],H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],H.array[L+8]=ca[la[2]],L+=9;R=0;for(O=Ha.length;R<O;R++)Na=H.value[Ha[R]],ba=Na[0],ea=Na[1],ca=Na[2],W=Na[3],H.array[L]=ba[la[0]],H.array[L+1]=ba[la[1]],H.array[L+2]=ba[la[2]],H.array[L+3]=ea[la[0]],H.array[L+4]=ea[la[1]],H.array[L+5]=ea[la[2]],H.array[L+6]=ca[la[0]],H.array[L+7]=ca[la[1]],H.array[L+8]=ca[la[2]],H.array[L+9]=W[la[0]],H.array[L+10]=
W[la[1]],H.array[L+11]=W[la[2]],L+=12}}else if(4===H.size)if(void 0===H.boundTo||"vertices"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)N=xb[Ia[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+6]=ea.z,H.array[L+7]=ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,L+=12;R=0;for(O=Ha.length;R<O;R++)N=xb[Ha[R]],ba=H.value[N.a],ea=H.value[N.b],ca=H.value[N.c],
W=H.value[N.d],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+6]=ea.z,H.array[L+7]=ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,H.array[L+12]=W.x,H.array[L+13]=W.y,H.array[L+14]=W.z,H.array[L+15]=W.w,L+=16}else if("faces"===H.boundTo){R=0;for(O=Ia.length;R<O;R++)ca=ea=ba=Na=H.value[Ia[R]],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+
6]=ea.z,H.array[L+7]=ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,L+=12;R=0;for(O=Ha.length;R<O;R++)W=ca=ea=ba=Na=H.value[Ha[R]],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+6]=ea.z,H.array[L+7]=ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,H.array[L+12]=W.x,H.array[L+13]=W.y,H.array[L+14]=W.z,H.array[L+15]=W.w,L+=16}else if("faceVertices"===H.boundTo){R=0;for(O=
Ia.length;R<O;R++)Na=H.value[Ia[R]],ba=Na[0],ea=Na[1],ca=Na[2],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+6]=ea.z,H.array[L+7]=ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,L+=12;R=0;for(O=Ha.length;R<O;R++)Na=H.value[Ha[R]],ba=Na[0],ea=Na[1],ca=Na[2],W=Na[3],H.array[L]=ba.x,H.array[L+1]=ba.y,H.array[L+2]=ba.z,H.array[L+3]=ba.w,H.array[L+4]=ea.x,H.array[L+5]=ea.y,H.array[L+6]=ea.z,H.array[L+7]=
ea.w,H.array[L+8]=ca.x,H.array[L+9]=ca.y,H.array[L+10]=ca.z,H.array[L+11]=ca.w,H.array[L+12]=W.x,H.array[L+13]=W.y,H.array[L+14]=W.z,H.array[L+15]=W.w,L+=16}s.bindBuffer(s.ARRAY_BUFFER,H.buffer);s.bufferData(s.ARRAY_BUFFER,H.array,M)}V&&(delete K.__inittedArrays,delete K.__colorArray,delete K.__normalArray,delete K.__tangentArray,delete K.__uvArray,delete K.__uv2Array,delete K.__faceArray,delete K.__vertexArray,delete K.__lineArray,delete K.__skinIndexArray,delete K.__skinWeightArray)}}n.verticesNeedUpdate=
!1;n.morphTargetsNeedUpdate=!1;n.elementsNeedUpdate=!1;n.uvsNeedUpdate=!1;n.normalsNeedUpdate=!1;n.colorsNeedUpdate=!1;n.tangentsNeedUpdate=!1;n.buffersNeedUpdate=!1;u.attributes&&B(u)}else if(m instanceof THREE.Ribbon){u=e(m,n);q=u.attributes&&A(u);if(n.verticesNeedUpdate||n.colorsNeedUpdate||n.normalsNeedUpdate||q){var Nb=n,kc=s.DYNAMIC_DRAW,Sc=void 0,Rc=void 0,Tc=void 0,lc=void 0,Oa=void 0,mc=void 0,nc=void 0,bd=void 0,Gc=void 0,ub=void 0,Ic=void 0,Ta=void 0,Eb=void 0,zd=Nb.vertices,ud=Nb.colors,
vd=Nb.normals,Rd=zd.length,Xd=ud.length,Yd=vd.length,$c=Nb.__vertexArray,cd=Nb.__colorArray,dd=Nb.__normalArray,Zd=Nb.colorsNeedUpdate,Qd=Nb.normalsNeedUpdate,kd=Nb.__webglCustomAttributesList;if(Nb.verticesNeedUpdate){for(Sc=0;Sc<Rd;Sc++)lc=zd[Sc],Oa=3*Sc,$c[Oa]=lc.x,$c[Oa+1]=lc.y,$c[Oa+2]=lc.z;s.bindBuffer(s.ARRAY_BUFFER,Nb.__webglVertexBuffer);s.bufferData(s.ARRAY_BUFFER,$c,kc)}if(Zd){for(Rc=0;Rc<Xd;Rc++)mc=ud[Rc],Oa=3*Rc,cd[Oa]=mc.r,cd[Oa+1]=mc.g,cd[Oa+2]=mc.b;s.bindBuffer(s.ARRAY_BUFFER,Nb.__webglColorBuffer);
s.bufferData(s.ARRAY_BUFFER,cd,kc)}if(Qd){for(Tc=0;Tc<Yd;Tc++)nc=vd[Tc],Oa=3*Tc,dd[Oa]=nc.x,dd[Oa+1]=nc.y,dd[Oa+2]=nc.z;s.bindBuffer(s.ARRAY_BUFFER,Nb.__webglNormalBuffer);s.bufferData(s.ARRAY_BUFFER,dd,kc)}if(kd)for(bd=0,Gc=kd.length;bd<Gc;bd++)if(Ta=kd[bd],Ta.needsUpdate&&(void 0===Ta.boundTo||"vertices"===Ta.boundTo)){Oa=0;Ic=Ta.value.length;if(1===Ta.size)for(ub=0;ub<Ic;ub++)Ta.array[ub]=Ta.value[ub];else if(2===Ta.size)for(ub=0;ub<Ic;ub++)Eb=Ta.value[ub],Ta.array[Oa]=Eb.x,Ta.array[Oa+1]=Eb.y,
Oa+=2;else if(3===Ta.size)if("c"===Ta.type)for(ub=0;ub<Ic;ub++)Eb=Ta.value[ub],Ta.array[Oa]=Eb.r,Ta.array[Oa+1]=Eb.g,Ta.array[Oa+2]=Eb.b,Oa+=3;else for(ub=0;ub<Ic;ub++)Eb=Ta.value[ub],Ta.array[Oa]=Eb.x,Ta.array[Oa+1]=Eb.y,Ta.array[Oa+2]=Eb.z,Oa+=3;else if(4===Ta.size)for(ub=0;ub<Ic;ub++)Eb=Ta.value[ub],Ta.array[Oa]=Eb.x,Ta.array[Oa+1]=Eb.y,Ta.array[Oa+2]=Eb.z,Ta.array[Oa+3]=Eb.w,Oa+=4;s.bindBuffer(s.ARRAY_BUFFER,Ta.buffer);s.bufferData(s.ARRAY_BUFFER,Ta.array,kc)}}n.verticesNeedUpdate=!1;n.colorsNeedUpdate=
!1;n.normalsNeedUpdate=!1;u.attributes&&B(u)}else if(m instanceof THREE.Line){u=e(m,n);q=u.attributes&&A(u);if(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||q){var Lb=n,Yc=s.DYNAMIC_DRAW,Oc=void 0,Pc=void 0,Qc=void 0,Zc=void 0,Va=void 0,ad=void 0,td=Lb.vertices,wd=Lb.colors,xd=Lb.lineDistances,Sd=td.length,Td=wd.length,Ud=xd.length,ed=Lb.__vertexArray,fd=Lb.__colorArray,yd=Lb.__lineDistanceArray,Vd=Lb.colorsNeedUpdate,Wd=Lb.lineDistancesNeedUpdate,od=Lb.__webglCustomAttributesList,
hd=void 0,Kd=void 0,vb=void 0,Lc=void 0,Gb=void 0,Ua=void 0;if(Lb.verticesNeedUpdate){for(Oc=0;Oc<Sd;Oc++)Zc=td[Oc],Va=3*Oc,ed[Va]=Zc.x,ed[Va+1]=Zc.y,ed[Va+2]=Zc.z;s.bindBuffer(s.ARRAY_BUFFER,Lb.__webglVertexBuffer);s.bufferData(s.ARRAY_BUFFER,ed,Yc)}if(Vd){for(Pc=0;Pc<Td;Pc++)ad=wd[Pc],Va=3*Pc,fd[Va]=ad.r,fd[Va+1]=ad.g,fd[Va+2]=ad.b;s.bindBuffer(s.ARRAY_BUFFER,Lb.__webglColorBuffer);s.bufferData(s.ARRAY_BUFFER,fd,Yc)}if(Wd){for(Qc=0;Qc<Ud;Qc++)yd[Qc]=xd[Qc];s.bindBuffer(s.ARRAY_BUFFER,Lb.__webglLineDistanceBuffer);
s.bufferData(s.ARRAY_BUFFER,yd,Yc)}if(od)for(hd=0,Kd=od.length;hd<Kd;hd++)if(Ua=od[hd],Ua.needsUpdate&&(void 0===Ua.boundTo||"vertices"===Ua.boundTo)){Va=0;Lc=Ua.value.length;if(1===Ua.size)for(vb=0;vb<Lc;vb++)Ua.array[vb]=Ua.value[vb];else if(2===Ua.size)for(vb=0;vb<Lc;vb++)Gb=Ua.value[vb],Ua.array[Va]=Gb.x,Ua.array[Va+1]=Gb.y,Va+=2;else if(3===Ua.size)if("c"===Ua.type)for(vb=0;vb<Lc;vb++)Gb=Ua.value[vb],Ua.array[Va]=Gb.r,Ua.array[Va+1]=Gb.g,Ua.array[Va+2]=Gb.b,Va+=3;else for(vb=0;vb<Lc;vb++)Gb=
Ua.value[vb],Ua.array[Va]=Gb.x,Ua.array[Va+1]=Gb.y,Ua.array[Va+2]=Gb.z,Va+=3;else if(4===Ua.size)for(vb=0;vb<Lc;vb++)Gb=Ua.value[vb],Ua.array[Va]=Gb.x,Ua.array[Va+1]=Gb.y,Ua.array[Va+2]=Gb.z,Ua.array[Va+3]=Gb.w,Va+=4;s.bindBuffer(s.ARRAY_BUFFER,Ua.buffer);s.bufferData(s.ARRAY_BUFFER,Ua.array,Yc)}}n.verticesNeedUpdate=!1;n.colorsNeedUpdate=!1;n.lineDistancesNeedUpdate=!1;u.attributes&&B(u)}else if(m instanceof THREE.ParticleSystem){u=e(m,n);q=u.attributes&&A(u);if(n.verticesNeedUpdate||n.colorsNeedUpdate||
m.sortParticles||q){var cc=n,pd=s.DYNAMIC_DRAW,Vc=m,Hb=void 0,dc=void 0,ec=void 0,qa=void 0,fc=void 0,wc=void 0,id=cc.vertices,qd=id.length,rd=cc.colors,Ld=rd.length,Ec=cc.__vertexArray,Fc=cc.__colorArray,oc=cc.__sortArray,Md=cc.verticesNeedUpdate,Nd=cc.colorsNeedUpdate,pc=cc.__webglCustomAttributesList,Ub=void 0,Mc=void 0,Da=void 0,Vb=void 0,Ra=void 0,pa=void 0;if(Vc.sortParticles){Ab.copy(Sa);Ab.multiply(Vc.matrixWorld);for(Hb=0;Hb<qd;Hb++)ec=id[Hb],$a.copy(ec),$a.applyProjection(Ab),oc[Hb]=[$a.z,
Hb];oc.sort(r);for(Hb=0;Hb<qd;Hb++)ec=id[oc[Hb][1]],qa=3*Hb,Ec[qa]=ec.x,Ec[qa+1]=ec.y,Ec[qa+2]=ec.z;for(dc=0;dc<Ld;dc++)qa=3*dc,wc=rd[oc[dc][1]],Fc[qa]=wc.r,Fc[qa+1]=wc.g,Fc[qa+2]=wc.b;if(pc)for(Ub=0,Mc=pc.length;Ub<Mc;Ub++)if(pa=pc[Ub],void 0===pa.boundTo||"vertices"===pa.boundTo)if(qa=0,Vb=pa.value.length,1===pa.size)for(Da=0;Da<Vb;Da++)fc=oc[Da][1],pa.array[Da]=pa.value[fc];else if(2===pa.size)for(Da=0;Da<Vb;Da++)fc=oc[Da][1],Ra=pa.value[fc],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,qa+=2;else if(3===
pa.size)if("c"===pa.type)for(Da=0;Da<Vb;Da++)fc=oc[Da][1],Ra=pa.value[fc],pa.array[qa]=Ra.r,pa.array[qa+1]=Ra.g,pa.array[qa+2]=Ra.b,qa+=3;else for(Da=0;Da<Vb;Da++)fc=oc[Da][1],Ra=pa.value[fc],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,pa.array[qa+2]=Ra.z,qa+=3;else if(4===pa.size)for(Da=0;Da<Vb;Da++)fc=oc[Da][1],Ra=pa.value[fc],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,pa.array[qa+2]=Ra.z,pa.array[qa+3]=Ra.w,qa+=4}else{if(Md)for(Hb=0;Hb<qd;Hb++)ec=id[Hb],qa=3*Hb,Ec[qa]=ec.x,Ec[qa+1]=ec.y,Ec[qa+2]=ec.z;if(Nd)for(dc=
0;dc<Ld;dc++)wc=rd[dc],qa=3*dc,Fc[qa]=wc.r,Fc[qa+1]=wc.g,Fc[qa+2]=wc.b;if(pc)for(Ub=0,Mc=pc.length;Ub<Mc;Ub++)if(pa=pc[Ub],pa.needsUpdate&&(void 0===pa.boundTo||"vertices"===pa.boundTo))if(Vb=pa.value.length,qa=0,1===pa.size)for(Da=0;Da<Vb;Da++)pa.array[Da]=pa.value[Da];else if(2===pa.size)for(Da=0;Da<Vb;Da++)Ra=pa.value[Da],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,qa+=2;else if(3===pa.size)if("c"===pa.type)for(Da=0;Da<Vb;Da++)Ra=pa.value[Da],pa.array[qa]=Ra.r,pa.array[qa+1]=Ra.g,pa.array[qa+2]=Ra.b,
qa+=3;else for(Da=0;Da<Vb;Da++)Ra=pa.value[Da],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,pa.array[qa+2]=Ra.z,qa+=3;else if(4===pa.size)for(Da=0;Da<Vb;Da++)Ra=pa.value[Da],pa.array[qa]=Ra.x,pa.array[qa+1]=Ra.y,pa.array[qa+2]=Ra.z,pa.array[qa+3]=Ra.w,qa+=4}if(Md||Vc.sortParticles)s.bindBuffer(s.ARRAY_BUFFER,cc.__webglVertexBuffer),s.bufferData(s.ARRAY_BUFFER,Ec,pd);if(Nd||Vc.sortParticles)s.bindBuffer(s.ARRAY_BUFFER,cc.__webglColorBuffer),s.bufferData(s.ARRAY_BUFFER,Fc,pd);if(pc)for(Ub=0,Mc=pc.length;Ub<
Mc;Ub++)if(pa=pc[Ub],pa.needsUpdate||Vc.sortParticles)s.bindBuffer(s.ARRAY_BUFFER,pa.buffer),s.bufferData(s.ARRAY_BUFFER,pa.array,pd)}n.verticesNeedUpdate=!1;n.colorsNeedUpdate=!1;u.attributes&&B(u)}}};this.initMaterial=function(a,b,c,d){var e,f,l,p;a.addEventListener("dispose",yc);var m,n,r,t,q;a instanceof THREE.MeshDepthMaterial?q="depth":a instanceof THREE.MeshNormalMaterial?q="normal":a instanceof THREE.MeshBasicMaterial?q="basic":a instanceof THREE.MeshLambertMaterial?q="lambert":a instanceof
THREE.MeshPhongMaterial?q="phong":a instanceof THREE.LineBasicMaterial?q="basic":a instanceof THREE.LineDashedMaterial?q="dashed":a instanceof THREE.ParticleBasicMaterial&&(q="particle_basic");if(q){var u=THREE.ShaderLib[q];a.uniforms=THREE.UniformsUtils.clone(u.uniforms);a.vertexShader=u.vertexShader;a.fragmentShader=u.fragmentShader}var z,A,C;e=l=A=C=u=0;for(f=b.length;e<f;e++)z=b[e],z.onlyShadow||(z instanceof THREE.DirectionalLight&&l++,z instanceof THREE.PointLight&&A++,z instanceof THREE.SpotLight&&
C++,z instanceof THREE.HemisphereLight&&u++);e=l;f=A;l=C;p=u;u=z=0;for(C=b.length;u<C;u++)A=b[u],A.castShadow&&(A instanceof THREE.SpotLight&&z++,A instanceof THREE.DirectionalLight&&!A.shadowCascade&&z++);t=z;jc&&d&&d.useVertexTexture?r=1024:(b=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),b=Math.floor((b-20)/4),void 0!==d&&d instanceof THREE.SkinnedMesh&&(b=Math.min(d.bones.length,b),b<d.bones.length&&console.warn("WebGLRenderer: too many bones - "+d.bones.length+", this GPU supports just "+b+" (try OpenGL instead of ANGLE)")),
r=b);a:{C=a.fragmentShader;A=a.vertexShader;u=a.uniforms;b=a.attributes;z=a.defines;c={map:!!a.map,envMap:!!a.envMap,lightMap:!!a.lightMap,bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,specularMap:!!a.specularMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:a.sizeAttenuation,skinning:a.skinning,maxBones:r,useVertexTexture:jc&&d&&d.useVertexTexture,boneTextureWidth:d&&d.boneTextureWidth,boneTextureHeight:d&&d.boneTextureHeight,morphTargets:a.morphTargets,
morphNormals:a.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:e,maxPointLights:f,maxSpotLights:l,maxHemiLights:p,maxShadows:t,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:a.alphaTest,metal:a.metal,perPixel:a.perPixel,wrapAround:a.wrapAround,doubleSided:a.side===THREE.DoubleSide,flipSided:a.side===THREE.BackSide};var B,
E,D;d=[];q?d.push(q):(d.push(C),d.push(A));for(E in z)d.push(E),d.push(z[E]);for(B in c)d.push(B),d.push(c[B]);q=d.join();B=0;for(E=ga.length;B<E;B++)if(d=ga[B],d.code===q){d.usedTimes++;n=d.program;break a}B="SHADOWMAP_TYPE_BASIC";c.shadowMapType===THREE.PCFShadowMap?B="SHADOWMAP_TYPE_PCF":c.shadowMapType===THREE.PCFSoftShadowMap&&(B="SHADOWMAP_TYPE_PCF_SOFT");E=[];for(D in z)d=z[D],!1!==d&&(d="#define "+D+" "+d,E.push(d));d=E.join("\n");D=s.createProgram();E=["precision "+V+" float;",d,ic?"#define VERTEX_TEXTURES":
"",U.gammaInput?"#define GAMMA_INPUT":"",U.gammaOutput?"#define GAMMA_OUTPUT":"",U.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_HEMI_LIGHTS "+c.maxHemiLights,"#define MAX_SHADOWS "+c.maxShadows,"#define MAX_BONES "+c.maxBones,c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.bumpMap?"#define USE_BUMPMAP":
"",c.normalMap?"#define USE_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.vertexColors?"#define USE_COLOR":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.boneTextureWidth?"#define N_BONE_PIXEL_X "+c.boneTextureWidth.toFixed(1):"",c.boneTextureHeight?"#define N_BONE_PIXEL_Y "+c.boneTextureHeight.toFixed(1):"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals?"#define USE_MORPHNORMALS":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?
"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+B:"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");
B=["precision "+V+" float;",c.bumpMap||c.normalMap?"#extension GL_OES_standard_derivatives : enable":"",d,"#define MAX_DIR_LIGHTS "+c.maxDirLights,"#define MAX_POINT_LIGHTS "+c.maxPointLights,"#define MAX_SPOT_LIGHTS "+c.maxSpotLights,"#define MAX_HEMI_LIGHTS "+c.maxHemiLights,"#define MAX_SHADOWS "+c.maxShadows,c.alphaTest?"#define ALPHATEST "+c.alphaTest:"",U.gammaInput?"#define GAMMA_INPUT":"",U.gammaOutput?"#define GAMMA_OUTPUT":"",U.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",
c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.lightMap?"#define USE_LIGHTMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.vertexColors?"#define USE_COLOR":"",c.metal?"#define METAL":"",c.perPixel?"#define PHONG_PER_PIXEL":"",c.wrapAround?"#define WRAP_AROUND":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":
"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+B:"",c.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",c.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");E=O("vertex",E+A);B=O("fragment",B+C);s.attachShader(D,E);s.attachShader(D,B);s.linkProgram(D);s.getProgramParameter(D,s.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+s.getProgramParameter(D,s.VALIDATE_STATUS)+", gl error ["+
s.getError()+"]");s.deleteShader(B);s.deleteShader(E);D.uniforms={};D.attributes={};var F;B="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");c.useVertexTexture?B.push("boneTexture"):B.push("boneGlobalMatrices");for(F in u)B.push(F);F=B;B=0;for(E=F.length;B<E;B++)u=F[B],D.uniforms[u]=s.getUniformLocation(D,u);B="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(F=0;F<c.maxMorphTargets;F++)B.push("morphTarget"+
F);for(F=0;F<c.maxMorphNormals;F++)B.push("morphNormal"+F);for(n in b)B.push(n);n=B;F=0;for(b=n.length;F<b;F++)B=n[F],D.attributes[B]=s.getAttribLocation(D,B);D.id=va++;ga.push({program:D,code:q,usedTimes:1});U.info.memory.programs=ga.length;n=D}a.program=n;F=a.program.attributes;if(a.morphTargets)for(a.numSupportedMorphTargets=0,b="morphTarget",n=0;n<this.maxMorphTargets;n++)D=b+n,0<=F[D]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(a.numSupportedMorphNormals=0,b="morphNormal",n=0;n<this.maxMorphNormals;n++)D=
b+n,0<=F[D]&&a.numSupportedMorphNormals++;a.uniformsList=[];for(m in a.uniforms)a.uniformsList.push([a.uniforms[m],m])};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?s.disable(s.CULL_FACE):(b===THREE.FrontFaceDirectionCW?s.frontFace(s.CW):s.frontFace(s.CCW),a===THREE.CullFaceBack?s.cullFace(s.BACK):a===THREE.CullFaceFront?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK),s.enable(s.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;na!==
b&&(b?s.disable(s.CULL_FACE):s.enable(s.CULL_FACE),na=b);ha!==a&&(a?s.frontFace(s.CW):s.frontFace(s.CCW),ha=a)};this.setDepthTest=function(a){q!==a&&(a?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),q=a)};this.setDepthWrite=function(a){db!==a&&(s.depthMask(a),db=a)};this.setBlending=function(a,b,c,d){a!==ra&&(a===THREE.NoBlending?s.disable(s.BLEND):a===THREE.AdditiveBlending?(s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.SRC_ALPHA,s.ONE)):a===THREE.SubtractiveBlending?(s.enable(s.BLEND),
s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ZERO,s.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ZERO,s.SRC_COLOR)):a===THREE.CustomBlending?s.enable(s.BLEND):(s.enable(s.BLEND),s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA)),ra=a);if(a===THREE.CustomBlending){if(b!==za&&(s.blendEquation(Q(b)),za=b),c!==wa||d!==Aa)s.blendFunc(Q(c),Q(d)),wa=c,Aa=d}else Aa=
wa=za=null};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",$b),a.__webglTexture=s.createTexture(),U.info.memory.textures++);s.activeTexture(s.TEXTURE0+b);s.bindTexture(s.TEXTURE_2D,a.__webglTexture);s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,a.flipY);s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);s.pixelStorei(s.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=0===(c.width&c.width-1)&&0===(c.height&c.height-1),e=Q(a.format),
f=Q(a.type);fa(s.TEXTURE_2D,a,d);var l=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<l.length&&d){for(var p=0,m=l.length;p<m;p++)c=l[p],s.texImage2D(s.TEXTURE_2D,p,e,c.width,c.height,0,e,f,c.data);a.generateMipmaps=!1}else s.texImage2D(s.TEXTURE_2D,0,e,c.width,c.height,0,e,f,c.data);else if(a instanceof THREE.CompressedTexture)for(p=0,m=l.length;p<m;p++)c=l[p],s.compressedTexImage2D(s.TEXTURE_2D,p,e,c.width,c.height,0,c.data);else if(0<l.length&&d){p=0;for(m=l.length;p<m;p++)c=l[p],s.texImage2D(s.TEXTURE_2D,
p,e,e,f,c);a.generateMipmaps=!1}else s.texImage2D(s.TEXTURE_2D,0,e,e,f,a.image);a.generateMipmaps&&d&&s.generateMipmap(s.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else s.activeTexture(s.TEXTURE0+b),s.bindTexture(s.TEXTURE_2D,a.__webglTexture)};this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;if(a&&!a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.addEventListener("dispose",mc);a.__webglTexture=
s.createTexture();U.info.memory.textures++;var c=0===(a.width&a.width-1)&&0===(a.height&a.height-1),d=Q(a.format),e=Q(a.type);if(b){a.__webglFramebuffer=[];a.__webglRenderbuffer=[];s.bindTexture(s.TEXTURE_CUBE_MAP,a.__webglTexture);fa(s.TEXTURE_CUBE_MAP,a,c);for(var f=0;6>f;f++){a.__webglFramebuffer[f]=s.createFramebuffer();a.__webglRenderbuffer[f]=s.createRenderbuffer();s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d,a.width,a.height,0,d,e,null);var l=a,p=s.TEXTURE_CUBE_MAP_POSITIVE_X+f;s.bindFramebuffer(s.FRAMEBUFFER,
a.__webglFramebuffer[f]);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,p,l.__webglTexture,0);S(a.__webglRenderbuffer[f],a)}c&&s.generateMipmap(s.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=s.createFramebuffer(),a.__webglRenderbuffer=a.shareDepthFrom?a.shareDepthFrom.__webglRenderbuffer:s.createRenderbuffer(),s.bindTexture(s.TEXTURE_2D,a.__webglTexture),fa(s.TEXTURE_2D,a,c),s.texImage2D(s.TEXTURE_2D,0,d,a.width,a.height,0,d,e,null),d=s.TEXTURE_2D,s.bindFramebuffer(s.FRAMEBUFFER,a.__webglFramebuffer),
s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,d,a.__webglTexture,0),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,a.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a.__webglRenderbuffer):S(a.__webglRenderbuffer,a),c&&s.generateMipmap(s.TEXTURE_2D);b?s.bindTexture(s.TEXTURE_CUBE_MAP,null):s.bindTexture(s.TEXTURE_2D,null);s.bindRenderbuffer(s.RENDERBUFFER,
null);s.bindFramebuffer(s.FRAMEBUFFER,null)}a?(b=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,c=a.width,a=a.height,e=d=0):(b=null,c=Qb,a=Rb,d=tb,e=Pb);b!==Pa&&(s.bindFramebuffer(s.FRAMEBUFFER,b),s.viewport(d,e,c,a),Pa=b);hc=c;Yb=a};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;
a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;a.shareDepthFrom=this.shareDepthFrom;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);
THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};
THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=null};
THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];
this.material=this.color=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null};
THREE.GeometryUtils={merge:function(a,b,c){var d,e,f=a.vertices.length,l=b instanceof THREE.Mesh?b.geometry:b,m=a.vertices,n=l.vertices,p=a.faces,r=l.faces;a=a.faceVertexUvs[0];l=l.faceVertexUvs[0];void 0===c&&(c=0);b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,e=(new THREE.Matrix3).getNormalMatrix(d));b=0;for(var t=n.length;b<t;b++){var u=n[b].clone();d&&u.applyMatrix4(d);m.push(u)}b=0;for(t=r.length;b<t;b++){var u=r[b],z,E,C=u.vertexNormals,A=u.vertexColors;u instanceof
THREE.Face3?z=new THREE.Face3(u.a+f,u.b+f,u.c+f):u instanceof THREE.Face4&&(z=new THREE.Face4(u.a+f,u.b+f,u.c+f,u.d+f));z.normal.copy(u.normal);e&&z.normal.applyMatrix3(e).normalize();m=0;for(n=C.length;m<n;m++)E=C[m].clone(),e&&E.applyMatrix3(e).normalize(),z.vertexNormals.push(E);z.color.copy(u.color);m=0;for(n=A.length;m<n;m++)E=A[m],z.vertexColors.push(E.clone());z.materialIndex=u.materialIndex+c;z.centroid.copy(u.centroid);d&&z.centroid.applyMatrix4(d);p.push(z)}b=0;for(t=l.length;b<t;b++){c=
l[b];d=[];m=0;for(n=c.length;m<n;m++)d.push(new THREE.Vector2(c[m].x,c[m].y));a.push(d)}},removeMaterials:function(a,b){for(var c={},d=0,e=b.length;d<e;d++)c[b[d]]=!0;for(var f,l=[],d=0,e=a.faces.length;d<e;d++)f=a.faces[d],f.materialIndex in c||l.push(f);a.faces=l},randomPointInTriangle:function(a,b,c){var d,e,f,l=new THREE.Vector3,m=THREE.GeometryUtils.__v1;d=THREE.GeometryUtils.random();e=THREE.GeometryUtils.random();1<d+e&&(d=1-d,e=1-e);f=1-d-e;l.copy(a);l.multiplyScalar(d);m.copy(b);m.multiplyScalar(e);
l.add(m);m.copy(c);m.multiplyScalar(f);l.add(m);return l},randomPointInFace:function(a,b,c){var d,e,f;if(a instanceof THREE.Face3)return d=b.vertices[a.a],e=b.vertices[a.b],f=b.vertices[a.c],THREE.GeometryUtils.randomPointInTriangle(d,e,f);if(a instanceof THREE.Face4){d=b.vertices[a.a];e=b.vertices[a.b];f=b.vertices[a.c];b=b.vertices[a.d];var l;c?a._area1&&a._area2?(c=a._area1,l=a._area2):(c=THREE.GeometryUtils.triangleArea(d,e,b),l=THREE.GeometryUtils.triangleArea(e,f,b),a._area1=c,a._area2=l):(c=
THREE.GeometryUtils.triangleArea(d,e,b),l=THREE.GeometryUtils.triangleArea(e,f,b));return THREE.GeometryUtils.random()*(c+l)<c?THREE.GeometryUtils.randomPointInTriangle(d,e,b):THREE.GeometryUtils.randomPointInTriangle(e,f,b)}},randomPointsInGeometry:function(a,b){function c(a){function b(c,d){if(d<c)return c;var e=c+Math.floor((d-c)/2);return p[e]>a?b(c,e-1):p[e]<a?b(e+1,d):e}return b(0,p.length-1)}var d,e,f=a.faces,l=a.vertices,m=f.length,n=0,p=[],r,t,u,z;for(e=0;e<m;e++)d=f[e],d instanceof THREE.Face3?
(r=l[d.a],t=l[d.b],u=l[d.c],d._area=THREE.GeometryUtils.triangleArea(r,t,u)):d instanceof THREE.Face4&&(r=l[d.a],t=l[d.b],u=l[d.c],z=l[d.d],d._area1=THREE.GeometryUtils.triangleArea(r,t,z),d._area2=THREE.GeometryUtils.triangleArea(t,u,z),d._area=d._area1+d._area2),n+=d._area,p[e]=n;d=[];for(e=0;e<b;e++)l=THREE.GeometryUtils.random()*n,l=c(l),d[e]=THREE.GeometryUtils.randomPointInFace(f[l],a,!0);return d},triangleArea:function(a,b,c){var d=THREE.GeometryUtils.__v1,e=THREE.GeometryUtils.__v2;d.subVectors(b,
a);e.subVectors(c,a);d.cross(e);return 0.5*d.length()},center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.addVectors(b.min,b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},normalizeUVs:function(a){a=a.faceVertexUvs[0];for(var b=0,c=a.length;b<c;b++)for(var d=a[b],e=0,f=d.length;e<f;e++)1!==d[e].x&&(d[e].x-=Math.floor(d[e].x)),1!==d[e].y&&(d[e].y-=Math.floor(d[e].y))},triangulateQuads:function(a){var b,
c,d,e,f=[],l=[],m=[];b=0;for(c=a.faceUvs.length;b<c;b++)l[b]=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)m[b]=[];b=0;for(c=a.faces.length;b<c;b++)if(d=a.faces[b],d instanceof THREE.Face4){e=d.a;var n=d.b,p=d.c,r=d.d,t=new THREE.Face3,u=new THREE.Face3;t.color.copy(d.color);u.color.copy(d.color);t.materialIndex=d.materialIndex;u.materialIndex=d.materialIndex;t.a=e;t.b=n;t.c=r;u.a=n;u.b=p;u.c=r;4===d.vertexColors.length&&(t.vertexColors[0]=d.vertexColors[0].clone(),t.vertexColors[1]=d.vertexColors[1].clone(),
t.vertexColors[2]=d.vertexColors[3].clone(),u.vertexColors[0]=d.vertexColors[1].clone(),u.vertexColors[1]=d.vertexColors[2].clone(),u.vertexColors[2]=d.vertexColors[3].clone());f.push(t,u);d=0;for(e=a.faceVertexUvs.length;d<e;d++)a.faceVertexUvs[d].length&&(t=a.faceVertexUvs[d][b],n=t[1],p=t[2],r=t[3],t=[t[0].clone(),n.clone(),r.clone()],n=[n.clone(),p.clone(),r.clone()],m[d].push(t,n));d=0;for(e=a.faceUvs.length;d<e;d++)a.faceUvs[d].length&&(n=a.faceUvs[d][b],l[d].push(n,n))}else{f.push(d);d=0;for(e=
a.faceUvs.length;d<e;d++)l[d].push(a.faceUvs[d][b]);d=0;for(e=a.faceVertexUvs.length;d<e;d++)m[d].push(a.faceVertexUvs[d][b])}a.faces=f;a.faceUvs=l;a.faceVertexUvs=m;a.computeCentroids();a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()},setMaterialIndex:function(a,b,c,d){a=a.faces;d=d||a.length-1;for(c=c||0;c<=d;c++)a[c].materialIndex=b}};THREE.GeometryUtils.random=THREE.Math.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;THREE.GeometryUtils.__v2=new THREE.Vector3;
THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(a,b,c,d){var e=new Image,f=new THREE.Texture(e,b);b=new THREE.ImageLoader;b.addEventListener("load",function(a){f.image=a.content;f.needsUpdate=!0;c&&c(f)});b.addEventListener("error",function(a){d&&d(a.message)});b.crossOrigin=this.crossOrigin;b.load(a,e);f.sourceFile=a;return f},loadCompressedTexture:function(a,b,c,d){var e=new THREE.CompressedTexture;e.mapping=b;var f=new XMLHttpRequest;f.onload=function(){var a=THREE.ImageUtils.parseDDS(f.response,
!0);e.format=a.format;e.mipmaps=a.mipmaps;e.image.width=a.width;e.image.height=a.height;e.generateMipmaps=!1;e.needsUpdate=!0;c&&c(e)};f.onerror=d;f.open("GET",a,!0);f.responseType="arraybuffer";f.send(null);return e},loadTextureCube:function(a,b,c,d){var e=[];e.loadCount=0;var f=new THREE.Texture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;b=0;for(var l=a.length;b<l;++b){var m=new Image;e[b]=m;m.onload=function(){e.loadCount+=1;6===e.loadCount&&(f.needsUpdate=!0,c&&c(f))};m.onerror=d;m.crossOrigin=
this.crossOrigin;m.src=a[b]}return f},loadCompressedTextureCube:function(a,b,c,d){var e=[];e.loadCount=0;var f=new THREE.CompressedTexture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;b=function(a,b){return function(){var d=THREE.ImageUtils.parseDDS(a.response,!0);b.format=d.format;b.mipmaps=d.mipmaps;b.width=d.width;b.height=d.height;e.loadCount+=1;6===e.loadCount&&(f.format=d.format,f.needsUpdate=!0,c&&c(f))}};if(a instanceof Array)for(var l=0,m=a.length;l<m;++l){var n={};
e[l]=n;var p=new XMLHttpRequest;p.onload=b(p,n);p.onerror=d;n=a[l];p.open("GET",n,!0);p.responseType="arraybuffer";p.send(null)}else p=new XMLHttpRequest,p.onload=function(){var a=THREE.ImageUtils.parseDDS(p.response,!0);if(a.isCubemap){for(var b=a.mipmaps.length/a.mipmapCount,d=0;d<b;d++){e[d]={mipmaps:[]};for(var l=0;l<a.mipmapCount;l++)e[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+l]),e[d].format=a.format,e[d].width=a.width,e[d].height=a.height}f.format=a.format;f.needsUpdate=!0;c&&c(f)}},p.onerror=
d,p.open("GET",a,!0),p.responseType="arraybuffer",p.send(null);return f},parseDDS:function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var d={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},e=c("DXT1"),f=c("DXT3"),l=c("DXT5"),m=new Int32Array(a,0,31);if(542327876!==m[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),d;if(!m[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),
d;var n=m[21];switch(n){case e:e=8;d.format=THREE.RGB_S3TC_DXT1_Format;break;case f:e=16;d.format=THREE.RGBA_S3TC_DXT3_Format;break;case l:e=16;d.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(n&255,n>>8&255,n>>16&255,n>>24&255)),d}d.mipmapCount=1;m[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,m[7]));d.isCubemap=m[28]&512?!0:!1;d.width=m[4];d.height=m[3];for(var m=m[1]+4,f=d.width,l=d.height,n=d.isCubemap?
6:1,p=0;p<n;p++){for(var r=0;r<d.mipmapCount;r++){var t=Math.max(4,f)/4*Math.max(4,l)/4*e,u={data:new Uint8Array(a,m,t),width:f,height:l};d.mipmaps.push(u);m+=t;f=Math.max(0.5*f,1);l=Math.max(0.5*l,1)}f=d.width;l=d.height}return d},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var d=a.width,e=a.height,f=document.createElement("canvas");f.width=d;f.height=e;var l=f.getContext("2d");l.drawImage(a,0,0);for(var m=l.getImageData(0,
0,d,e).data,n=l.createImageData(d,e),p=n.data,r=0;r<d;r++)for(var t=0;t<e;t++){var u=0>t-1?0:t-1,z=t+1>e-1?e-1:t+1,E=0>r-1?0:r-1,C=r+1>d-1?d-1:r+1,A=[],B=[0,0,m[4*(t*d+r)]/255*b];A.push([-1,0,m[4*(t*d+E)]/255*b]);A.push([-1,-1,m[4*(u*d+E)]/255*b]);A.push([0,-1,m[4*(u*d+r)]/255*b]);A.push([1,-1,m[4*(u*d+C)]/255*b]);A.push([1,0,m[4*(t*d+C)]/255*b]);A.push([1,1,m[4*(z*d+C)]/255*b]);A.push([0,1,m[4*(z*d+r)]/255*b]);A.push([-1,1,m[4*(z*d+E)]/255*b]);u=[];E=A.length;for(z=0;z<E;z++){var C=A[z],F=A[(z+1)%
E],C=[C[0]-B[0],C[1]-B[1],C[2]-B[2]],F=[F[0]-B[0],F[1]-B[1],F[2]-B[2]];u.push(c([C[1]*F[2]-C[2]*F[1],C[2]*F[0]-C[0]*F[2],C[0]*F[1]-C[1]*F[0]]))}A=[0,0,0];for(z=0;z<u.length;z++)A[0]+=u[z][0],A[1]+=u[z][1],A[2]+=u[z][2];A[0]/=u.length;A[1]/=u.length;A[2]/=u.length;B=4*(t*d+r);p[B]=255*((A[0]+1)/2)|0;p[B+1]=255*((A[1]+1)/2)|0;p[B+2]=255*A[2]|0;p[B+3]=255}l.putImageData(n,0,0);return f},generateDataTexture:function(a,b,c){var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),l=Math.floor(255*c.g);c=
Math.floor(255*c.b);for(var m=0;m<d;m++)e[3*m]=f,e[3*m+1]=l,e[3*m+2]=c;a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,d=0,e=
String(a).split(""),f=e.length,l=[];for(a=0;a<f;a++){var m=new THREE.Path,m=this.extractGlyphPoints(e[a],b,c,d,m),d=d+m.offset;l.push(m.path)}return{paths:l,offset:d/2}},extractGlyphPoints:function(a,b,c,d,e){var f=[],l,m,n,p,r,t,u,z,E,C,A,B=b.glyphs[a]||b.glyphs["?"];if(B){if(B.o)for(b=B._cachedOutline||(B._cachedOutline=B.o.split(" ")),p=b.length,a=0;a<p;)switch(n=b[a++],n){case "m":n=b[a++]*c+d;r=b[a++]*c;e.moveTo(n,r);break;case "l":n=b[a++]*c+d;r=b[a++]*c;e.lineTo(n,r);break;case "q":n=b[a++]*
c+d;r=b[a++]*c;z=b[a++]*c+d;E=b[a++]*c;e.quadraticCurveTo(z,E,n,r);if(l=f[f.length-1])for(t=l.x,u=l.y,l=1,m=this.divisions;l<=m;l++){var F=l/m;THREE.Shape.Utils.b2(F,t,z,n);THREE.Shape.Utils.b2(F,u,E,r)}break;case "b":if(n=b[a++]*c+d,r=b[a++]*c,z=b[a++]*c+d,E=b[a++]*-c,C=b[a++]*c+d,A=b[a++]*-c,e.bezierCurveTo(n,r,z,E,C,A),l=f[f.length-1])for(t=l.x,u=l.y,l=1,m=this.divisions;l<=m;l++)F=l/m,THREE.Shape.Utils.b3(F,t,z,C,n),THREE.Shape.Utils.b3(F,u,E,A,r)}return{offset:B.ha*c,path:e}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",e=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=e;THREE.FontUtils.style=f;c=THREE.FontUtils.drawText(a).paths;d=[];e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,e=0,f=b-1,l=0;l<b;f=l++)e+=a[f].x*a[l].y-a[l].x*a[f].y;return 0.5*e};a.Triangulate=function(a,d){var e=a.length;if(3>e)return null;var f=[],l=[],m=[],n,p,r;if(0<b(a))for(p=0;p<e;p++)l[p]=p;else for(p=0;p<e;p++)l[p]=e-1-p;var t=2*e;for(p=e-1;2<e;){if(0>=t--){console.log("Warning, unable to triangulate polygon!");break}n=p;e<=n&&(n=0);p=n+1;e<=p&&(p=0);r=p+1;e<=r&&(r=0);var u;a:{var z=u=void 0,E=void 0,C=void 0,A=void 0,B=void 0,F=void 0,I=void 0,J=
void 0,z=a[l[n]].x,E=a[l[n]].y,C=a[l[p]].x,A=a[l[p]].y,B=a[l[r]].x,F=a[l[r]].y;if(1E-10>(C-z)*(F-E)-(A-E)*(B-z))u=!1;else{var D=void 0,P=void 0,M=void 0,G=void 0,K=void 0,Y=void 0,T=void 0,O=void 0,fa=void 0,S=void 0,fa=O=T=J=I=void 0,D=B-C,P=F-A,M=z-B,G=E-F,K=C-z,Y=A-E;for(u=0;u<e;u++)if(u!==n&&(u!==p&&u!==r)&&(I=a[l[u]].x,J=a[l[u]].y,T=I-z,O=J-E,fa=I-C,S=J-A,I-=B,J-=F,fa=D*S-P*fa,T=K*O-Y*T,O=M*J-G*I,0<=fa&&0<=O&&0<=T)){u=!1;break a}u=!0}}if(u){f.push([a[l[n]],a[l[p]],a[l[r]]]);m.push([l[n],l[p],
l[r]]);n=p;for(r=p+1;r<e;n++,r++)l[n]=l[r];e--;t=2*e}}return d?m:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};
THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};
THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,f=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),f+=c.distanceTo(d),b.push(f),d=c;return this.cacheArcLengths=b};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};
THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,e=c.length,f;f=b?b:a*c[e-1];for(var l=0,m=e-1,n;l<=m;)if(d=Math.floor(l+(m-l)/2),n=c[d]-f,0>n)l=d+1;else if(0<n)m=d-1;else{m=d;break}d=m;if(c[d]==f)return d/(e-1);l=c[d];return c=(d+(f-l)/(c[d+1]-l))/(e-1)};THREE.Curve.prototype.getTangent=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};
THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(b,a)};
THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);b=new THREE.Vector2(b,a);b.normalize();return b};THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.CubicBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};THREE.CubicBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=new THREE.Vector2(b,a);b.normalize();return b};
THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(a){var b=new THREE.Vector2,c=[],d=this.points,e;e=(d.length-1)*a;a=Math.floor(e);e-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>d.length-2?d.length-1:a+1;c[3]=a>d.length-3?d.length-1:a+2;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);return b};
THREE.EllipseCurve=function(a,b,c,d,e,f,l){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=e;this.aEndAngle=f;this.aClockwise=l};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;this.aClockwise||(a=1-a);b=this.aStartAngle+a*b;a=this.aX+this.xRadius*Math.cos(b);b=this.aY+this.yRadius*Math.sin(b);return new THREE.Vector2(a,b)};
THREE.ArcCurve=function(a,b,c,d,e,f){THREE.EllipseCurve.call(this,a,b,c,c,d,e,f)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a,b,c,d,e){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){a=0.5*(c-a);d=0.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}};
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=b;return a};THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b,c;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);a=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(b,c,a)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b,c;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);a=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(b,c,a)});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e;a*=d.length-1;e=Math.floor(a);a-=e;c[0]=0==e?e:e-1;c[1]=e;c[2]=e>d.length-2?d.length-1:e+1;c[3]=e>d.length-3?d.length-1:e+2;e=d[c[0]];var f=d[c[1]],l=d[c[2]],c=d[c[3]];b.x=THREE.Curve.Utils.interpolate(e.x,f.x,l.x,c.x,a);b.y=THREE.Curve.Utils.interpolate(e.y,f.y,l.y,c.y,a);b.z=THREE.Curve.Utils.interpolate(e.z,f.z,l.z,c.z,a);return b});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,e;e=(d.length-0)*a;a=Math.floor(e);e-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;c[0]=(a-1)%d.length;c[1]=a%d.length;c[2]=(a+1)%d.length;c[3]=(a+2)%d.length;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,e);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,e);b.z=THREE.Curve.Utils.interpolate(d[c[0]].z,
d[c[1]].z,d[c[2]].z,d[c[3]].z,e);return b});THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};
THREE.CurvePath.prototype.getPoint=function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,e,f,l;b=c=Number.NEGATIVE_INFINITY;e=f=Number.POSITIVE_INFINITY;var m,n,p,r,t=a[0]instanceof THREE.Vector3;r=t?new THREE.Vector3:new THREE.Vector2;n=0;for(p=a.length;n<p;n++)m=a[n],m.x>b?b=m.x:m.x<e&&(e=m.x),m.y>c?c=m.y:m.y<f&&(f=m.y),t&&(m.z>d?d=m.z:m.z<l&&(l=m.z)),r.add(m);a={minX:e,minY:f,maxX:b,maxY:c,centroid:r.divideScalar(p)};t&&(a.maxZ=d,a.minZ=l);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,a[c].z||0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,e,f,l,m,n;d=0;for(e=a.length;d<e;d++)f=a[d],l=f.x,m=f.y,n=l/c.maxX,n=b.getUtoTmapping(n,l),l=b.getPoint(n),m=b.getNormalVector(n).multiplyScalar(m),f.x=l.x+m.x,f.y=l.y+m.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};
THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=new THREE.QuadraticBezierCurve(new THREE.Vector2(f[f.length-2],f[f.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(f);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:e})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f){var l=Array.prototype.slice.call(arguments),m=this.actions[this.actions.length-1].args,m=new THREE.CubicBezierCurve(new THREE.Vector2(m[m.length-2],m[m.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,f));this.curves.push(m);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:l})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};THREE.Path.prototype.arc=function(a,b,c,d,e,f){var l=this.actions[this.actions.length-1].args;this.absarc(a+l[l.length-2],b+l[l.length-1],c,d,e,f)};
THREE.Path.prototype.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)};THREE.Path.prototype.ellipse=function(a,b,c,d,e,f,l){var m=this.actions[this.actions.length-1].args;this.absellipse(a+m[m.length-2],b+m[m.length-1],c,d,e,f,l)};THREE.Path.prototype.absellipse=function(a,b,c,d,e,f,l){var m=Array.prototype.slice.call(arguments),n=new THREE.EllipseCurve(a,b,c,d,e,f,l);this.curves.push(n);n=n.getPoint(l?1:0);m.push(n.x);m.push(n.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:m})};
THREE.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;d<a;d++)c.push(this.getPoint(d/a));return c};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c=[],d,e,f,l,m,n,p,r,t,u,z,E,C;d=0;for(e=this.actions.length;d<e;d++)switch(f=this.actions[d],l=f.action,f=f.args,l){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:m=f[2];n=f[3];t=f[0];u=f[1];0<c.length?(l=c[c.length-1],z=l.x,
E=l.y):(l=this.actions[d-1].args,z=l[l.length-2],E=l[l.length-1]);for(f=1;f<=a;f++)C=f/a,l=THREE.Shape.Utils.b2(C,z,t,m),C=THREE.Shape.Utils.b2(C,E,u,n),c.push(new THREE.Vector2(l,C));break;case THREE.PathActions.BEZIER_CURVE_TO:m=f[4];n=f[5];t=f[0];u=f[1];p=f[2];r=f[3];0<c.length?(l=c[c.length-1],z=l.x,E=l.y):(l=this.actions[d-1].args,z=l[l.length-2],E=l[l.length-1]);for(f=1;f<=a;f++)C=f/a,l=THREE.Shape.Utils.b3(C,z,t,p,m),C=THREE.Shape.Utils.b3(C,E,u,r,n),c.push(new THREE.Vector2(l,C));break;case THREE.PathActions.CSPLINE_THRU:l=
this.actions[d-1].args;C=[new THREE.Vector2(l[l.length-2],l[l.length-1])];l=a*f[0].length;C=C.concat(f[0]);C=new THREE.SplineCurve(C);for(f=1;f<=l;f++)c.push(C.getPointAt(f/l));break;case THREE.PathActions.ARC:m=f[0];n=f[1];u=f[2];p=f[3];l=f[4];t=!!f[5];z=l-p;E=2*a;for(f=1;f<=E;f++)C=f/E,t||(C=1-C),C=p+C*z,l=m+u*Math.cos(C),C=n+u*Math.sin(C),c.push(new THREE.Vector2(l,C));break;case THREE.PathActions.ELLIPSE:for(m=f[0],n=f[1],u=f[2],r=f[3],p=f[4],l=f[5],t=!!f[6],z=l-p,E=2*a,f=1;f<=E;f++)C=f/E,t||
(C=1-C),C=p+C*z,l=m+u*Math.cos(C),C=n+r*Math.sin(C),c.push(new THREE.Vector2(l,C))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(){var a,b,c,d,e=[],f=new THREE.Path;a=0;for(b=this.actions.length;a<b;a++)c=this.actions[a],d=c.args,c=c.action,c==THREE.PathActions.MOVE_TO&&0!=f.actions.length&&(e.push(f),f=new THREE.Path),f[c].apply(f,d);0!=f.actions.length&&e.push(f);if(0==e.length)return[];var l;d=[];a=!THREE.Shape.Utils.isClockWise(e[0].getPoints());if(1==e.length)return f=e[0],l=new THREE.Shape,l.actions=f.actions,l.curves=f.curves,d.push(l),d;if(a)for(l=new THREE.Shape,a=0,b=e.length;a<
b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(l.actions=f.actions,l.curves=f.curves,d.push(l),l=new THREE.Shape):l.holes.push(f);else{a=0;for(b=e.length;a<b;a++)f=e[a],THREE.Shape.Utils.isClockWise(f.getPoints())?(l&&d.push(l),l=new THREE.Shape,l.actions=f.actions,l.curves=f.curves):l.holes.push(f);d.push(l)}return d};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);
THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};
THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={removeHoles:function(a,b){var c=a.concat(),d=c.concat(),e,f,l,m,n,p,r,t,u,z,E=[];for(n=0;n<b.length;n++){p=b[n];Array.prototype.push.apply(d,p);f=Number.POSITIVE_INFINITY;for(e=0;e<p.length;e++)for(u=p[e],z=[],t=0;t<c.length;t++)r=c[t],r=u.distanceToSquared(r),z.push(r),r<f&&(f=r,l=e,m=t);e=0<=m-1?m-1:c.length-1;f=0<=l-1?l-1:p.length-1;var C=[p[l],c[m],c[e]];t=THREE.FontUtils.Triangulate.area(C);var A=[p[l],p[f],c[m]];u=THREE.FontUtils.Triangulate.area(A);z=m;r=l;m+=1;l+=-1;0>m&&
(m+=c.length);m%=c.length;0>l&&(l+=p.length);l%=p.length;e=0<=m-1?m-1:c.length-1;f=0<=l-1?l-1:p.length-1;C=[p[l],c[m],c[e]];C=THREE.FontUtils.Triangulate.area(C);A=[p[l],p[f],c[m]];A=THREE.FontUtils.Triangulate.area(A);t+u>C+A&&(m=z,l=r,0>m&&(m+=c.length),m%=c.length,0>l&&(l+=p.length),l%=p.length,e=0<=m-1?m-1:c.length-1,f=0<=l-1?l-1:p.length-1);t=c.slice(0,m);u=c.slice(m);z=p.slice(l);r=p.slice(0,l);f=[p[l],p[f],c[m]];E.push([p[l],c[m],c[e]]);E.push(f);c=t.concat(z).concat(r).concat(u)}return{shape:c,
isolatedPts:E,allpoints:d}},triangulateShape:function(a,b){var c=THREE.Shape.Utils.removeHoles(a,b),d=c.allpoints,e=c.isolatedPts,c=THREE.FontUtils.Triangulate(c.shape,!1),f,l,m,n,p={};f=0;for(l=d.length;f<l;f++)n=d[f].x+":"+d[f].y,void 0!==p[n]&&console.log("Duplicate point",n),p[n]=f;f=0;for(l=c.length;f<l;f++)for(m=c[f],d=0;3>d;d++)n=m[d].x+":"+m[d].y,n=p[n],void 0!==n&&(m[d]=n);f=0;for(l=e.length;f<l;f++)for(m=e[f],d=0;3>d;d++)n=m[d].x+":"+m[d].y,n=p[n],void 0!==n&&(m[d]=n);return c.concat(e)},
isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+
this.b3p3(a,e)}};
THREE.AnimationHandler=function(){var a=[],b={},c={update:function(b){for(var c=0;c<a.length;c++)a[c].update(b)},addToUpdate:function(b){-1===a.indexOf(b)&&a.push(b)},removeFromUpdate:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},add:function(a){void 0!==b[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");b[a.name]=a;if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var d=0;d<a.hierarchy[c].keys.length;d++)if(0>a.hierarchy[c].keys[d].time&&
(a.hierarchy[c].keys[d].time=0),void 0!==a.hierarchy[c].keys[d].rot&&!(a.hierarchy[c].keys[d].rot instanceof THREE.Quaternion)){var m=a.hierarchy[c].keys[d].rot;a.hierarchy[c].keys[d].rot=new THREE.Quaternion(m[0],m[1],m[2],m[3])}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){m={};for(d=0;d<a.hierarchy[c].keys.length;d++)for(var n=0;n<a.hierarchy[c].keys[d].morphTargets.length;n++){var p=a.hierarchy[c].keys[d].morphTargets[n];m[p]=-1}a.hierarchy[c].usedMorphTargets=m;
for(d=0;d<a.hierarchy[c].keys.length;d++){var r={};for(p in m){for(n=0;n<a.hierarchy[c].keys[d].morphTargets.length;n++)if(a.hierarchy[c].keys[d].morphTargets[n]===p){r[p]=a.hierarchy[c].keys[d].morphTargetsInfluences[n];break}n===a.hierarchy[c].keys[d].morphTargets.length&&(r[p]=0)}a.hierarchy[c].keys[d].morphTargetsInfluences=r}}for(d=1;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].time===a.hierarchy[c].keys[d-1].time&&(a.hierarchy[c].keys.splice(d,1),d--);for(d=0;d<a.hierarchy[c].keys.length;d++)a.hierarchy[c].keys[d].index=
d}d=parseInt(a.length*a.fps,10);a.JIT={};a.JIT.hierarchy=[];for(c=0;c<a.hierarchy.length;c++)a.JIT.hierarchy.push(Array(d));a.initialized=!0}},get:function(a){if("string"===typeof a){if(b[a])return b[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(a){var b=[];if(a instanceof THREE.SkinnedMesh)for(var c=0;c<a.bones.length;c++)b.push(a.bones[c]);else d(a,b);return b}},d=function(a,b){b.push(a);for(var c=0;c<a.children.length;c++)d(a.children[c],
b)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();THREE.Animation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==c?c:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};
THREE.Animation.prototype.play=function(a,b){if(!1===this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;var c,d=this.hierarchy.length,e;for(c=0;c<d;c++){e=this.hierarchy[c];this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(e.useQuaternion=!0);e.matrixAutoUpdate=!0;void 0===e.animationCache&&(e.animationCache={},e.animationCache.prevKey={pos:0,rot:0,scl:0},e.animationCache.nextKey={pos:0,rot:0,scl:0},e.animationCache.originalMatrix=e instanceof
THREE.Bone?e.skinMatrix:e.matrix);var f=e.animationCache.prevKey;e=e.animationCache.nextKey;f.pos=this.data.hierarchy[c].keys[0];f.rot=this.data.hierarchy[c].keys[0];f.scl=this.data.hierarchy[c].keys[0];e.pos=this.getNextKeyWith("pos",c,1);e.rot=this.getNextKeyWith("rot",c,1);e.scl=this.getNextKeyWith("scl",c,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};
THREE.Animation.prototype.update=function(a){if(!1!==this.isPlaying){var b=["pos","rot","scl"],c,d,e,f,l,m,n,p,r;r=this.currentTime+=a*this.timeScale;p=this.currentTime%=this.data.length;parseInt(Math.min(p*this.data.fps,this.data.length*this.data.fps),10);for(var t=0,u=this.hierarchy.length;t<u;t++){a=this.hierarchy[t];n=a.animationCache;for(var z=0;3>z;z++){c=b[z];l=n.prevKey[c];m=n.nextKey[c];if(m.time<=r){if(p<r)if(this.loop)for(l=this.data.hierarchy[t].keys[0],m=this.getNextKeyWith(c,t,1);m.time<
p;)l=m,m=this.getNextKeyWith(c,t,m.index+1);else{this.stop();return}else{do l=m,m=this.getNextKeyWith(c,t,m.index+1);while(m.time<p)}n.prevKey[c]=l;n.nextKey[c]=m}a.matrixAutoUpdate=!0;a.matrixWorldNeedsUpdate=!0;d=(p-l.time)/(m.time-l.time);e=l[c];f=m[c];if(0>d||1<d)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+d+" on bone "+t),d=0>d?0:1;if("pos"===c)if(c=a.position,this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+
(f[2]-e[2])*d;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=this.getPrevKeyWith("pos",t,l.index-1).pos,this.points[1]=e,this.points[2]=f,this.points[3]=this.getNextKeyWith("pos",t,m.index+1).pos,d=0.33*d+0.33,e=this.interpolateCatmullRom(this.points,d),c.x=e[0],c.y=e[1],c.z=e[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(d=this.interpolateCatmullRom(this.points,1.01*d),
this.target.set(d[0],d[1],d[2]),this.target.sub(c),this.target.y=0,this.target.normalize(),d=Math.atan2(this.target.x,this.target.z),a.rotation.set(0,d,0))}else"rot"===c?THREE.Quaternion.slerp(e,f,a.quaternion,d):"scl"===c&&(c=a.scale,c.x=e[0]+(f[0]-e[0])*d,c.y=e[1]+(f[1]-e[1])*d,c.z=e[2]+(f[2]-e[2])*d)}}}};
THREE.Animation.prototype.interpolateCatmullRom=function(a,b){var c=[],d=[],e,f,l,m,n,p;e=(a.length-1)*b;f=Math.floor(e);e-=f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>a.length-2?f:f+1;c[3]=f>a.length-3?f:f+2;f=a[c[0]];m=a[c[1]];n=a[c[2]];p=a[c[3]];c=e*e;l=e*c;d[0]=this.interpolate(f[0],m[0],n[0],p[0],e,c,l);d[1]=this.interpolate(f[1],m[1],n[1],p[1],e,c,l);d[2]=this.interpolate(f[2],m[2],n[2],p[2],e,c,l);return d};
THREE.Animation.prototype.interpolate=function(a,b,c,d,e,f,l){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*l+(-3*(b-c)-2*a-d)*f+a*e+b};THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]};
THREE.KeyFrameAnimation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==c?c:!0;a=0;for(b=this.hierarchy.length;a<b;a++){c=this.data.hierarchy[a].sids;var d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var e=0;e<c.length;e++){var f=c[e],l=this.getNextKeyWith(f,a,0);l&&l.apply(f)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a,b){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==a?a:!0;this.currentTime=void 0!==b?b:0;this.startTimeMs=b;this.startTime=1E7;this.endTime=-this.startTime;var c,d=this.hierarchy.length,e,f;for(c=0;c<d;c++)e=this.hierarchy[c],f=this.data.hierarchy[c],e.useQuaternion=!0,void 0===f.animationCache&&(f.animationCache={},f.animationCache.prevKey=null,f.animationCache.nextKey=null,f.animationCache.originalMatrix=e instanceof THREE.Bone?e.skinMatrix:
e.matrix),e=this.data.hierarchy[c].keys,e.length&&(f.animationCache.prevKey=e[0],f.animationCache.nextKey=e[1],this.startTime=Math.min(e[0].time,this.startTime),this.endTime=Math.max(e[e.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;b instanceof THREE.Bone?(d.copy(b.skinMatrix),b.skinMatrix=d):(d.copy(b.matrix),b.matrix=d);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(this.isPlaying){var b,c,d,e,f=this.data.JIT.hierarchy,l,m,n;m=this.currentTime+=a*this.timeScale;l=this.currentTime%=this.data.length;l<this.startTimeMs&&(l=this.currentTime=this.startTimeMs+l);e=parseInt(Math.min(l*this.data.fps,this.data.length*this.data.fps),10);if((n=l<m)&&!this.loop){a=0;for(var p=this.hierarchy.length;a<p;a++){var r=this.data.hierarchy[a].keys,f=this.data.hierarchy[a].sids;d=r.length-1;e=this.hierarchy[a];if(r.length){for(r=
0;r<f.length;r++)l=f[r],(m=this.getPrevKeyWith(l,a,d))&&m.apply(l);this.data.hierarchy[a].node.updateMatrix();e.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(l<this.startTime)){a=0;for(p=this.hierarchy.length;a<p;a++){d=this.hierarchy[a];b=this.data.hierarchy[a];var r=b.keys,t=b.animationCache;if(this.JITCompile&&void 0!==f[a][e])d instanceof THREE.Bone?(d.skinMatrix=f[a][e],d.matrixWorldNeedsUpdate=!1):(d.matrix=f[a][e],d.matrixWorldNeedsUpdate=!0);else if(r.length){this.JITCompile&&t&&(d instanceof
THREE.Bone?d.skinMatrix=t.originalMatrix:d.matrix=t.originalMatrix);b=t.prevKey;c=t.nextKey;if(b&&c){if(c.time<=m){if(n&&this.loop)for(b=r[0],c=r[1];c.time<l;)b=c,c=r[b.index+1];else if(!n)for(var u=r.length-1;c.time<l&&c.index!==u;)b=c,c=r[b.index+1];t.prevKey=b;t.nextKey=c}c.time>=l?b.interpolate(c,l):b.interpolate(c,c.time)}this.data.hierarchy[a].node.updateMatrix();d.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===f[0][e])for(this.hierarchy[0].updateMatrixWorld(!0),a=0;a<this.hierarchy.length;a++)f[a][e]=
this.hierarchy[a]instanceof THREE.Bone?this.hierarchy[a].skinMatrix.clone():this.hierarchy[a].matrix.clone()}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(-1,0,0));this.add(e);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1);f.lookAt(new THREE.Vector3(0,1,0));this.add(f);var l=new THREE.PerspectiveCamera(90,1,a,b);l.up.set(0,0,-1);l.lookAt(new THREE.Vector3(0,-1,0));this.add(l);var m=new THREE.PerspectiveCamera(90,
1,a,b);m.up.set(0,-1,0);m.lookAt(new THREE.Vector3(0,0,1));this.add(m);var n=new THREE.PerspectiveCamera(90,1,a,b);n.up.set(0,-1,0);n.lookAt(new THREE.Vector3(0,0,-1));this.add(n);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,u=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=
2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,l,c);c.activeCubeFace=4;a.render(b,m,c);c.generateMipmaps=u;c.activeCubeFace=5;a.render(b,n,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(a,b,c,d,e,f,l){THREE.Camera.call(this);this.fov=c;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.cameraO=new THREE.OrthographicCamera(a/-2,a/2,b/2,b/-2,f,l);this.cameraP=new THREE.PerspectiveCamera(c,a/b,d,e);this.zoom=1;this.toPerspective()};
THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var a=this.cameraP.aspect,b=(this.cameraP.near+this.cameraP.far)/2,b=Math.tan(this.fov/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.cameraO.left=-a;this.cameraO.right=a;this.cameraO.top=b;this.cameraO.bottom=-b;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(a,b){this.cameraP.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);a=a||50;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;b=void 0!==b?Math.max(3,b):8;var e,f=[];e=new THREE.Vector3;var l=new THREE.Vector2(0.5,0.5);this.vertices.push(e);f.push(l);for(e=0;e<=b;e++){var m=new THREE.Vector3,n=c+e/b*d;m.x=a*Math.cos(n);m.y=a*Math.sin(n);this.vertices.push(m);f.push(new THREE.Vector2((m.x/a+1)/2,(m.y/a+1)/2))}c=new THREE.Vector3(0,0,1);for(e=1;e<=b;e++)this.faces.push(new THREE.Face3(e,e+1,0,[c,c,c])),this.faceVertexUvs[0].push([f[e],
f[e+1],l]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CubeGeometry=function(a,b,c,d,e,f){function l(a,b,c,d,e,f,l,C){var A,B=m.widthSegments,F=m.heightSegments,I=e/2,J=f/2,D=m.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)A="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)A="y",F=m.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)A="x",B=m.depthSegments;var P=B+1,M=F+1,G=e/B,K=f/F,Y=new THREE.Vector3;Y[A]=0<l?1:-1;for(e=0;e<M;e++)for(f=0;f<P;f++){var T=new THREE.Vector3;T[a]=(f*G-I)*c;T[b]=(e*K-J)*d;T[A]=l;m.vertices.push(T)}for(e=
0;e<F;e++)for(f=0;f<B;f++)a=new THREE.Face4(f+P*e+D,f+P*(e+1)+D,f+1+P*(e+1)+D,f+1+P*e+D),a.normal.copy(Y),a.vertexNormals.push(Y.clone(),Y.clone(),Y.clone(),Y.clone()),a.materialIndex=C,m.faces.push(a),m.faceVertexUvs[0].push([new THREE.Vector2(f/B,1-e/F),new THREE.Vector2(f/B,1-(e+1)/F),new THREE.Vector2((f+1)/B,1-(e+1)/F),new THREE.Vector2((f+1)/B,1-e/F)])}THREE.Geometry.call(this);var m=this;this.width=a;this.height=b;this.depth=c;this.widthSegments=d||1;this.heightSegments=e||1;this.depthSegments=
f||1;a=this.width/2;b=this.height/2;c=this.depth/2;l("z","y",-1,-1,this.depth,this.height,a,0);l("z","y",1,-1,this.depth,this.height,-a,1);l("x","z",1,1,this.width,this.depth,b,2);l("x","z",1,-1,this.width,this.depth,-b,3);l("x","y",1,-1,this.width,this.height,c,4);l("x","y",-1,-1,this.width,this.height,-c,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CylinderGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.radiusTop=a=void 0!==a?a:20;this.radiusBottom=b=void 0!==b?b:20;this.height=c=void 0!==c?c:100;this.radiusSegments=d=d||8;this.heightSegments=e=e||1;this.openEnded=f=void 0!==f?f:!1;var l=c/2,m,n,p=[],r=[];for(n=0;n<=e;n++){var t=[],u=[],z=n/e,E=z*(b-a)+a;for(m=0;m<=d;m++){var C=m/d,A=new THREE.Vector3;A.x=E*Math.sin(2*C*Math.PI);A.y=-z*c+l;A.z=E*Math.cos(2*C*Math.PI);this.vertices.push(A);t.push(this.vertices.length-1);u.push(new THREE.Vector2(C,
1-z))}p.push(t);r.push(u)}c=(b-a)/c;for(m=0;m<d;m++)for(0!==a?(t=this.vertices[p[0][m]].clone(),u=this.vertices[p[0][m+1]].clone()):(t=this.vertices[p[1][m]].clone(),u=this.vertices[p[1][m+1]].clone()),t.setY(Math.sqrt(t.x*t.x+t.z*t.z)*c).normalize(),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*c).normalize(),n=0;n<e;n++){var z=p[n][m],E=p[n+1][m],C=p[n+1][m+1],A=p[n][m+1],B=t.clone(),F=t.clone(),I=u.clone(),J=u.clone(),D=r[n][m].clone(),P=r[n+1][m].clone(),M=r[n+1][m+1].clone(),G=r[n][m+1].clone();this.faces.push(new THREE.Face4(z,
E,C,A,[B,F,I,J]));this.faceVertexUvs[0].push([D,P,M,G])}if(!1===f&&0<a)for(this.vertices.push(new THREE.Vector3(0,l,0)),m=0;m<d;m++)z=p[0][m],E=p[0][m+1],C=this.vertices.length-1,B=new THREE.Vector3(0,1,0),F=new THREE.Vector3(0,1,0),I=new THREE.Vector3(0,1,0),D=r[0][m].clone(),P=r[0][m+1].clone(),M=new THREE.Vector2(P.u,0),this.faces.push(new THREE.Face3(z,E,C,[B,F,I])),this.faceVertexUvs[0].push([D,P,M]);if(!1===f&&0<b)for(this.vertices.push(new THREE.Vector3(0,-l,0)),m=0;m<d;m++)z=p[n][m+1],E=p[n][m],
C=this.vertices.length-1,B=new THREE.Vector3(0,-1,0),F=new THREE.Vector3(0,-1,0),I=new THREE.Vector3(0,-1,0),D=r[n][m+1].clone(),P=r[n][m].clone(),M=new THREE.Vector2(P.u,1),this.faces.push(new THREE.Face3(z,E,C,[B,F,I])),this.faceVertexUvs[0].push([D,P,M]);this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),a=a instanceof Array?a:[a],this.shapebb=a[a.length-1].getBoundingBox(),this.addShapeList(a,b),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=THREE.ExtrudeGeometry.__v1,e=THREE.ExtrudeGeometry.__v2,f=THREE.ExtrudeGeometry.__v3,l=THREE.ExtrudeGeometry.__v4,p=THREE.ExtrudeGeometry.__v5,m=THREE.ExtrudeGeometry.__v6;d.set(a.x-b.x,a.y-b.y);e.set(a.x-c.x,a.y-c.y);d=d.normalize();e=e.normalize();f.set(-d.y,d.x);l.set(e.y,-e.x);p.copy(a).add(f);m.copy(a).add(l);if(p.equals(m))return l.clone();
p.copy(b).add(f);m.copy(c).add(l);f=d.dot(l);l=m.sub(p).dot(l);0===f&&(console.log("Either infinite or no solutions!"),0===l?console.log("Its finite solutions."):console.log("Too bad, no solutions."));l/=f;0>l?(b=Math.atan2(b.y-a.y,b.x-a.x),a=Math.atan2(c.y-a.y,c.x-a.x),b>a&&(a+=2*Math.PI),c=(b+a)/2,a=-Math.cos(c),c=-Math.sin(c),a=new THREE.Vector2(a,c)):a=d.multiplyScalar(l).add(p).sub(a).clone();return a}function e(c,d){var e,f;for(N=c.length;0<=--N;){e=N;f=N-1;0>f&&(f=c.length-1);for(var l=0,p=
z+2*r,l=0;l<p;l++){var m=ua*l,n=ua*(l+1),t=d+e+m,m=d+f+m,u=d+f+n,n=d+e+n,A=c,C=l,B=p,D=e,q=f,t=t+O,m=m+O,u=u+O,n=n+O;T.faces.push(new THREE.Face4(t,m,u,n,null,null,F));t=I.generateSideWallUV(T,a,A,b,t,m,u,n,C,B,D,q);T.faceVertexUvs[0].push(t)}}}function f(a,b,c){T.vertices.push(new THREE.Vector3(a,b,c))}function l(c,d,e,f){c+=O;d+=O;e+=O;T.faces.push(new THREE.Face3(c,d,e,null,null,B));c=f?I.generateBottomUV(T,a,b,c,d,e):I.generateTopUV(T,a,b,c,d,e);T.faceVertexUvs[0].push(c)}var m=void 0!==b.amount?
b.amount:100,n=void 0!==b.bevelThickness?b.bevelThickness:6,p=void 0!==b.bevelSize?b.bevelSize:n-2,r=void 0!==b.bevelSegments?b.bevelSegments:3,t=void 0!==b.bevelEnabled?b.bevelEnabled:!0,u=void 0!==b.curveSegments?b.curveSegments:12,z=void 0!==b.steps?b.steps:1,E=b.extrudePath,C,A=!1,B=b.material,F=b.extrudeMaterial,I=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,J,D,P,M;E&&(C=E.getSpacedPoints(z),A=!0,t=!1,J=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(E,
z,!1),D=new THREE.Vector3,P=new THREE.Vector3,M=new THREE.Vector3);t||(p=n=r=0);var G,K,Y,T=this,O=this.vertices.length,E=a.extractPoints(u),u=E.shape,fa=E.holes;if(E=!THREE.Shape.Utils.isClockWise(u)){u=u.reverse();K=0;for(Y=fa.length;K<Y;K++)G=fa[K],THREE.Shape.Utils.isClockWise(G)&&(fa[K]=G.reverse());E=!1}var S=THREE.Shape.Utils.triangulateShape(u,fa),X=u;K=0;for(Y=fa.length;K<Y;K++)G=fa[K],u=u.concat(G);var Q,Z,V,da,W,ua=u.length,aa,ja=S.length,E=[],N=0;V=X.length;Q=V-1;for(Z=N+1;N<V;N++,Q++,
Z++)Q===V&&(Q=0),Z===V&&(Z=0),E[N]=d(X[N],X[Q],X[Z]);var ma=[],U,ga=E.concat();K=0;for(Y=fa.length;K<Y;K++){G=fa[K];U=[];N=0;V=G.length;Q=V-1;for(Z=N+1;N<V;N++,Q++,Z++)Q===V&&(Q=0),Z===V&&(Z=0),U[N]=d(G[N],G[Q],G[Z]);ma.push(U);ga=ga.concat(U)}for(Q=0;Q<r;Q++){V=Q/r;da=n*(1-V);Z=p*Math.sin(V*Math.PI/2);N=0;for(V=X.length;N<V;N++)W=c(X[N],E[N],Z),f(W.x,W.y,-da);K=0;for(Y=fa.length;K<Y;K++)for(G=fa[K],U=ma[K],N=0,V=G.length;N<V;N++)W=c(G[N],U[N],Z),f(W.x,W.y,-da)}Z=p;for(N=0;N<ua;N++)W=t?c(u[N],ga[N],
Z):u[N],A?(P.copy(J.normals[0]).multiplyScalar(W.x),D.copy(J.binormals[0]).multiplyScalar(W.y),M.copy(C[0]).add(P).add(D),f(M.x,M.y,M.z)):f(W.x,W.y,0);for(V=1;V<=z;V++)for(N=0;N<ua;N++)W=t?c(u[N],ga[N],Z):u[N],A?(P.copy(J.normals[V]).multiplyScalar(W.x),D.copy(J.binormals[V]).multiplyScalar(W.y),M.copy(C[V]).add(P).add(D),f(M.x,M.y,M.z)):f(W.x,W.y,m/z*V);for(Q=r-1;0<=Q;Q--){V=Q/r;da=n*(1-V);Z=p*Math.sin(V*Math.PI/2);N=0;for(V=X.length;N<V;N++)W=c(X[N],E[N],Z),f(W.x,W.y,m+da);K=0;for(Y=fa.length;K<
Y;K++)for(G=fa[K],U=ma[K],N=0,V=G.length;N<V;N++)W=c(G[N],U[N],Z),A?f(W.x,W.y+C[z-1].y,C[z-1].x+da):f(W.x,W.y,m+da)}(function(){if(t){var a;a=0*ua;for(N=0;N<ja;N++)aa=S[N],l(aa[2]+a,aa[1]+a,aa[0]+a,!0);a=z+2*r;a*=ua;for(N=0;N<ja;N++)aa=S[N],l(aa[0]+a,aa[1]+a,aa[2]+a,!1)}else{for(N=0;N<ja;N++)aa=S[N],l(aa[2],aa[1],aa[0],!0);for(N=0;N<ja;N++)aa=S[N],l(aa[0]+ua*z,aa[1]+ua*z,aa[2]+ua*z,!1)}})();(function(){var a=0;e(X,a);a+=X.length;K=0;for(Y=fa.length;K<Y;K++)G=fa[K],e(G,a),a+=G.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d,e,f){b=a.vertices[e].x;e=a.vertices[e].y;c=a.vertices[f].x;f=a.vertices[f].y;return[new THREE.Vector2(a.vertices[d].x,a.vertices[d].y),new THREE.Vector2(b,e),new THREE.Vector2(c,f)]},generateBottomUV:function(a,b,c,d,e,f){return this.generateTopUV(a,b,c,d,e,f)},generateSideWallUV:function(a,b,c,d,e,f,l,m,n,p,r,t){b=a.vertices[e].x;c=a.vertices[e].y;e=a.vertices[e].z;d=a.vertices[f].x;n=a.vertices[f].y;f=a.vertices[f].z;p=a.vertices[l].x;
r=a.vertices[l].y;l=a.vertices[l].z;t=a.vertices[m].x;var u=a.vertices[m].y;a=a.vertices[m].z;return 0.01>Math.abs(c-n)?[new THREE.Vector2(b,1-e),new THREE.Vector2(d,1-f),new THREE.Vector2(p,1-l),new THREE.Vector2(t,1-a)]:[new THREE.Vector2(c,1-e),new THREE.Vector2(n,1-f),new THREE.Vector2(r,1-l),new THREE.Vector2(u,1-a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);!1===a instanceof Array&&(a=[a]);this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,e,f,l,m=this.vertices.length;e=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var n=e.shape,p=e.holes;if(!THREE.Shape.Utils.isClockWise(n))for(n=n.reverse(),e=0,f=p.length;e<f;e++)l=p[e],THREE.Shape.Utils.isClockWise(l)&&(p[e]=l.reverse());var r=THREE.Shape.Utils.triangulateShape(n,p);e=0;for(f=p.length;e<f;e++)l=p[e],
n=n.concat(l);p=n.length;f=r.length;for(e=0;e<p;e++)l=n[e],this.vertices.push(new THREE.Vector3(l.x,l.y,0));for(e=0;e<f;e++)p=r[e],n=p[0]+m,l=p[1]+m,p=p[2]+m,this.faces.push(new THREE.Face3(n,l,p,null,null,c)),this.faceVertexUvs[0].push(d.generateBottomUV(this,a,b,n,l,p))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);b=b||12;c=c||0;d=d||2*Math.PI;for(var e=1/(a.length-1),f=1/b,l=0,m=b;l<=m;l++)for(var n=c+l*f*d,p=Math.cos(n),r=Math.sin(n),n=0,t=a.length;n<t;n++){var u=a[n],z=new THREE.Vector3;z.x=p*u.x-r*u.y;z.y=r*u.x+p*u.y;z.z=u.z;this.vertices.push(z)}c=a.length;l=0;for(m=b;l<m;l++)for(n=0,t=a.length-1;n<t;n++)d=b=n+c*l,r=b+c,p=b+1+c,this.faces.push(new THREE.Face4(d,r,p,b+1)),p=l*f,b=n*e,d=p+f,r=b+e,this.faceVertexUvs[0].push([new THREE.Vector2(p,
b),new THREE.Vector2(d,b),new THREE.Vector2(d,r),new THREE.Vector2(p,r)]);this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.width=a;this.height=b;this.widthSegments=c||1;this.heightSegments=d||1;c=a/2;var e=b/2;d=this.widthSegments;var f=this.heightSegments,l=d+1,m=f+1,n=this.width/d,p=this.height/f,r=new THREE.Vector3(0,0,1);for(a=0;a<m;a++)for(b=0;b<l;b++)this.vertices.push(new THREE.Vector3(b*n-c,-(a*p-e),0));for(a=0;a<f;a++)for(b=0;b<d;b++)c=new THREE.Face4(b+l*a,b+l*(a+1),b+1+l*(a+1),b+1+l*a),c.normal.copy(r),c.vertexNormals.push(r.clone(),r.clone(),
r.clone(),r.clone()),this.faces.push(c),this.faceVertexUvs[0].push([new THREE.Vector2(b/d,1-a/f),new THREE.Vector2(b/d,1-(a+1)/f),new THREE.Vector2((b+1)/d,1-(a+1)/f),new THREE.Vector2((b+1)/d,1-a/f)]);this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);a=a||0;b=b||50;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(3,d):8;var l=[],m=a,n=(b-a)/d;for(a=0;a<=d;a++){for(b=0;b<=c;b++){var p=new THREE.Vector3,r=e+b/c*f;p.x=m*Math.cos(r);p.y=m*Math.sin(r);this.vertices.push(p);l.push(new THREE.Vector2((p.x/m+1)/2,-(p.y/m+1)/2+1))}m+=n}e=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(f=a*c,b=0;b<=c;b++){var r=b+f,n=r+a,p=r+c+a,t=r+c+1+a;this.faces.push(new THREE.Face3(n,
p,t,[e,e,e]));this.faceVertexUvs[0].push([l[n],l[p],l[t]]);n=r+a;p=r+c+1+a;t=r+1+a;this.faces.push(new THREE.Face3(n,p,t,[e,e,e]));this.faceVertexUvs[0].push([l[n],l[p],l[t]])}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,m)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,d,e,f,l){THREE.Geometry.call(this);this.radius=a=a||50;this.widthSegments=b=Math.max(3,Math.floor(b)||8);this.heightSegments=c=Math.max(2,Math.floor(c)||6);this.phiStart=d=void 0!==d?d:0;this.phiLength=e=void 0!==e?e:2*Math.PI;this.thetaStart=f=void 0!==f?f:0;this.thetaLength=l=void 0!==l?l:Math.PI;var m,n,p=[],r=[];for(n=0;n<=c;n++){var t=[],u=[];for(m=0;m<=b;m++){var z=m/b,E=n/c,C=new THREE.Vector3;C.x=-a*Math.cos(d+z*e)*Math.sin(f+E*l);C.y=a*Math.cos(f+E*l);
C.z=a*Math.sin(d+z*e)*Math.sin(f+E*l);this.vertices.push(C);t.push(this.vertices.length-1);u.push(new THREE.Vector2(z,1-E))}p.push(t);r.push(u)}for(n=0;n<this.heightSegments;n++)for(m=0;m<this.widthSegments;m++){b=p[n][m+1];c=p[n][m];d=p[n+1][m];e=p[n+1][m+1];f=this.vertices[b].clone().normalize();l=this.vertices[c].clone().normalize();var t=this.vertices[d].clone().normalize(),u=this.vertices[e].clone().normalize(),z=r[n][m+1].clone(),E=r[n][m].clone(),C=r[n+1][m].clone(),A=r[n+1][m+1].clone();Math.abs(this.vertices[b].y)===
this.radius?(this.faces.push(new THREE.Face3(b,d,e,[f,t,u])),this.faceVertexUvs[0].push([z,C,A])):Math.abs(this.vertices[d].y)===this.radius?(this.faces.push(new THREE.Face3(b,c,d,[f,l,t])),this.faceVertexUvs[0].push([z,E,C])):(this.faces.push(new THREE.Face4(b,c,d,e,[f,l,t,u])),this.faceVertexUvs[0].push([z,E,C,A]))}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||8;this.tubularSegments=d||6;this.arc=e||2*Math.PI;e=new THREE.Vector3;a=[];b=[];for(c=0;c<=this.radialSegments;c++)for(d=0;d<=this.tubularSegments;d++){var f=d/this.tubularSegments*this.arc,l=2*c/this.radialSegments*Math.PI;e.x=this.radius*Math.cos(f);e.y=this.radius*Math.sin(f);var m=new THREE.Vector3;m.x=(this.radius+this.tube*Math.cos(l))*Math.cos(f);m.y=(this.radius+this.tube*
Math.cos(l))*Math.sin(f);m.z=this.tube*Math.sin(l);this.vertices.push(m);a.push(new THREE.Vector2(d/this.tubularSegments,c/this.radialSegments));b.push(m.clone().sub(e).normalize())}for(c=1;c<=this.radialSegments;c++)for(d=1;d<=this.tubularSegments;d++){e=(this.tubularSegments+1)*c+d-1;var f=(this.tubularSegments+1)*(c-1)+d-1,l=(this.tubularSegments+1)*(c-1)+d,m=(this.tubularSegments+1)*c+d,n=new THREE.Face4(e,f,l,m,[b[e],b[f],b[l],b[m]]);n.normal.add(b[e]);n.normal.add(b[f]);n.normal.add(b[l]);n.normal.add(b[m]);
n.normal.normalize();this.faces.push(n);this.faceVertexUvs[0].push([a[e].clone(),a[f].clone(),a[l].clone(),a[m].clone()])}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TorusKnotGeometry=function(a,b,c,d,e,f,l){function m(a,b,c,d,e,f){var l=Math.cos(a);Math.cos(b);b=Math.sin(a);a*=c/d;c=Math.cos(a);l*=0.5*e*(2+c);b=0.5*e*(2+c)*b;e=0.5*f*e*Math.sin(a);return new THREE.Vector3(l,b,e)}THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||64;this.tubularSegments=d||8;this.p=e||2;this.q=f||3;this.heightScale=l||1;this.grid=Array(this.radialSegments);c=new THREE.Vector3;d=new THREE.Vector3;e=new THREE.Vector3;for(a=0;a<this.radialSegments;++a)for(this.grid[a]=
Array(this.tubularSegments),b=0;b<this.tubularSegments;++b){var n=2*(a/this.radialSegments)*this.p*Math.PI;l=2*(b/this.tubularSegments)*Math.PI;f=m(n,l,this.q,this.p,this.radius,this.heightScale);n=m(n+0.01,l,this.q,this.p,this.radius,this.heightScale);c.subVectors(n,f);d.addVectors(n,f);e.crossVectors(c,d);d.crossVectors(e,c);e.normalize();d.normalize();n=-this.tube*Math.cos(l);l=this.tube*Math.sin(l);f.x+=n*d.x+l*e.x;f.y+=n*d.y+l*e.y;f.z+=n*d.z+l*e.z;this.grid[a][b]=this.vertices.push(new THREE.Vector3(f.x,
f.y,f.z))-1}for(a=0;a<this.radialSegments;++a)for(b=0;b<this.tubularSegments;++b){e=(a+1)%this.radialSegments;f=(b+1)%this.tubularSegments;c=this.grid[a][b];d=this.grid[e][b];e=this.grid[e][f];f=this.grid[a][f];l=new THREE.Vector2(a/this.radialSegments,b/this.tubularSegments);var n=new THREE.Vector2((a+1)/this.radialSegments,b/this.tubularSegments),p=new THREE.Vector2((a+1)/this.radialSegments,(b+1)/this.tubularSegments),r=new THREE.Vector2(a/this.radialSegments,(b+1)/this.tubularSegments);this.faces.push(new THREE.Face4(c,
d,e,f));this.faceVertexUvs[0].push([l,n,p,r])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.path=a;this.segments=b||64;this.radius=c||1;this.radiusSegments=d||8;this.closed=e||!1;f&&(this.debug=new THREE.Object3D);this.grid=[];var l,m;e=this.segments+1;var n,p,r;f=new THREE.Vector3;var t,u,z;b=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);t=b.tangents;u=b.normals;z=b.binormals;this.tangents=t;this.normals=u;this.binormals=z;for(b=0;b<e;b++)for(this.grid[b]=[],d=b/(e-1),r=a.getPointAt(d),d=
t[b],l=u[b],m=z[b],this.debug&&(this.debug.add(new THREE.ArrowHelper(d,r,c,255)),this.debug.add(new THREE.ArrowHelper(l,r,c,16711680)),this.debug.add(new THREE.ArrowHelper(m,r,c,65280))),d=0;d<this.radiusSegments;d++)n=2*(d/this.radiusSegments)*Math.PI,p=-this.radius*Math.cos(n),n=this.radius*Math.sin(n),f.copy(r),f.x+=p*l.x+n*m.x,f.y+=p*l.y+n*m.y,f.z+=p*l.z+n*m.z,this.grid[b][d]=this.vertices.push(new THREE.Vector3(f.x,f.y,f.z))-1;for(b=0;b<this.segments;b++)for(d=0;d<this.radiusSegments;d++)e=this.closed?
(b+1)%this.segments:b+1,f=(d+1)%this.radiusSegments,a=this.grid[b][d],c=this.grid[e][d],e=this.grid[e][f],f=this.grid[b][f],t=new THREE.Vector2(b/this.segments,d/this.radiusSegments),u=new THREE.Vector2((b+1)/this.segments,d/this.radiusSegments),z=new THREE.Vector2((b+1)/this.segments,(d+1)/this.radiusSegments),l=new THREE.Vector2(b/this.segments,(d+1)/this.radiusSegments),this.faces.push(new THREE.Face4(a,c,e,f)),this.faceVertexUvs[0].push([t,u,z,l]);this.computeCentroids();this.computeFaceNormals();
this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var e=[],f=[],l=[],m=new THREE.Vector3,n=new THREE.Matrix4;b+=1;var p,r,t;this.tangents=e;this.normals=f;this.binormals=l;for(p=0;p<b;p++)r=p/(b-1),e[p]=a.getTangentAt(r),e[p].normalize();f[0]=new THREE.Vector3;l[0]=new THREE.Vector3;a=Number.MAX_VALUE;p=Math.abs(e[0].x);r=Math.abs(e[0].y);t=Math.abs(e[0].z);p<=a&&(a=p,d.set(1,0,0));r<=a&&(a=r,d.set(0,1,0));t<=a&&d.set(0,0,1);m.crossVectors(e[0],
d).normalize();f[0].crossVectors(e[0],m);l[0].crossVectors(e[0],f[0]);for(p=1;p<b;p++)f[p]=f[p-1].clone(),l[p]=l[p-1].clone(),m.crossVectors(e[p-1],e[p]),1E-4<m.length()&&(m.normalize(),d=Math.acos(e[p-1].dot(e[p])),f[p].applyMatrix4(n.makeRotationAxis(m,d))),l[p].crossVectors(e[p],f[p]);if(c)for(d=Math.acos(f[0].dot(f[b-1])),d/=b-1,0<e[0].dot(m.crossVectors(f[0],f[b-1]))&&(d=-d),p=1;p<b;p++)f[p].applyMatrix4(n.makeRotationAxis(e[p],d*p)),l[p].crossVectors(e[p],f[p])};
THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=n.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+0.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;b.uv=new THREE.Vector2(c,1-a);return b}function f(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);d.centroid.add(a).add(b).add(c).divideScalar(3);d.normal.copy(d.centroid).normalize();n.faces.push(d);d=Math.atan2(d.centroid.z,-d.centroid.x);n.faceVertexUvs[0].push([m(a.uv,
a,d),m(b.uv,b,d),m(c.uv,c,d)])}function l(a,b){var c=Math.pow(2,b);Math.pow(4,b);for(var d=e(n.vertices[a.a]),l=e(n.vertices[a.b]),p=e(n.vertices[a.c]),m=[],r=0;r<=c;r++){m[r]=[];for(var t=e(d.clone().lerp(p,r/c)),u=e(l.clone().lerp(p,r/c)),z=c-r,E=0;E<=z;E++)m[r][E]=0==E&&r==c?t:e(t.clone().lerp(u,E/z))}for(r=0;r<c;r++)for(E=0;E<2*(c-r)-1;E++)d=Math.floor(E/2),0==E%2?f(m[r][d+1],m[r+1][d],m[r][d]):f(m[r][d+1],m[r+1][d+1],m[r+1][d])}function m(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));
0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+0.5,a.y));return a.clone()}THREE.Geometry.call(this);c=c||1;d=d||0;for(var n=this,p=0,r=a.length;p<r;p++)e(new THREE.Vector3(a[p][0],a[p][1],a[p][2]));a=this.vertices;for(var t=[],p=0,r=b.length;p<r;p++){var u=a[b[p][0]],z=a[b[p][1]],E=a[b[p][2]];t[p]=new THREE.Face3(u.index,z.index,E.index,[u.clone(),z.clone(),E.clone()])}p=0;for(r=t.length;p<r;p++)l(t[p],d);p=0;for(r=this.faceVertexUvs[0].length;p<r;p++)b=this.faceVertexUvs[0][p],d=b[0].x,a=b[1].x,
t=b[2].x,u=Math.max(d,Math.max(a,t)),z=Math.min(d,Math.min(a,t)),0.9<u&&0.1>z&&(0.2>d&&(b[0].x+=1),0.2>a&&(b[1].x+=1),0.2>t&&(b[2].x+=1));this.mergeVertices();p=0;for(r=this.vertices.length;p<r;p++)this.vertices[p].multiplyScalar(c);this.computeCentroids();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry=function(a,b){this.radius=a;this.detail=b;var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,b)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.OctahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],a,b)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,b)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry=function(a,b,c,d){THREE.Geometry.call(this);var e=this.vertices,f=this.faces,l=this.faceVertexUvs[0];d=void 0===d?!1:d;var m,n,p,r,t=b+1;for(m=0;m<=c;m++)for(r=m/c,n=0;n<=b;n++)p=n/b,p=a(p,r),e.push(p);var u,z,E,C;for(m=0;m<c;m++)for(n=0;n<b;n++)a=m*t+n,e=m*t+n+1,r=(m+1)*t+n,p=(m+1)*t+n+1,u=new THREE.Vector2(n/b,m/c),z=new THREE.Vector2((n+1)/b,m/c),E=new THREE.Vector2(n/b,(m+1)/c),C=new THREE.Vector2((n+1)/b,(m+1)/c),d?(f.push(new THREE.Face3(a,e,r)),f.push(new THREE.Face3(e,
p,r)),l.push([u,z,E]),l.push([z,C,E])):(f.push(new THREE.Face4(a,e,p,r)),l.push([u,z,C,E]));this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ConvexGeometry=function(a){function b(b){var c=a[b].clone(),e=c.length();c.x+=e*2E-6*(Math.random()-0.5);c.y+=e*2E-6*(Math.random()-0.5);c.z+=e*2E-6*(Math.random()-0.5);for(var e=[],f=0;f<d.length;){var l=d[f],m=c,n=a[l[0]],A;A=n;var B=a[l[1]],F=a[l[2]],I=new THREE.Vector3,J=new THREE.Vector3;I.subVectors(F,B);J.subVectors(A,B);I.cross(J);I.normalize();A=I;n=A.dot(n);if(A.dot(m)>=n){for(m=0;3>m;m++){n=[l[m],l[(m+1)%3]];A=!0;for(B=0;B<e.length;B++)if(e[B][0]===n[1]&&e[B][1]===n[0]){e[B]=e[e.length-
1];e.pop();A=!1;break}A&&e.push(n)}d[f]=d[d.length-1];d.pop()}else f++}for(B=0;B<e.length;B++)d.push([e[B][0],e[B][1],b])}function c(a){var b=a.length();return new THREE.Vector2(a.x/b,a.y/b)}THREE.Geometry.call(this);for(var d=[[0,1,2],[0,2,1]],e=3;e<a.length;e++)b(e);for(var f=0,l=Array(a.length),e=0;e<d.length;e++)for(var m=d[e],n=0;3>n;n++)void 0===l[m[n]]&&(l[m[n]]=f++,this.vertices.push(a[m[n]])),m[n]=l[m[n]];for(e=0;e<d.length;e++)this.faces.push(new THREE.Face3(d[e][0],d[e][1],d[e][2]));for(e=
0;e<this.faces.length;e++)m=this.faces[e],this.faceVertexUvs[0].push([c(this.vertices[m.a]),c(this.vertices[m.b]),c(this.vertices[m.c])]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3(a,0,0),new THREE.Vector3,new THREE.Vector3(0,a,0),new THREE.Vector3,new THREE.Vector3(0,0,a));b.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));a=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,b,a,THREE.LinePieces)};
THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(a,b,c,d){THREE.Object3D.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);this.position=b;this.useQuaternion=!0;b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(b,new THREE.LineBasicMaterial({color:d}));this.line.matrixAutoUpdate=!1;this.add(this.line);b=new THREE.CylinderGeometry(0,0.05,0.25,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,0.875,0));this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:d}));
this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){0.999<c.y?this.quaternion.set(0,0,0,1):-0.999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();THREE.ArrowHelper.prototype.setLength=function(a){this.scale.set(a,a,a)};
THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};
THREE.BoxHelper=function(a){a=a||1;var b=new THREE.Geometry;a=[new THREE.Vector3(a,a,a),new THREE.Vector3(-a,a,a),new THREE.Vector3(-a,-a,a),new THREE.Vector3(a,-a,a),new THREE.Vector3(a,a,-a),new THREE.Vector3(-a,a,-a),new THREE.Vector3(-a,-a,-a),new THREE.Vector3(a,-a,-a)];b.vertices.push(a[0],a[1],a[1],a[2],a[2],a[3],a[3],a[0],a[4],a[5],a[5],a[6],a[6],a[7],a[7],a[4],a[0],a[4],a[1],a[5],a[2],a[6],a[3],a[7]);this.vertices=a;THREE.Line.call(this,b,new THREE.LineBasicMaterial,THREE.LinePieces)};
THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,d=this.vertices;d[0].set(b.x,b.y,b.z);d[1].set(c.x,b.y,b.z);d[2].set(c.x,c.y,b.z);d[3].set(b.x,c.y,b.z);d[4].set(b.x,b.y,c.z);d[5].set(c.x,b.y,c.z);d[6].set(c.x,c.y,c.z);d[7].set(b.x,c.y,c.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===f[a]&&(f[a]=[]);f[a].push(d.vertices.length-1)}THREE.Line.call(this);var d=new THREE.Geometry,e=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),f={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);
b("n1","f1",16755200);b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,d,e,THREE.LinePieces);this.camera=a;this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=f;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Camera,c=new THREE.Projector;return function(){function d(d,l,m,n){a.set(l,m,n);c.unprojectVector(a,b);d=e.pointMap[d];if(void 0!==d)for(l=0,m=d.length;l<m;l++)e.geometry.vertices[d[l]].copy(a)}var e=this;b.projectionMatrix.copy(this.camera.projectionMatrix);d("c",0,0,-1);d("t",0,0,1);d("n1",-1,-1,-1);d("n2",1,-1,-1);d("n3",-1,1,-1);d("n4",1,1,-1);d("f1",-1,-1,1);d("f2",1,-1,1);d("f3",-1,1,1);d("f4",1,1,1);d("u1",0.7,
1.1,-1);d("u2",-0.7,1.1,-1);d("u3",0,2,-1);d("cf1",-1,0,1);d("cf2",1,0,1);d("cf3",0,-1,1);d("cf4",0,1,1);d("cn1",-1,0,-1);d("cn2",1,0,-1);d("cn3",0,-1,-1);d("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=a;var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,d);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere);c=new THREE.Geometry;c.vertices.push(this.light.position);c.vertices.push(this.light.target.position);
c.computeLineDistances();d=new THREE.LineDashedMaterial({dashSize:4,gapSize:4,opacity:0.75,transparent:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,d);this.add(this.targetLine)};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.computeLineDistances();this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.GridHelper=function(a,b){for(var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),e=new THREE.Color(4473924),f=new THREE.Color(8947848),l=-a;l<=a;l+=b){c.vertices.push(new THREE.Vector3(-a,0,l));c.vertices.push(new THREE.Vector3(a,0,l));c.vertices.push(new THREE.Vector3(l,0,-a));c.vertices.push(new THREE.Vector3(l,0,a));var m=0===l?e:f;c.colors.push(m,m,m,m)}THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.HemisphereLightHelper=function(a,b,c,d){THREE.Object3D.call(this);this.light=a;b=new THREE.SphereGeometry(b,4,2);b.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(c=0;8>c;c++)b.faces[c].materialIndex=4>c?0:1;c=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});c.color.copy(a.color).multiplyScalar(a.intensity);d=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});d.color.copy(a.groundColor).multiplyScalar(a.intensity);this.lightSphere=new THREE.Mesh(b,new THREE.MeshFaceMaterial([c,
d]));this.lightSphere.position=a.position;this.lightSphere.lookAt(new THREE.Vector3);this.add(this.lightSphere)};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.update=function(){this.lightSphere.lookAt(new THREE.Vector3);this.lightSphere.material.materials[0].color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere.material.materials[1].color.copy(this.light.groundColor).multiplyScalar(this.light.intensity)};
THREE.PointLightHelper=function(a,b){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=a;var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,d);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere)};THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.PointLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SpotLightHelper=function(a,b){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=a;var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,d);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere);c=new THREE.CylinderGeometry(1E-4,1,1,8,1,!0);c.applyMatrix((new THREE.Matrix4).makeTranslation(0,
-0.5,0));c.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));d=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0,opacity:0.3,transparent:!0});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightCone=new THREE.Mesh(c,d);this.lightCone.position=this.light.position;c=a.distance?a.distance:1E4;d=c*Math.tan(a.angle);this.lightCone.scale.set(d,d,c);this.lightCone.lookAt(this.light.target.position);this.add(this.lightCone)};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.update=function(){var a=this.light.distance?this.light.distance:1E4,b=a*Math.tan(this.light.angle);this.lightCone.scale.set(b,b,a);this.lightCone.lookAt(this.light.target.position);this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightCone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};
THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,e)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);
THREE.LensFlare.prototype.add=function(a,b,c,d,e,f){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===f&&(f=1);void 0===e&&(e=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:f,color:e,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+e*c.distance,c.wantedRotation=0.25*c.x*Math.PI,c.rotation+=0.25*(c.wantedRotation-c.rotation)};
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)(\d+)/,c,d={},e=this.geometry,f=0,l=e.morphTargets.length;f<l;f++){var m=e.morphTargets[f].name.match(b);if(m&&1<m.length){var n=m[1];d[n]||(d[n]={start:Infinity,end:-Infinity});m=d[n];f<m.start&&(m.start=f);f>m.end&&(m.end=f);c||(c=n)}}for(n in d)m=d[n],this.createAnimation(n,m.start,m.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var f=d.startFrame+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),l=d.weight;
f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*l,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f);e=d.time%e/e;d.directionBackwards&&(e=1-e);this.morphTargetInfluences[d.currentFrame]=e*l;this.morphTargetInfluences[d.lastFrame]=(1-e)*l}}};
THREE.LensFlarePlugin=function(){function a(a,c){var d=b.createProgram(),e=b.createShader(b.FRAGMENT_SHADER),f=b.createShader(b.VERTEX_SHADER),l="precision "+c+" float;\n";b.shaderSource(e,l+a.fragmentShader);b.shaderSource(f,l+a.vertexShader);b.compileShader(e);b.compileShader(f);b.attachShader(d,e);b.attachShader(d,f);b.linkProgram(d);return d}var b,c,d,e,f,l,m,n,p,r,t,u,z;this.init=function(E){b=E.context;c=E;d=E.getPrecision();e=new Float32Array(16);f=new Uint16Array(6);E=0;e[E++]=-1;e[E++]=-1;
e[E++]=0;e[E++]=0;e[E++]=1;e[E++]=-1;e[E++]=1;e[E++]=0;e[E++]=1;e[E++]=1;e[E++]=1;e[E++]=1;e[E++]=-1;e[E++]=1;e[E++]=0;e[E++]=1;E=0;f[E++]=0;f[E++]=1;f[E++]=2;f[E++]=0;f[E++]=2;f[E++]=3;l=b.createBuffer();m=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,l);b.bufferData(b.ARRAY_BUFFER,e,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m);b.bufferData(b.ELEMENT_ARRAY_BUFFER,f,b.STATIC_DRAW);n=b.createTexture();p=b.createTexture();b.bindTexture(b.TEXTURE_2D,n);b.texImage2D(b.TEXTURE_2D,0,b.RGB,16,16,
0,b.RGB,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,p);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);0>=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(r=!1,t=a(THREE.ShaderFlares.lensFlare,d)):(r=!0,t=a(THREE.ShaderFlares.lensFlareVertexTexture,d));u={};z={};u.vertex=b.getAttribLocation(t,"position");u.uv=b.getAttribLocation(t,"uv");z.renderType=b.getUniformLocation(t,"renderType");z.map=b.getUniformLocation(t,"map");z.occlusionMap=b.getUniformLocation(t,"occlusionMap");z.opacity=
b.getUniformLocation(t,"opacity");z.color=b.getUniformLocation(t,"color");z.scale=b.getUniformLocation(t,"scale");z.rotation=b.getUniformLocation(t,"rotation");z.screenPosition=b.getUniformLocation(t,"screenPosition")};this.render=function(a,d,e,f){a=a.__webglFlares;var F=a.length;if(F){var I=new THREE.Vector3,J=f/e,D=0.5*e,P=0.5*f,M=16/f,G=new THREE.Vector2(M*J,M),K=new THREE.Vector3(1,1,0),Y=new THREE.Vector2(1,1),T=z,M=u;b.useProgram(t);b.enableVertexAttribArray(u.vertex);b.enableVertexAttribArray(u.uv);
b.uniform1i(T.occlusionMap,0);b.uniform1i(T.map,1);b.bindBuffer(b.ARRAY_BUFFER,l);b.vertexAttribPointer(M.vertex,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(M.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m);b.disable(b.CULL_FACE);b.depthMask(!1);var O,fa,S,X,Q;for(O=0;O<F;O++)if(M=16/f,G.set(M*J,M),X=a[O],I.set(X.matrixWorld.elements[12],X.matrixWorld.elements[13],X.matrixWorld.elements[14]),I.applyMatrix4(d.matrixWorldInverse),I.applyProjection(d.projectionMatrix),K.copy(I),Y.x=K.x*D+D,
Y.y=K.y*P+P,r||0<Y.x&&Y.x<e&&0<Y.y&&Y.y<f)for(b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,n),b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,Y.x-8,Y.y-8,16,16,0),b.uniform1i(T.renderType,0),b.uniform2f(T.scale,G.x,G.y),b.uniform3f(T.screenPosition,K.x,K.y,K.z),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,p),b.copyTexImage2D(b.TEXTURE_2D,0,b.RGBA,Y.x-8,Y.y-8,16,16,0),b.uniform1i(T.renderType,1),b.disable(b.DEPTH_TEST),
b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,n),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),X.positionScreen.copy(K),X.customUpdateCallback?X.customUpdateCallback(X):X.updateLensFlares(),b.uniform1i(T.renderType,2),b.enable(b.BLEND),fa=0,S=X.lensFlares.length;fa<S;fa++)Q=X.lensFlares[fa],0.001<Q.opacity&&0.001<Q.scale&&(K.x=Q.x,K.y=Q.y,K.z=Q.z,M=Q.size*Q.scale/f,G.x=M*J,G.y=M,b.uniform3f(T.screenPosition,K.x,K.y,K.z),b.uniform2f(T.scale,G.x,G.y),b.uniform1f(T.rotation,Q.rotation),b.uniform1f(T.opacity,
Q.opacity),b.uniform3f(T.color,Q.color.r,Q.color.g,Q.color.b),c.setBlending(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst),c.setTexture(Q.texture,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);b.depthMask(!0)}}};
THREE.ShadowMapPlugin=function(){var a,b,c,d,e,f,l=new THREE.Frustum,m=new THREE.Matrix4,n=new THREE.Vector3,p=new THREE.Vector3,r=new THREE.Vector3;this.init=function(l){a=l.context;b=l;l=THREE.ShaderLib.depthRGBA;var p=THREE.UniformsUtils.clone(l.uniforms);c=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p});d=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p,morphTargets:!0});e=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,
vertexShader:l.vertexShader,uniforms:p,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p,morphTargets:!0,skinning:!0});c._shadowPass=!0;d._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0};this.render=function(a,c){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,c)};this.update=function(t,u){var z,E,C,A,B,F,I,J,D,P=[];A=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);b.shadowMapCullFace===THREE.CullFaceFront?
a.cullFace(a.FRONT):a.cullFace(a.BACK);b.setDepthTest(!0);z=0;for(E=t.__lights.length;z<E;z++)if(C=t.__lights[z],C.castShadow)if(C instanceof THREE.DirectionalLight&&C.shadowCascade)for(B=0;B<C.shadowCascadeCount;B++){var M;if(C.shadowCascadeArray[B])M=C.shadowCascadeArray[B];else{D=C;I=B;M=new THREE.DirectionalLight;M.isVirtual=!0;M.onlyShadow=!0;M.castShadow=!0;M.shadowCameraNear=D.shadowCameraNear;M.shadowCameraFar=D.shadowCameraFar;M.shadowCameraLeft=D.shadowCameraLeft;M.shadowCameraRight=D.shadowCameraRight;
M.shadowCameraBottom=D.shadowCameraBottom;M.shadowCameraTop=D.shadowCameraTop;M.shadowCameraVisible=D.shadowCameraVisible;M.shadowDarkness=D.shadowDarkness;M.shadowBias=D.shadowCascadeBias[I];M.shadowMapWidth=D.shadowCascadeWidth[I];M.shadowMapHeight=D.shadowCascadeHeight[I];M.pointsWorld=[];M.pointsFrustum=[];J=M.pointsWorld;F=M.pointsFrustum;for(var G=0;8>G;G++)J[G]=new THREE.Vector3,F[G]=new THREE.Vector3;J=D.shadowCascadeNearZ[I];D=D.shadowCascadeFarZ[I];F[0].set(-1,-1,J);F[1].set(1,-1,J);F[2].set(-1,
1,J);F[3].set(1,1,J);F[4].set(-1,-1,D);F[5].set(1,-1,D);F[6].set(-1,1,D);F[7].set(1,1,D);M.originalCamera=u;F=new THREE.Gyroscope;F.position=C.shadowCascadeOffset;F.add(M);F.add(M.target);u.add(F);C.shadowCascadeArray[B]=M;console.log("Created virtualLight",M)}I=C;J=B;D=I.shadowCascadeArray[J];D.position.copy(I.position);D.target.position.copy(I.target.position);D.lookAt(D.target);D.shadowCameraVisible=I.shadowCameraVisible;D.shadowDarkness=I.shadowDarkness;D.shadowBias=I.shadowCascadeBias[J];F=I.shadowCascadeNearZ[J];
I=I.shadowCascadeFarZ[J];D=D.pointsFrustum;D[0].z=F;D[1].z=F;D[2].z=F;D[3].z=F;D[4].z=I;D[5].z=I;D[6].z=I;D[7].z=I;P[A]=M;A++}else P[A]=C,A++;z=0;for(E=P.length;z<E;z++){C=P[z];C.shadowMap||(B=THREE.LinearFilter,b.shadowMapType===THREE.PCFSoftShadowMap&&(B=THREE.NearestFilter),C.shadowMap=new THREE.WebGLRenderTarget(C.shadowMapWidth,C.shadowMapHeight,{minFilter:B,magFilter:B,format:THREE.RGBAFormat}),C.shadowMapSize=new THREE.Vector2(C.shadowMapWidth,C.shadowMapHeight),C.shadowMatrix=new THREE.Matrix4);
if(!C.shadowCamera){if(C instanceof THREE.SpotLight)C.shadowCamera=new THREE.PerspectiveCamera(C.shadowCameraFov,C.shadowMapWidth/C.shadowMapHeight,C.shadowCameraNear,C.shadowCameraFar);else if(C instanceof THREE.DirectionalLight)C.shadowCamera=new THREE.OrthographicCamera(C.shadowCameraLeft,C.shadowCameraRight,C.shadowCameraTop,C.shadowCameraBottom,C.shadowCameraNear,C.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}t.add(C.shadowCamera);!0===t.autoUpdate&&t.updateMatrixWorld()}C.shadowCameraVisible&&
!C.cameraHelper&&(C.cameraHelper=new THREE.CameraHelper(C.shadowCamera),C.shadowCamera.add(C.cameraHelper));if(C.isVirtual&&M.originalCamera==u){B=u;A=C.shadowCamera;F=C.pointsFrustum;D=C.pointsWorld;n.set(Infinity,Infinity,Infinity);p.set(-Infinity,-Infinity,-Infinity);for(I=0;8>I;I++)J=D[I],J.copy(F[I]),THREE.ShadowMapPlugin.__projector.unprojectVector(J,B),J.applyMatrix4(A.matrixWorldInverse),J.x<n.x&&(n.x=J.x),J.x>p.x&&(p.x=J.x),J.y<n.y&&(n.y=J.y),J.y>p.y&&(p.y=J.y),J.z<n.z&&(n.z=J.z),J.z>p.z&&
(p.z=J.z);A.left=n.x;A.right=p.x;A.top=p.y;A.bottom=n.y;A.updateProjectionMatrix()}A=C.shadowMap;F=C.shadowMatrix;B=C.shadowCamera;B.position.getPositionFromMatrix(C.matrixWorld);r.getPositionFromMatrix(C.target.matrixWorld);B.lookAt(r);B.updateMatrixWorld();B.matrixWorldInverse.getInverse(B.matrixWorld);C.cameraHelper&&(C.cameraHelper.visible=C.shadowCameraVisible);C.shadowCameraVisible&&C.cameraHelper.update();F.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);F.multiply(B.projectionMatrix);F.multiply(B.matrixWorldInverse);
m.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse);l.setFromMatrix(m);b.setRenderTarget(A);b.clear();D=t.__webglObjects;C=0;for(A=D.length;C<A;C++)I=D[C],F=I.object,I.render=!1,!F.visible||!F.castShadow||(F instanceof THREE.Mesh||F instanceof THREE.ParticleSystem)&&F.frustumCulled&&!l.intersectsObject(F)||(F._modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,F.matrixWorld),I.render=!0);C=0;for(A=D.length;C<A;C++)I=D[C],I.render&&(F=I.object,I=I.buffer,G=F.material instanceof THREE.MeshFaceMaterial?
F.material.materials[0]:F.material,J=0<F.geometry.morphTargets.length&&G.morphTargets,G=F instanceof THREE.SkinnedMesh&&G.skinning,J=F.customDepthMaterial?F.customDepthMaterial:G?J?f:e:J?d:c,I instanceof THREE.BufferGeometry?b.renderBufferDirect(B,t.__lights,null,J,I,F):b.renderBuffer(B,t.__lights,null,J,I,F));D=t.__webglObjectsImmediate;C=0;for(A=D.length;C<A;C++)I=D[C],F=I.object,F.visible&&F.castShadow&&(F._modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,F.matrixWorld),b.renderImmediateObject(B,
t.__lights,null,c,F))}z=b.getClearColor();E=b.getClearAlpha();a.clearColor(z.r,z.g,z.b,E);a.enable(a.BLEND);b.shadowMapCullFace===THREE.CullFaceFront&&a.cullFace(a.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.SpritePlugin=function(){function a(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var b,c,d,e,f,l,m,n,p,r;this.init=function(a){b=a.context;c=a;d=a.getPrecision();e=new Float32Array(16);f=new Uint16Array(6);a=0;e[a++]=-1;e[a++]=-1;e[a++]=0;e[a++]=0;e[a++]=1;e[a++]=-1;e[a++]=1;e[a++]=0;e[a++]=1;e[a++]=1;e[a++]=1;e[a++]=1;e[a++]=-1;e[a++]=1;e[a++]=0;e[a++]=1;a=0;f[a++]=0;f[a++]=1;f[a++]=2;f[a++]=0;f[a++]=2;f[a++]=3;l=b.createBuffer();m=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,l);b.bufferData(b.ARRAY_BUFFER,
e,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m);b.bufferData(b.ELEMENT_ARRAY_BUFFER,f,b.STATIC_DRAW);a=THREE.ShaderSprite.sprite;var u=b.createProgram(),z=b.createShader(b.FRAGMENT_SHADER),E=b.createShader(b.VERTEX_SHADER),C="precision "+d+" float;\n";b.shaderSource(z,C+a.fragmentShader);b.shaderSource(E,C+a.vertexShader);b.compileShader(z);b.compileShader(E);b.attachShader(u,z);b.attachShader(u,E);b.linkProgram(u);n=u;p={};r={};p.position=b.getAttribLocation(n,"position");p.uv=b.getAttribLocation(n,
"uv");r.uvOffset=b.getUniformLocation(n,"uvOffset");r.uvScale=b.getUniformLocation(n,"uvScale");r.rotation=b.getUniformLocation(n,"rotation");r.scale=b.getUniformLocation(n,"scale");r.alignment=b.getUniformLocation(n,"alignment");r.color=b.getUniformLocation(n,"color");r.map=b.getUniformLocation(n,"map");r.opacity=b.getUniformLocation(n,"opacity");r.useScreenCoordinates=b.getUniformLocation(n,"useScreenCoordinates");r.sizeAttenuation=b.getUniformLocation(n,"sizeAttenuation");r.screenPosition=b.getUniformLocation(n,
"screenPosition");r.modelViewMatrix=b.getUniformLocation(n,"modelViewMatrix");r.projectionMatrix=b.getUniformLocation(n,"projectionMatrix");r.fogType=b.getUniformLocation(n,"fogType");r.fogDensity=b.getUniformLocation(n,"fogDensity");r.fogNear=b.getUniformLocation(n,"fogNear");r.fogFar=b.getUniformLocation(n,"fogFar");r.fogColor=b.getUniformLocation(n,"fogColor");r.alphaTest=b.getUniformLocation(n,"alphaTest")};this.render=function(d,e,f,E){var C=d.__webglSprites,A=C.length;if(A){var B=p,F=r,I=E/
f;f*=0.5;var J=0.5*E;b.useProgram(n);b.enableVertexAttribArray(B.position);b.enableVertexAttribArray(B.uv);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,l);b.vertexAttribPointer(B.position,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(B.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,m);b.uniformMatrix4fv(F.projectionMatrix,!1,e.projectionMatrix.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(F.map,0);var D=B=0,P=d.fog;P?(b.uniform3f(F.fogColor,P.color.r,P.color.g,P.color.b),
P instanceof THREE.Fog?(b.uniform1f(F.fogNear,P.near),b.uniform1f(F.fogFar,P.far),b.uniform1i(F.fogType,1),D=B=1):P instanceof THREE.FogExp2&&(b.uniform1f(F.fogDensity,P.density),b.uniform1i(F.fogType,2),D=B=2)):(b.uniform1i(F.fogType,0),D=B=0);for(var M,G,K=[],P=0;P<A;P++)M=C[P],G=M.material,M.visible&&0!==G.opacity&&(G.useScreenCoordinates?M.z=-M.position.z:(M._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,M.matrixWorld),M.z=-M._modelViewMatrix.elements[14]));C.sort(a);for(P=0;P<A;P++)M=
C[P],G=M.material,M.visible&&0!==G.opacity&&(G.map&&G.map.image&&G.map.image.width)&&(b.uniform1f(F.alphaTest,G.alphaTest),!0===G.useScreenCoordinates?(b.uniform1i(F.useScreenCoordinates,1),b.uniform3f(F.screenPosition,(M.position.x*c.devicePixelRatio-f)/f,(J-M.position.y*c.devicePixelRatio)/J,Math.max(0,Math.min(1,M.position.z))),K[0]=c.devicePixelRatio,K[1]=c.devicePixelRatio):(b.uniform1i(F.useScreenCoordinates,0),b.uniform1i(F.sizeAttenuation,G.sizeAttenuation?1:0),b.uniformMatrix4fv(F.modelViewMatrix,
!1,M._modelViewMatrix.elements),K[0]=1,K[1]=1),e=d.fog&&G.fog?D:0,B!==e&&(b.uniform1i(F.fogType,e),B=e),e=1/(G.scaleByViewport?E:1),K[0]*=e*I*M.scale.x,K[1]*=e*M.scale.y,b.uniform2f(F.uvScale,G.uvScale.x,G.uvScale.y),b.uniform2f(F.uvOffset,G.uvOffset.x,G.uvOffset.y),b.uniform2f(F.alignment,G.alignment.x,G.alignment.y),b.uniform1f(F.opacity,G.opacity),b.uniform3f(F.color,G.color.r,G.color.g,G.color.b),b.uniform1f(F.rotation,M.rotation),b.uniform2fv(F.scale,K),c.setBlending(G.blending,G.blendEquation,
G.blendSrc,G.blendDst),c.setDepthTest(G.depthTest),c.setDepthWrite(G.depthWrite),c.setTexture(G.map,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE)}}};
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var a,b,c,d,e,f,l=new THREE.Frustum,m=new THREE.Matrix4;this.init=function(l){a=l.context;b=l;l=THREE.ShaderLib.depthRGBA;var p=THREE.UniformsUtils.clone(l.uniforms);c=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p});d=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p,morphTargets:!0});e=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,
vertexShader:l.vertexShader,uniforms:p,skinning:!0});f=new THREE.ShaderMaterial({fragmentShader:l.fragmentShader,vertexShader:l.vertexShader,uniforms:p,morphTargets:!0,skinning:!0});c._shadowPass=!0;d._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(n,p){var r,t,u,z,E,C;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.setDepthTest(!0);!0===n.autoUpdate&&n.updateMatrixWorld();p.matrixWorldInverse.getInverse(p.matrixWorld);m.multiplyMatrices(p.projectionMatrix,
p.matrixWorldInverse);l.setFromMatrix(m);b.setRenderTarget(this.renderTarget);b.clear();C=n.__webglObjects;r=0;for(t=C.length;r<t;r++)u=C[r],E=u.object,u.render=!1,!E.visible||(E instanceof THREE.Mesh||E instanceof THREE.ParticleSystem)&&E.frustumCulled&&!l.intersectsObject(E)||(E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,E.matrixWorld),u.render=!0);var A;r=0;for(t=C.length;r<t;r++)u=C[r],u.render&&(E=u.object,u=u.buffer,E instanceof THREE.ParticleSystem&&!E.customDepthMaterial||((A=
E.material instanceof THREE.MeshFaceMaterial?E.material.materials[0]:E.material)&&b.setMaterialFaces(E.material),z=0<E.geometry.morphTargets.length&&A.morphTargets,A=E instanceof THREE.SkinnedMesh&&A.skinning,z=E.customDepthMaterial?E.customDepthMaterial:A?z?f:e:z?d:c,u instanceof THREE.BufferGeometry?b.renderBufferDirect(p,n.__lights,null,z,u,E):b.renderBuffer(p,n.__lights,null,z,u,E)));C=n.__webglObjectsImmediate;r=0;for(t=C.length;r<t;r++)u=C[r],E=u.object,E.visible&&(E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,
E.matrixWorld),b.renderImmediateObject(p,n.__lights,null,c,E));r=b.getClearColor();t=b.getClearAlpha();a.clearColor(r.r,r.g,r.b,t);a.enable(a.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};THREE.OBJLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(a,b,c,d){var e=this;c=new THREE.XHRLoader(e.manager);c.setCrossOrigin(this.crossOrigin);c.load(a,function(a){b(e.parse(a))})},parse:function(a){function b(a,b,c){return new THREE.Vector3(a,b,c)}function c(a,b){return new THREE.Vector2(a,b)}function d(a,b,c,d){return new THREE.Face3(a,b,c,d)}function e(a,b,c,d,e){return new THREE.Face4(a,b,c,d,e)}function f(a,b){0<n.vertices.length&&(n.mergeVertices(),n.computeCentroids(),n.computeFaceNormals(),
n.computeBoundingSphere(),m.add(r),n=new THREE.Geometry,r=new THREE.Mesh(n,p),u=0);void 0!==a&&(r.name=a);void 0!==b&&(p=new THREE.MeshLambertMaterial,p.name=b,r.material=p)}a=a.replace(/\ \\\r\n/g,"");var l=new THREE.Object3D,m=l,n=new THREE.Geometry,p=new THREE.MeshLambertMaterial,r=new THREE.Mesh(n,p),t=[],u=0,z=[],E=[],C=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,A=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,B=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,
F=/f( +\d+)( +\d+)( +\d+)( +\d+)?/,I=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/,J=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/,D=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/;a=a.split("\n");for(var P=0;P<a.length;P++){var M=a[P],M=M.trim(),G;0!==M.length&&"#"!==M.charAt(0)&&(null!==(G=C.exec(M))?t.push(b(parseFloat(G[1]),parseFloat(G[2]),parseFloat(G[3]))):null!==(G=A.exec(M))?z.push(b(parseFloat(G[1]),
parseFloat(G[2]),parseFloat(G[3]))):null!==(G=B.exec(M))?E.push(c(parseFloat(G[1]),parseFloat(G[2]))):null!==(G=F.exec(M))?void 0===G[4]?(n.vertices.push(t[parseInt(G[1])-1],t[parseInt(G[2])-1],t[parseInt(G[3])-1]),n.faces.push(d(u++,u++,u++))):(n.vertices.push(t[parseInt(G[1])-1],t[parseInt(G[2])-1],t[parseInt(G[3])-1],t[parseInt(G[4])-1]),n.faces.push(e(u++,u++,u++,u++))):null!==(G=I.exec(M))?void 0===G[10]?(n.vertices.push(t[parseInt(G[2])-1],t[parseInt(G[5])-1],t[parseInt(G[8])-1]),n.faces.push(d(u++,
u++,u++)),n.faceVertexUvs[0].push([E[parseInt(G[3])-1],E[parseInt(G[6])-1],E[parseInt(G[9])-1]])):(n.vertices.push(t[parseInt(G[2])-1],t[parseInt(G[5])-1],t[parseInt(G[8])-1],t[parseInt(G[11])-1]),n.faces.push(e(u++,u++,u++,u++)),n.faceVertexUvs[0].push([E[parseInt(G[3])-1],E[parseInt(G[6])-1],E[parseInt(G[9])-1],E[parseInt(G[12])-1]])):null!==(G=J.exec(M))?void 0===G[13]?(n.vertices.push(t[parseInt(G[2])-1],t[parseInt(G[6])-1],t[parseInt(G[10])-1]),n.faces.push(d(u++,u++,u++,[z[parseInt(G[4])-1],
z[parseInt(G[8])-1],z[parseInt(G[12])-1]])),n.faceVertexUvs[0].push([E[parseInt(G[3])-1],E[parseInt(G[7])-1],E[parseInt(G[11])-1]])):(n.vertices.push(t[parseInt(G[2])-1],t[parseInt(G[6])-1],t[parseInt(G[10])-1],t[parseInt(G[14])-1]),n.faces.push(e(u++,u++,u++,u++,[z[parseInt(G[4])-1],z[parseInt(G[8])-1],z[parseInt(G[12])-1],z[parseInt(G[16])-1]])),n.faceVertexUvs[0].push([E[parseInt(G[3])-1],E[parseInt(G[7])-1],E[parseInt(G[11])-1],E[parseInt(G[15])-1]])):null!==(G=D.exec(M))?void 0===G[10]?(n.vertices.push(t[parseInt(G[2])-
1],t[parseInt(G[5])-1],t[parseInt(G[8])-1]),n.faces.push(d(u++,u++,u++,[z[parseInt(G[3])-1],z[parseInt(G[6])-1],z[parseInt(G[9])-1]]))):(n.vertices.push(t[parseInt(G[2])-1],t[parseInt(G[5])-1],t[parseInt(G[8])-1],t[parseInt(G[11])-1]),n.faces.push(e(u++,u++,u++,u++,[z[parseInt(G[3])-1],z[parseInt(G[6])-1],z[parseInt(G[9])-1],z[parseInt(G[12])-1]]))):/^o /.test(M)?(m=new THREE.Object3D,m.name=M.substring(2).trim(),l.add(m)):/^g /.test(M)?f(M.substring(2).trim(),void 0):/^usemtl /.test(M)?f(void 0,
M.substring(7).trim()):/^mtllib /.test(M)||/^s /.test(M))}f(void 0,void 0);return l}};THREE.LoadingManager=function(a,b,c){var d=this,e=0,f=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){f++};this.itemEnd=function(a){e++;if(void 0!==d.onProgress)d.onProgress(a,e,f);if(e===f&&void 0!==d.onLoad)d.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){var e=this,f=new XMLHttpRequest;void 0!==b&&f.addEventListener("load",function(c){b(c.target.responseText);e.manager.itemEnd(a)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==d&&f.addEventListener("error",function(a){d(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.open("GET",a,!0);f.send(null);e.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};(function(){var a=this,b=a.Sandbox||{},c,d=0,e=a.Sandbox=function(a){var b=this;a=_.defaults(a||{},{showGraph:!0,showNodeListing:!0,width:window.innerWidth,height:window.innerHeight,size:50,useDefault:!1,defaultStyles:!0});this.width=a.width;this.height=a.height;this.showing={value:a.showGraph,graph:a.showGraph,viewport:!a.showGraph,force:!1};this.domElement=document.createElement("div");this.domElement.classList.add(e.className,"container");var c,d,p;$(this.domElement).bind("mousemove",function(a){b.showing.value||
(c=this.getBoundingClientRect(),d=(a.clientX-c.left)/c.width,p=(a.clientY-c.top)/c.height,_.each(_.toArray(b.nodes),function(a){if(a.onMouseMove)a.onMouseMove(d,p)},b))});$(this.domElement).bind("mousedown",function(a){b.showing.value||_.each(_.toArray(b.nodes),function(a){if(a.onMouseDown)a.onMouseDown(d,p)},b)});this.wrapper=document.createElement("div");$(this.wrapper).addClass(e.className+" wrapper");_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});_.extend(this.wrapper.style,
{width:2*this.width+"px",height:this.height+"px"});this.graph=(new e.Graph({width:this.width,height:this.height,size:a.size})).appendTo(this.wrapper);this.graph.unbind("connect").unbind("disconnect").bind("preview",_.bind(function(){this.showViewport()},this)).bind("connect",_.bind(function(a,b,c){this.connectNubs(b,a,c)},this)).bind("disconnect",_.bind(function(a){var b=a.next;this.graph.background.children[b.parentId].object.inputs[b.name]=null;a.die=!0},this)).bind("focus",_.bind(function(a){this.inspector.focus(a.object)},
this));this.viewport=(new e.Viewport({parent:this,width:2*this.width,height:this.height})).appendTo(this.wrapper);this.domElement.appendChild(this.wrapper);this.inspector=(new e.Inspector({parent:this,defaultJSON:a.useDefault})).appendTo(this.domElement);this.nodes=[];this.preview=new e.Preview;this.preview.attach(this);this.viewport.inputs=this.preview.inputs;this.graph.add(this.preview);a.showGraph?this.showGraph():this.showViewport();a.showNodeListing?this.inspector.showNodeListing():this.inspector.showParamsListing();
a.defaultStyles&&(a=document.createElement("style"),a.innerHTML=e.defaultStyles,document.body.appendChild(a))};_.extend(e,{noConflict:function(){a.Sandbox=b;return this},className:"sb",aspectRatio:16/9,defaultStyles:'body.dragging,body.dragging.drag-enabled,body.dragging *,body.dragging.drag-enabled *,.inner-dom{-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;-o-user-select:none !important;user-select:none !important;cursor:-webkit-grabbing}body.dragging .frame,body.dragging.drag-enabled .frame,body.dragging * .frame,body.dragging.drag-enabled * .frame,.inner-dom .frame{cursor:-webkit-grabbing}body.drag-enabled{cursor:-webkit-grab}*{margin:0;padding:0}.sb.container{position:relative;overflow:hidden;z-index:1000;top:0;left:0;right:0;bottom:0}.sb.container *{letter-spacing:0;font-family:times,serif}.sb.wrapper{position:relative;-webkit-transition:left 350ms cubic-bezier(0.075,0.82,0.165,1);-moz-transition:left 350ms cubic-bezier(0.075,0.82,0.165,1);transition:left 350ms cubic-bezier(0.075,0.82,0.165,1)}.connection{cursor:pointer !important}.connection.agent,.glow,.fo,foreignobject,foreignObject{pointer-events:none}.context-menu,.context-label{position:absolute;top:-1000px;left:-1000px;width:150px;font-family:"Lucida Grande",sans-serif;font-style:normal;font-size:10px;letter-spacing:0;color:#333;line-height:20px;background:white;box-shadow:0 0 20px black;border:2px solid white;z-index:9999}.context-menu ul li,.context-label ul li{list-style:none;padding-left:15px;cursor:pointer}.context-menu ul li:hover,.context-label ul li:hover{background:rgba(0,0,0,0.1)}.context-menu .nub,.context-label .nub{position:absolute;bottom:-13px;left:50%;margin-left:-6px;height:0;width:0;border-color:transparent;border-style:solid;border-width:6px;border-top-color:white}.tool-tip{pointer-events:none;position:absolute;top:-10000px;left:-10000px;font-family:"Lucida Grande",sans-serif;font-style:normal;font-size:10px;letter-spacing:0;color:#333;line-height:20px;background:white;box-shadow:0 0 20px black;border:2px solid white;z-index:9999;padding:0 15px}.tool-tip:after{position:absolute;top:50%;right:-13px;margin-top:-6px;height:0;width:0;border-color:transparent;border-style:solid;border-width:6px;border-left-color:white;content:""}.context-label{content:" ";width:auto;padding:0 12.5px;text-transform:capitalize;min-width:50px;text-align:center}@-webkit-keyframes glow{from{box-shadow:0 0 0 #ff3f3f}to{box-shadow:0 0 18px #ff3f3f}}@-moz-keyframes glow{from{box-shadow:0 0 0 #ff3f3f}to{box-shadow:0 0 18px #ff3f3f}}@-o-keyframes glow{from{box-shadow:0 0 0 #ff3f3f}to{box-shadow:0 0 18px #ff3f3f}}@keyframes glow{from{box-shadow:0 0 0 #ff3f3f}to{box-shadow:0 0 18px #ff3f3f}}.inner-dom{cursor:-webkit-grab;width:100%;height:100%;overflow:hidden;background:#191919;line-height:0}.inner-dom .preview p{display:inline-block;vertical-align:baseline;zoom:1;*display:inline;*vertical-align:auto;line-height:25px;vertical-align:top}.inner-dom .preview p:hover{color:#ff3f3f}.inner-dom .preview p:hover:before{background-image:url(./images/hover/viewport.svg)}.inner-dom .preview p:before{display:inline-block;vertical-align:baseline;zoom:1;*display:inline;*vertical-align:auto;width:25px;height:25px;background:url(./images/viewport.svg) center center no-repeat;content:""}.inner-dom .description{min-width:128px;min-height:210px;padding:10px 0 0 10px;z-index:9999;color:#fff;line-height:25px}.inner-dom .description span:hover{color:#ff3f3f}.inner-dom .description.s-video{background:red !important}.inner-dom .description.s-data{background:green !important}.inner-dom .description.s-shader{background:blue !important}.inner-dom .description i.info{margin-bottom:20px;text-align:center;display:block;width:12px;height:12px;line-height:18px;overflow:hidden;text-indent:-9999px;background:black;border-radius:50%}.inner-dom .description i.info:hover{background:#ff3f3f}.inner-dom .description i.info.enabled{background:#ff3f3f;-webkit-animation-name:glow;-moz-animation-name:glow;animation-name:glow;-webkit-animation-duration:750ms;-moz-animation-duration:750ms;animation-duration:750ms;-webkit-animation-timing-function:ease-out;-moz-animation-timing-function:ease-out;animation-timing-function:ease-out;-webkit-animation-direction:alternate;-moz-animation-direction:alternate;animation-direction:alternate;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;animation-iteration-count:infinite}g g g:hover .inner-dom .description{display:block}g g g:hover .inner-dom img,g g g:hover .inner-dom canvas,g g g:hover .inner-dom video{display:none}.sb.graph{position:relative;width:100%;height:100%;background-color:#191919}.sb.graph .frame{cursor:-webkit-grab}.sb.viewport{position:absolute;top:0;left:0;right:0;bottom:0}.sb.viewport,.sb.viewport *{pointer-events:none}.sb.inspector{position:absolute;right:0;top:0;bottom:0;width:25px;overflow:visible;line-height:18px;color:white}.sb.inspector h1,.sb.inspector h2,.sb.inspector h3,.sb.inspector h4,.sb.inspector h5,.sb.inspector h6{font-weight:normal}.sb.inspector:not(.hide-drawer):hover .drawer,.sb.inspector:not(.hide-drawer) .drawer.enabled{left:-300px}.sb.inspector .add,.sb.inspector .home,.sb.inspector .share,.sb.inspector .fullpage,.sb.inspector .fullscreen,.sb.inspector .switch{position:relative;overflow:visible;width:25px;height:18px;margin:15px 0 32px 0}.sb.inspector .add{height:18px;background:url(./images/plus.svg) center center no-repeat}.sb.inspector .add:hover,.sb.inspector .add.enabled{background-image:url(./images/hover/plus.svg)}.sb.inspector .home{height:18px;background:url(./images/toggle.svg) center center no-repeat}.sb.inspector .home:hover,.sb.inspector .home.enabled{background-image:url(./images/hover/toggle.svg)}.sb.inspector .share{margin-left:2px;height:18px;background:url(./images/link.svg) center center no-repeat}.sb.inspector .share:hover,.sb.inspector .share.enabled{background-image:url(./images/hover/link.svg)}.sb.inspector .fullpage{height:18px;background:url(./images/fullpage.svg) center center no-repeat}.sb.inspector .fullpage:hover,.sb.inspector .fullpage.enabled{background-image:url(./images/hover/fullpage.svg)}.sb.inspector .fullscreen{height:18px;background:url(./images/fullscreen.svg) center center no-repeat}.sb.inspector .fullscreen:hover,.sb.inspector .fullscreen.enabled{background-image:url(./images/hover/fullscreen.svg)}.sb.inspector .fullscreen.set{background:url(./images/i-fullscreen.svg) center center no-repeat}.sb.inspector .fullscreen.set:hover,.sb.inspector .fullscreen.set.enabled{background-image:url(./images/hover/i-fullscreen.svg)}.sb.inspector .switch{height:18px;background:url(./images/viewport.svg) center center no-repeat}.sb.inspector .switch:hover,.sb.inspector .switch.enabled{background-image:url(./images/hover/viewport.svg)}.sb.inspector .switch.viewport{height:18px;background:url(./images/graph.svg) center center no-repeat}.sb.inspector .switch.viewport:hover,.sb.inspector .switch.viewport.enabled{background-image:url(./images/hover/graph.svg)}.sb.inspector div.number{overflow:hidden}.sb.inspector div.string textarea{margin:0 0 0 20px;width:139px;height:200px;display:block;background:#3b3b3b;color:white;font-size:13px;line-height:18px;border:0;padding:0 10px;resize:none;outline:0}.sb.inspector div.number div.slider{display:inline-block;vertical-align:baseline;zoom:1;*display:inline;*vertical-align:auto;position:relative;line-height:0;width:60%;line-height:15px;height:18px;background:rgba(255,255,255,0.1);vertical-align:top;cursor:ew-resize}.sb.inspector div.number div.slider div.fg{background:rgba(255,255,255,0.1);border-right:1px solid rgba(255,255,255,0.5);height:100%;top:0;left:0;bottom:0;width:0}.sb.inspector div.number input[type="text"],.sb.inspector div.string input[type="text"]{color:white;margin-left:12px;font-size:85%;height:16px;border:0;background:transparent;border-bottom:1px solid #bbb;text-align:right;width:20%;outline:0}.sb.inspector .drawer{position:absolute;height:100%;width:300px;background:#0f0f0f;-webkit-transition:left 350ms cubic-bezier(0.075,0.82,0.165,1);-moz-transition:left 350ms cubic-bezier(0.075,0.82,0.165,1);transition:left 350ms cubic-bezier(0.075,0.82,0.165,1)}.sb.inspector .drawer ul.params-listing,.sb.inspector .drawer ul.node-listing{position:absolute;top:0;left:0;right:0;bottom:0;overflow:auto}.sb.inspector .drawer ul.params-listing li.shell,.sb.inspector .drawer ul.node-listing li.shell{margin:0 !important;padding:0 !important;border:0 !important}.sb.inspector .drawer ul.params-listing li.shell:hover,.sb.inspector .drawer ul.node-listing li.shell:hover{background:transparent}.sb.inspector .drawer ul.params-listing li:not(:first-child){cursor:default}.sb.inspector .drawer ul.params-listing li.function{cursor:pointer}.sb.inspector .drawer li h3{letter-spacing:1px;font-size:100%;vertical-align:top;position:relative}.sb.inspector .drawer li h3 div.delete{position:absolute;top:3px;right:30px;width:10px;height:10px;text-indent:-9999px;cursor:pointer;background:url(./images/x.svg) center center no-repeat;content:""}.sb.inspector .drawer li h3 div.delete:hover{background-image:url(./images/hover/x.svg)}.sb.inspector .drawer li.param{font-style:italic;overflow:hidden}.sb.inspector .drawer li.param:hover{overflow:visible}.sb.inspector .drawer li.param:hover label+div.string{overflow:visible}.sb.inspector .drawer .io-0-1{padding-left:60px;background:url(./images/nodes/0-1.svg) 25px center no-repeat}.sb.inspector .drawer .io-1-1{padding-left:60px;background:url(./images/nodes/1-1.svg) 25px center no-repeat}.sb.inspector .drawer .io-2-1{padding-left:60px;background:url(./images/nodes/2-1.svg) 25px center no-repeat}.sb.inspector .drawer .io-3-1{padding-left:60px;background:url(./images/nodes/3-1.svg) 25px center no-repeat}.sb.inspector .drawer label{cursor:pointer;width:25%;text-transform:capitalize;text-overflow:ellipsis;letter-spacing:1px;font-size:15px}.sb.inspector .drawer label,.sb.inspector .drawer label+*{display:inline-block;vertical-align:baseline;zoom:1;*display:inline;*vertical-align:auto;overflow:hidden;height:18px;vertical-align:top}.sb.inspector .drawer label+*{width:75%}.sb.inspector .drawer ul{list-style:none}.sb.inspector .drawer ul li{letter-spacing:1px;padding:15px 0 16px 25px;border-bottom:1px solid rgba(255,255,255,0.1)}.sb.inspector .drawer ul li:not(:first-child){cursor:pointer}.sb.inspector .drawer ul li:not(:first-child):hover{background-color:rgba(255,255,255,0.1)}.sb.inspector .drawer ul li:first-child{border-bottom-color:rgba(255,255,255,0.2)}.sb.inspector .panel{position:absolute;top:0;left:0;right:0;bottom:0;background:#191919;text-align:center;list-style:none;padding:0;font-size:12px}.sb.inspector .panel li.enabled,.sb.inspector .panel li:hover{color:#ff3f3f}.sb.inspector .panel li{cursor:pointer}.sb.inspector .panel li.fullpage{position:absolute;margin:0;bottom:115px}.sb.inspector .panel li.fullscreen{position:absolute;margin:0;bottom:65px}.sb.inspector .panel li.switch{position:absolute;margin:0;bottom:15px}.url-context-menu{display:none;opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transition:opacity 150ms ease-out;-moz-transition:opacity 150ms ease-out;transition:opacity 150ms ease-out;color:white}.url-context-menu .backdrop{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,0.25)}.url-context-menu .loader{position:absolute;top:0;left:0;width:100%;height:100%}.url-context-menu .loader .content{padding-top:40px}.url-context-menu .container{position:absolute;width:500px;height:165px;top:50%;left:50%;margin-left:-250px;margin-top:-82px;background:black;box-shadow:0 0 20px rgba(0,0,0,0.5);text-align:center;border:1px solid #444}.url-context-menu .container>div{padding:30px 25px 25px}.url-context-menu .container div.divider{width:25%;border-bottom:1px solid #666;content:"";height:0;margin:0 auto}.url-context-menu .container p{letter-spacing:1px;margin-bottom:25px}.url-context-menu .container input{color:white;font-size:100%;font-family:times,serif;display:inline-block;vertical-align:baseline;zoom:1;*display:inline;*vertical-align:auto;margin-top:25px;border:0;border-bottom:1px solid #bbb;outline:0;letter-spacing:1px;width:60%;background:transparent}svg .preset{cursor:pointer;opacity:.9;-webkit-transition:opacity .35s ease-out;-moz-transition:opacity .35s ease-out;transition:opacity .35s ease-out}svg .preset:hover{opacity:1.0}',
uniqueId:function(a){var b=Date.now();c===b?(b+="-"+d,d++):(c=b,d=0);return _.isString(a)?a+b:b},Nodes:{}});_.extend(e.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.domElement);this.container=a;this.json&&(this.loadJSON(this.json),_.isFunction(this.__callback)&&this.__callback(),delete this.json,delete this.__callback);return this},add:function(a){a.attach(this);_.isFunction(a.resize)&&a.resize(this.width,this.height);this.graph.add(a);this.nodes.push(a);this.inspector.add(a);
return this},remove:function(a){var b=_.indexOf(this.nodes,a);a.destroy();if(0>b)return this;this.nodes.splice(b,1);this.graph.remove(a);this.inspector.remove(a);return this},clear:function(){_.each(_.toArray(this.nodes),function(a){this.remove(a)},this);this.preview.inputs.buffer=null;this.inspector.__focused=!1;return this},connectNubs:function(a,b,c){var d=this.graph.background.children[a.parentId].object,e=this.graph.background.children[b.parentId].object,r=a.name;d.inputs[r]&&(d.inputs[r]=null,
this.graph.clearNub(a));this.graph.connectNubs(b,a,c);d.inputs[r]=e.outputs[b.name];return this},connect:function(a,b,c,d,e){var r=_.isString(a),t=_.isString(c),u=p2=a;r&&t&&(u=a,p2=c,c=d,d=e);a=this.graph.getShapeByObject(b);e=this.graph.getShapeByObject(c);this.graph.connectNubs(e.outputs[p2],a.inputs[u],!!d);b.inputs[u]&&this.disconnect(u,b,b.inputs[u].__parentNode);b.inputs[u]=c.outputs[p2];return this},disconnect:function(a,b,c,d){var e=this.graph.getShapeByObject(b);c=this.graph.getShapeByObject(c);
d=d||this.graph.getConnection(c.outputs[a],e.inputs[a]);if(!d)return this;d.die=!0;b.inputs[a]=null;return this},setSize:function(a,b){this.width=Math.min(a,2048);this.height=this.width/e.aspectRatio;this.graph.setSize(this.width,this.height);this.viewport.setSize(2*this.width,this.height);_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});_.extend(this.wrapper.style,{width:2*this.width+"px",height:this.height+"px"});this.showing.value||(this.wrapper.style.left=-this.width+
"px");return this},update:function(){this.viewport.renderer.clearTarget();_.each(this.nodes,function(a){a.update()});this.preview.update();this.showing.viewport&&this.viewport.update();(this.showing.graph||this.showing.force)&&this.graph.update();return this},showViewport:function(){var a=this;this.showing.graph=!0;this.showing.viewport=!0;clearTimeout(this.__timeout);this.__timeout=setTimeout(function(){a.showing.graph=!1;a.showing.viewport=!0},e.transitionDuration);this.showing.value=!1;_.extend(this.wrapper.style,
{left:-this.width+"px"});this.inspector.showParamsListing();return this.trigger("viewport")},showGraph:function(){var a=this;this.showing.graph=!0;this.showing.viewport=!0;clearTimeout(this.__timeout);this.__timeout=setTimeout(function(){a.showing.graph=!0;a.showing.viewport=!1},e.transitionDuration);this.showing.value=!0;_.extend(this.wrapper.style,{left:0});return this.trigger("graph")},toggle:function(){this.showing.value?this.showViewport():this.showGraph();return this},setJSON:function(a,b){this.json=
a;_.isFunction(b)&&(this.__callback=b);return this},loadJSON:function(a){this.clear();_.isString(a)&&(a=JSON.stringify(JSON));this.preview.setId(a.output.id);this.graph.setPosition(this.preview,a.output.position);_.each(a.nodes,function(a){var b=new e.Nodes[a.property];b.setId(a.id);b.setParams(a.params);this.add(b);this.graph.setPosition(b,a.position)},this);_.each(a.connections,function(a){var b=this.getNodeById(a.input.id),c=this.getNodeById(a.output.id);this.connect(a.input.property,b,a.output.property,
c)},this);this.showing.force=!0;_.delay(_.bind(function(){this.showing.force=!1},this),1E3);return this},toJSON:function(a){var b={output:{id:this.preview.id,position:this.graph.getPosition(this.preview)},connections:_.map(this.graph.getConnections(),function(a){return{input:{id:graph.background.children[a.next.parentId].object.id,property:a.next.name},output:{id:graph.background.children[a.prev.parentId].object.id,property:a.prev.name}}}),nodes:_.map(this.nodes,function(a){var b;a:{for(b in e.Nodes)if(a instanceof
e.Nodes[b])break a;b=null}return{property:b,id:a.id,params:a.extractParams(),position:this.graph.getPosition(a)}})};return a?JSON.stringify(b):b},getNodeById:function(a){if(a===this.preview.id)return this.preview;for(var b in this.nodes){var c=this.nodes[b];if(c.id===a)return c}return null}});_.uniqueId=e.uniqueId})();(function(){$(window);var a=Sandbox.Viewport=function(b){b=_.defaults(b||{},{width:1920,height:1080});this.width=b.width;this.height=b.height;this.domElement=document.createElement("div");$(this.domElement).addClass(a.className+" "+Sandbox.className);this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,antialias:!1});this.renderer.setClearColor(new THREE.Color(0),0);this.renderer.autoClear=!1;this.domElement.appendChild(this.renderer.domElement);this.setSize(this.width,this.height);this.camera=
new THREE.OrthographicCamera(-1,1,1,-1,-1,1);this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),new THREE.MeshBasicMaterial({map:null}));this.scene=new THREE.Scene;this.scene.add(this.quad);this.inputs={buffer:null}};_.extend(a,{className:"viewport"});_.extend(a.prototype,{appendTo:function(a){a.appendChild(this.domElement);return this},setSize:function(a,c){this.width=a;this.height=c;this.renderer.setSize(a/(window.devicePixelRatio||1),c/(window.devicePixelRatio||1));_.extend(this.domElement.style,
{width:a+"px",height:c+"px"});_.extend(this.renderer.domElement.style,{width:a+"px",height:c+"px"});return this},update:function(){this.inputs.buffer&&this.render(this.inputs.buffer,this.width/2,0,this.width/2,this.height);return this},render:function(a,c,d,e,f){this.quad.material.map=a;this.renderer.setViewport(c,this.height-f-d,e,f);this.renderer.render(this.scene,this.camera);return this}})})();(function(){function a(a,b,c){a=a.connections.children;for(var d in a){var e=a[d];if(e[c]&&e[c].id===b.id)return!0}return!1}var b=Sandbox,c=document.createElement("canvas"),d=$(window),e=$(document.body),f=new Two.Vector,l=/^(buffer|texture|video)$/ig,m=/^(scene|data)$/ig;$(function(){d=$(window);e=$(document.body);d.scroll(function(){f.set(d.scrollLeft(),d.scrollTop())})});var n=b.Graph=function(a){var b=graph=this;a=_.defaults(a||{},{size:50});this.size=a.size;this.domElement=document.createElement("div");
this.two=(new Two({width:a.width,height:a.height})).appendTo(this.domElement);_.extend(this.domElement.style,{width:a.width+"px",height:a.height+"px"});this.inputs=[];this.outputs=[];this.shouldRender=this.needsReset=!0;Object.defineProperty(this,"width",{get:function(){return this.two.width},set:function(a){this.setSize(a,this.height)}});Object.defineProperty(this,"height",{get:function(){return this.two.height},set:function(a){this.setSize(this.width,a)}});_.extend(this.two.renderer.domElement.style,
{position:"absolute"});n.InitializeGraph(this);this.bind("connect",this.connect).bind("disconnect",this.disconnect);var c=new Two.Vector;this.two.bind("update",function(a,d){graph.dragging&&graph.needsReset&&(graph.needsReset=!1);var e=b.connection.vertices[1];e.addSelf(c.copy(e.destination).subSelf(e).multiplyScalar(0.3));e.equals(b.connection.vertices[0])&&b.connection.visible&&(b.connection.visible=!1);_.each(b.connections.children,function(a){if(a.visible&&a.domElement&&a!==b.connection){if(a.die&&
(a.opacity-=0.3*a.opacity,a.fillament.opacity=a.opacity,0.001>=a.opacity&&a.visible)){b.disconnect(a);return}if(!a.die&&a.opacity!==a.__opacity){var d=a.__opacity-a.opacity;0.01>Math.abs(d)?a.opacity=a.__opacity:a.opacity+=0.125*d}var d=a.vertices[0],e=a.vertices[3];d.destination&&(d.addSelf(c.copy(d.destination).subSelf(d).multiplyScalar(0.3)),d.equals(d.destination)&&delete d.destination);e.destination&&(e.addSelf(c.copy(e.destination).subSelf(e).multiplyScalar(0.3)),e.equals(e.destination)&&delete e.destination);
d=a.domElement.getTotalLength();a.fillament.translation.copy(a.domElement.getPointAtLength(d*a.fillament.t));a.fillament.t+=10/d;0.99<a.fillament.t&&(a.fillament.t=0)}});_.each(b.background.children,function(a){var b=a.object;_.isFunction(b.update)&&b.update();a.destination&&a.translation.addSelf(c.copy(a.destination).subSelf(a.translation).multiplyScalar(0.3))})})};_.extend(n,{className:"graph",Threshold:{distance:{x:160,y:70}},Colors:{content:"white",active:"rgb(255, 63, 63)",background:"#333"},
Templates:{description:'<div class="description s-<%= type %>"><span><%= name %></span></div>',preview:'<div class="preview description s-<%= type %>"><p><%= name %></p></div>',image:"",canvas:"",video:""},ContextLabel:{domElement:document.createElement("div"),show:function(a,b,c){var d=n.ContextLabel.domElement;d.querySelector(".content").innerHTML=c.replace(/[0-9]/ig,"");_.defer(function(){var c=d.getBoundingClientRect();_.extend(d.style,{display:"block",top:b-c.height-20+"px",left:a-c.width/2+
"px"})})},hide:function(){_.extend(n.ContextLabel.domElement.style,{top:"-1000px",left:"-1000px"})}},ContextMenu:{domElement:document.createElement("div"),show:function(a,b,c){var e=$(n.ContextMenu.domElement.querySelector(".remove")),f=function(a){n.ContextMenu.hide();d.unbind("click",f);e.unbind("click",c)},l=n.ContextMenu.domElement.getBoundingClientRect();_.extend(n.ContextMenu.domElement.style,{display:"block",top:b-l.height-10+"px",left:a-l.width/2+"px"});_.defer(function(){d.bind("click",f)});
e.bind("click",c)},hide:function(){_.extend(n.ContextMenu.domElement.style,{top:"-1000px",left:"-1000px"})}},GetCommonProperty:function(a,b){for(var c in a.object.outputs)for(var d in b.object.inputs)if(c===d)return c;return null},ApplyConnectionStyles:function(a,b){var c=b.two;a.fill="none";a.stroke=n.Colors.active;a.linewidth=3;a.fillament=c.makeCircle(0,0,2);a.fillament.noStroke().fill="white";a.fillament.t=0;a.visible=a.fillament.visible=!1;a.domElement=document.querySelector("#two-"+a.id);a.domElement&&
a.domElement.setAttribute("class","connection");a.__opacity=1;$(a.domElement).bind("click",function(c){c.preventDefault();n.ContextMenu.show(c.clientX+e.scrollLeft(),c.clientY+e.scrollTop(),function(){b.trigger("disconnect",a)})})},InitializeGraph:function(a){var b=a.size,c=a.two;$(a.domElement).addClass(n.className+" "+Sandbox.className);n.CreateGrid(a.domElement,b);a.connection=c.makeLine(0,0,0,0);n.ApplyConnectionStyles(a.connection,a);a.connection.fillament.remove();a.connection.vertices[1].destination=
(new Two.Vector).copy(a.connection.vertices[1]);a.connections=c.makeGroup();a.background=c.makeGroup()},GenerateDOM:function(a){var b=document.createElement("div");b.classList.add("inner-dom");b.style.visibility="visible";b.innerHTML=a;return b},CreateGrid:function(a,b){c.width=c.height=b;var d=c.getContext("2d");d.clearRect(0,0,b,b);d.strokeStyle="rgba(255, 255, 255, 0.15)";d.beginPath();d.moveTo(b,0);d.lineTo(b,b);d.lineTo(0,b);d.stroke();_.extend(a.style,{backgroundImage:"url("+c.toDataURL("image/png")+
")",backgroundRepeat:"repeat"})},CreateNub:function(a){var b=a.width;height=a.height;pct=a.pct;bleed=a.bleed;spread=a.spread;graph=a.graph;two=graph.two;color=a.color;group=a.group;k=a.k;v=a.v;i=a.i;x=(isInput=a.isInput)?-b/2:b/2;y=pct*spread-spread/2;a=two.makeCircle(x,y,bleed);a.linewidth=bleed;a.stroke=color;a.fill=n.Colors.background;b=two.makeCircle(x,y,bleed+bleed);b.noFill().stroke="rgba(255, 255, 255, 0.66)";b.linewidth=7;b.elem=two.renderer.domElement.querySelector("#two-"+b.id);b.elem.classList.add("glow");
b.visible=!1;a.isInput=isInput;a.parentId=group.id;a.name=k;a.elem=two.renderer.domElement.querySelector("#two-"+a.id);$(a.elem).addClass("frame nub");a.glow=b;return a},CreateElement:function(b,c){var t=n.Colors.content,u=b.two,z=$(b.domElement),E=c.name===Sandbox.Preview.prototype.name?250:150,C=E/Sandbox.aspectRatio,A=u.makeGroup(),B=u.makeRectangle(0,0,E,C).noStroke(),F=u.makeRectangle(0,0,E-8,C-8).noStroke(),I=u.renderer.domElement.querySelector("#two-"+B.id);$(I).addClass("frame nub");B.fill=
t;A.shouldRender=!0;u.renderer.domElement.querySelector("#two-"+F.id).classList.add("fo");var J=_.size(c.inputs),D=0,P={},M=0.75*C;_.each(c.inputs,function(a,c){var d=n.CreateNub({i:D,k:c,v:a,graph:b,group:A,width:E,height:C,pct:(D+1)/(J+1),color:t,spread:M,bleed:4,isInput:!0});$(d.elem).bind("mousedown",function(a){isInput=!0;O.call(d,a)}).bind("mouseup",function(a){b.__nub=d}).hover(function(a){a=d.elem.getBoundingClientRect();n.ContextLabel.show(a.left+a.width/2,a.top+a.height/2+e.scrollTop(),
d.name)},function(){n.ContextLabel.hide()});b.inputs.push(d);P[c]=d;D++});var J=_.size(c.outputs),D=0,G={};_.each(c.outputs,function(a,c){var d=n.CreateNub({i:D,k:c,v:a,graph:b,group:A,width:E,height:C,pct:(D+1)/(J+1),color:t,spread:M,bleed:4,isInput:!1});$(d.elem).bind("mousedown",function(a){isInput=!1;O.call(d,a)}).bind("mouseup",function(a){b.__nub=d}).hover(function(a){a=d.elem.getBoundingClientRect();n.ContextLabel.show(a.left+a.width/2,a.top+a.height/2+e.scrollTop(),d.name)},function(){n.ContextLabel.hide()});
b.outputs.push(d);G[c]=d;D++});_.each(P,function(a){A.add(a.glow)});_.each(G,function(a){A.add(a.glow)});A.add(B).add(_.toArray(P)).add(_.toArray(G)).add(F);A.translation.set(u.width/2,u.height/2);A.destination=(new Two.Vector).copy(A.translation);var K=new Two.Vector,Y=function(a){a.preventDefault();b.shouldRender=!1;var c=a.clientX-K.x+f.x,d=a.clientY-K.y+f.y;a.shiftKey&&(c=n.SnapTo(c,b.size),d=n.SnapTo(d,b.size));A.destination.set(c,d)},T=function(a){a.preventDefault();b.shouldRender=!0;document.body.classList.remove("dragging");
d.unbind("mousemove",Y).unbind("mouseup",T)};$(u.renderer.domElement.querySelector("#two-"+A.id)).hover(function(){A.shouldRender=!1},function(){A.shouldRender=!0});A.mousedown=function(a){a.preventDefault();scrollTop=e.scrollTop();document.body.classList.add("dragging");var b=z.offset();K.x=b.left+a.clientX+f.x-(b.left+A.translation.x);K.y=b.top+a.clientY+f.y-(b.top+A.translation.y);d.bind("mousemove",Y).bind("mouseup",T)};$(I).bind("mousedown",A.mousedown);var O=function(a){a.preventDefault();document.body.classList.add("dragging");
c=this;b.dragging=!0;b.__nub=void 0;c.fill=n.Colors.active;b.needsReset=!0;a=c.isInput?"outputs":"inputs";_.each(b.connections.children,function(a){a.__opacity=0.33});var e=c.name.replace(/[0-9]/ig,"");_.each(b[a],function(a){var b=a.name.replace(/[0-9]/ig,""),d=e==b,b=e.match(l)&&b.match(l);(d||b)&&a.parentId!==c.parentId&&(a.glow.visible=!0)});var f=(new Two.Vector).copy(c.translation).addSelf(A.translation);b.connection[isInput?"next":"prev"]=A;_.each(b.connection.vertices,function(a){a.copy(f);
a.destination&&a.destination.copy(f)});a=z.offset();K.set(a.left,a.top);d.bind("mousemove",fa).bind("mouseup",S)},fa=function(a){a.preventDefault();var c=a.clientX-K.x+f.x;a=a.clientY-K.y+f.y;b.connection.visible=!0;b.connection.vertices[1].destination.set(c,a)},S=function(e){e.preventDefault();document.body.classList.remove("dragging");b.dragging=!1;d.unbind("mousemove",fa).unbind("mouseup",S);var f=new Two.Vector;new Two.Vector;f.x=e.clientX-K.x;f.y=e.clientY-K.y;b.connection.vertices[1].destination.copy(b.connection.vertices[0]);
_.each(b.connections.children,function(a){a.__opacity=1});_.each(b[c.isInput?"outputs":"inputs"],function(a){a.glow.visible=!1});var l=b.__nub;if(l&&c.isInput!==l.isInput){e=c;f=l;l.isInput&&(e=l,f=c);var t=e.name.replace(/[0-9]/ig,""),u=f.name.replace(/[0-9]/ig,""),l=t==u,t=t.match(m)||u.match(m);if((l||!t)&&e.parentId!==f.parentId){b.connection.vertices[0].clear();b.connection.vertices[1].clear();b.connection.vertices[1].destination.clear();delete b.connection.prev;delete b.connection.next;b.trigger("connect",
f,e,!0);return}}a(b,c,c.isInput?"next":"prev")||(c.fill=n.Colors.background);delete b.connection.prev;delete b.connection.next};A.inputs=P;A.outputs=G;A.content=F;b.background.add(A);return A},InjectHTML:function(a,b,c){var d=b.content.getBoundingClientRect(),d=Two[Two.Types.svg].Utils.createElement("foreignObject",{x:-d.width/2,y:-d.height/2,width:d.width,height:d.height});c=n.GenerateDOM(c);$(d).bind("mousedown",b.mousedown);$(c.querySelector("span")).css("cursor","pointer").bind("click",function(c){c.preventDefault();
c.stopPropagation();a.trigger("focus",b)});$(c.querySelector("p")).css("cursor","pointer").bind("click",function(b){a.trigger("preview")});d.appendChild(c);b.domElement.appendChild(d)},SnapTo:function(a,b){return Math.round(a/b)*b}});_.extend(n.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.domElement);return this},setSize:function(a,b){$(this.domElement).width(a).height(b);this.two.width=a;this.two.height=b;this.two.renderer.setSize(a,b);return this},add:function(a){var b=this,
c=n.CreateElement(this,a);c.object=a||{};c.domElement=this.two.renderer.domElement.querySelector("#two-"+c.id);_.isUndefined(c.object.html)||n.InjectHTML(this,c,c.object.html);a.bind("update",function(){if(a.renderer&&(b.shouldRender&&c.shouldRender)&&a.buffer){var d=c.content.getBoundingClientRect();a.viewport.render(a.buffer,d.left,d.top,d.width,d.height)}});this.disperse(c);return c},remove:function(a){a=this.getShapeByObject(a);_.each(a.inputs,function(a){this.clearNub(a)},this);_.each(a.outputs,
function(a){this.clearNub(a)},this);a.remove();return this},clearNub:function(a){_.each(this.connections.children,function(b){if(a.isInput&&b.next&&b.next.id===a.id||!a.isInput&&b.prev&&b.prev.id===a.id)b.die=!0},this);return this},connectNubs:function(a,b,c){var d=this.two,e=this.background.children[a.parentId],f=this.background.children[b.parentId],l=a.translation,m=b.translation;a.fill=b.fill=n.Colors.active;var B=[new Two.Vector,new Two.Vector,new Two.Vector,new Two.Vector],d=d.makeCurve(B,!0);
n.ApplyConnectionStyles(d,this);d.fillament.visible=d.visible=!0;c&&(B[0].destination=new Two.Vector,B[3].destination=new Two.Vector);c=function(){var a=B[3].destination?B[3].destination:B[3];(B[0].destination?B[0].destination:B[0]).copy(e.translation);a.copy(f.translation);B[1].copy(l).addSelf(e.translation);B[2].copy(m).addSelf(f.translation)};f.translation.bind(Two.Events.change,c);e.translation.bind(Two.Events.change,c);c();c=Math.atan2(B[2].y-B[1].y,B[2].x-B[2].y);var F=l.length()/10,I=F*Math.cos(c)+
B[2].x,J=F*Math.sin(c)+B[2].y;B[3].set(I,J);c+=Math.PI;I=F*Math.cos(c)+B[1].x;J=F*Math.sin(c)+B[1].y;B[0].set(I,J);d.next=b;d.prev=a;this.connections.add(d,d.fillament);return d},disconnect:function(b){b.fillament.visible=b.visible=!1;b.remove();b.fillament.remove();a(this,b.prev,"prev")||(b.prev.fill=n.Colors.background);a(this,b.next,"next")||(b.next.fill=n.Colors.background);return this},disperse:function(a){if(a.__set)return this;var b=new Two.Vector,c;for(c in this.background.children){var d=
this.background.children[c];if(a.id!==d.id&&(b.copy(a.destination).subSelf(d.destination),!(b.length()>n.Threshold.distance.x))){c=Math.atan2(b.y,b.x);d=Math.floor(3*Math.random())/2;c+=d*Math.PI-Math.PI/2;a.destination.x+=(n.Threshold.distance.x-Math.abs(b.x))*Math.cos(c);a.destination.y+=(n.Threshold.distance.y-Math.abs(b.y))*Math.sin(c);_.defer(_.bind(this.disperse,this,a));break}}return this},update:function(){this.two.update();return this},getShapeByObject:function(a){var b=this.background.children,
c;for(c in b){var d=b[c];if(d.object.id===a.id)return d}return null},getConnection:function(a,b){var c=a.id,d=b.id,e=this.connections.children,f;for(f in e){var l=e[f];if(l.next&&l.prev&&l.next.id===d&&l.prev.id===c)return l}return null},getConnections:function(a){var b=[];_.each(this.connections.children,function(a){(a.next||a.prev)&&b.push(a)});a&&b.splice(0,1);return b},getPosition:function(a){return(a=this.getShapeByObject(a))?{x:Math.round(a.translation.x),y:Math.round(a.translation.y)}:null},
setPosition:function(a,b){var c=this.getShapeByObject(a);if(!c)return this;c.destination.copy(b);c.__set=!0;return this},cascade:function(a){var b=this.background.children;_.size(b);var c=0,d=0,e=0,f=0;_.each(b,function(a){a=a.getBoundingClientRect();e+=a.width/2;f+=a.height/2});c=(this.width-e)/2;d=(this.height-f)/2;_.each(b,function(b){var e=b.getBoundingClientRect();b.destination.set(a?n.SnapTo(c,this.size):c,a?n.SnapTo(d,this.size):d);c+=e.width/2;d+=e.height/2},this);return this},lineup:function(a){var b=
this.size,c=this.background.children;_.size(c);var d=0,e=b,f=0;_.each(c,function(c){var l=c.getBoundingClientRect();f=Math.max(f,l.height);d+b+l.width>this.width-b&&(d=0,e+=b+f,f=0);d+=b;var m=d+l.width/2,t=e+l.height/2;c.destination.set(a?n.SnapTo(m,this.size):m,a?n.SnapTo(t,this.size):t);d+=l.width},this);return this},randomize:function(a){var b=this.two.width,c=this.two.height;_.each(this.background.children,function(d){var e=d.getBoundingClientRect(),f=Math.random()*(b-e.width)+e.width/2,e=Math.random()*
(c-e.height)+e.height/2;d.destination.set(a?n.SnapTo(f,this.size):f,a?n.SnapTo(e,this.size):e)},this);return this}});n.ContextMenu.domElement.classList.add("context-menu");n.ContextLabel.domElement.classList.add("context-label");document.body.appendChild(n.ContextLabel.domElement);document.body.appendChild(n.ContextMenu.domElement);n.ContextMenu.domElement.innerHTML='<ul><li class="remove">Remove Connection</li></ul><div class="nub"></div>';n.ContextLabel.domElement.innerHTML='<p class="content"></p><div class="nub"></div>'})();(function(){function a(a,b){var c,d=_.uniqueId("param-");a.options?c=_.template('<div class="array"><select id="<%= id %>"><% _.each(array, function(o, i) { %><option value="<%= o.value %>" <%= (!_.isUndefined(value) && o.value.toString() === value.toString()) ? "selected" : "" %>><%= o.name %></option><% }); %></select></div>',{id:d,array:a.options,value:a.value}):_.isNumber(a.value)?(a.id=d,c=_.template('<div class="number"><div class="slider"><div class="fg"></div></div><input id="<%= id %>" type="text" value="<%= value %>"></div>',
a)):_.isBoolean(a.value)?(a.id=d,c=_.template('<div class="boolean"><input id="<%= id %>" type="checkbox" value="<%= name %>" <%= !!value ? "checked" : "" %>></div>',a)):_.isString(a.value)&&(a.id=d,c=_.template('<div class="string"><textarea id="<%= id %>"><%= value %></textarea></div>',a));return{id:d,name:b,reference:b,html:c}}function b(a,b,e){var n=b.params;e=e||a.paramsListing;_.each(e.querySelectorAll(".param"),function(a){var b=a.getAttribute("reference"),e=n[b];if(e.options)$(a.querySelector("select")).change(function(a){e.value=
this.value;if(_.isFunction(e.onUpdate))e.onUpdate()});else if(_.isNumber(e.value))var f=function(a){a.preventDefault();a.stopPropagation();var b=m[0].getBoundingClientRect();a=Math.min(Math.max((a.clientX-b.left)/b.width,0),1);b=e.min;a=b+(e.max-b)*((a-0)/1);_.isNumber(e.step)&&(a=Math.round(a/e.step)*e.step);A.val(a).trigger("blur")},l=function(a){a.preventDefault();a.stopPropagation();d.removeClass("dragging");c.unbind("mousemove",f).unbind("mouseup",l)},m=$(a.querySelector(".slider")).bind("mousedown",
function(a){a.preventDefault();a.stopPropagation();d.addClass("dragging");c.bind("mousemove",f).bind("mouseup",l)}),C=$(a.querySelector(".fg")),A=$(a.querySelector("input")).bind("keyup",function(a){13===a.which&&A.trigger("blur")}).bind("blur",function(a){e.value=Math.min(Math.max(this.value,e.min),e.max);C.css("width",100*e.value/(e.max-e.min)+"%")}).trigger("blur");else _.isBoolean(e.value)?$(a.querySelector("input")).change(function(a){e.value=!!this.checked}):_.isString(e.value)&&$(a.querySelector("textarea")).blur(function(a){e.value=
$(this).val();e.onUpdate()})});$(e.querySelector(".delete")).bind("click",function(c){a.parent.remove(b)})}var c,d;document.createElement("div");$(function(){c=$(window);d=$(document.body)});var e=Sandbox.Inspector=function(a){this.parent=_.defaults(a||{},{defaultJSON:!0}).parent;this.fullpage=!1;this.domElement=document.createElement("div");$(this.domElement).addClass(Sandbox.className+" inspector");this.drawer=document.createElement("div");this.drawer.classList.add("drawer");this.panel=document.createElement("ul");
this.panel.classList.add("panel");this.domElement.appendChild(this.drawer);this.domElement.appendChild(this.panel);e.CreateContextMenu(this);e.CreateNavigation(this);e.CreateNodeListing(this);e.CreateParamsListing(this);this.showNodeListing();a=_.bind(function(){$(this.panel.querySelector(".fullpage")).trigger("click")},this);if(url.setup){var b=JSON.parse(decodeURIComponent(url.setup));this.parent.setJSON(b,a)}};_.extend(e,{defaultJSON:{output:{id:1376350967933,position:{x:800,y:275}},connections:[{input:{id:1376350967933,
property:"buffer"},output:{id:1376350999822,property:"buffer"}},{input:{id:1376351020528,property:"scene"},output:{id:1376351013022,property:"scene"}},{input:{id:1376350999822,property:"normal"},output:{id:1376351020528,property:"buffer"}},{input:{id:1376350999822,property:"video"},output:{id:1376350984248,property:"texture"}}],nodes:[{property:"VideoTexture",id:1376350984248,params:{source:"/media/sandbox/reflektor_1_640.mp4"},position:{x:275,y:400}},{property:"Refraction",id:1376350999822,params:{},
position:{x:575,y:275}},{property:"BreakingGlassScene",id:1376351013022,params:{force:0.05,spin:1,randomness:0.15,radius:0.03,damping:0.025},position:{x:175,y:125}},{property:"RenderNormals",id:1376351020528,params:{},position:{x:400,y:125}}]},Templates:{navigation:'<li class="add" description="Add node"></li><li class="home" description="Node options"></li><li class="share" description="Share a link"></li><li class="fullpage" description="Expand"></li><li class="fullscreen" description="Fullscreen"></li><li class="switch" description="View output"></li>',
nodeListing:'<li class="title"><h3><%= title %></h3></li><% _.each(nodes, function(o) { %><li class="io-<%= o.inputs %>-<%= o.outputs %>" reference="<%= o.reference %>"><%= o.name %></li><% }); %>',paramsListing:'<li class="title"><h3><%= title %><div class="delete"></div></h3></li><% _.each(nodes, function(o, i) { %><li reference="<%= o.reference %>" class="param"><label for="<%= o.id %>"><%= o.name %></label><%= o.html %></li><% }); %>',defaultParamsListing:""},CreateNavigation:function(a){var b=
a.parent.width,m=a.parent.height,n=function(){a.snapToScreen()};a.$={};var p=function(){var b=this.getBoundingClientRect();a.toolTip.show(b.left+d.scrollLeft(),b.top+d.scrollTop()+b.height/2,this.getAttribute("description"))},r=function(){a.toolTip.hide()},t=_.debounce(function(){a.parent.graph.shouldRender=!0},2E3);a.panel.innerHTML=e.Templates.navigation;var u=!(localStorage&&localStorage.getItem("opened-graph"));u&&_.delay(function(){p.call(a.$.switcher[0])},1E4);a.$.add=$(a.panel.querySelector(".add")).hover(p,
r).bind("click",function(){a.parent.showing.value||a.parent.toggle();a.showNodeListing()});a.$.home=$(a.panel.querySelector(".home")).hover(p,r).bind("click",function(){a.showParamsListing();a.__focused||(a.parent.graph.shouldRender=!1,a.parent.viewport.renderer.clear(),t())});a.$.share=$(a.panel.querySelector(".share")).hover(p,r).bind("click",function(){var b=window.location.protocol+"//"+window.location.host,c=window.location.pathname,d=a.parent.toJSON(!0).replace(/\s/ig,"");a.contextMenu.show(b+
c+("?editor="+a.parent.showing.value+"&setup="+d))});var z=a.$.fullpage=$(a.panel.querySelector(".fullpage")).hover(p,r).bind("click",function(){BigScreen.exit();a.fullpage||a.fullscreen?(d.removeClass("fullpage"),_.extend(a.parent.domElement.style,{margin:0}),a.parent.setSize(b,m),c.unbind("resize",n),z.attr("description","Expand sandbox to the page")):(d.addClass("fullpage"),a.snapToScreen(),c.bind("resize",n),z.attr("description","Reduce sandbox within the page"));a.fullpage=!a.fullpage}),E=a.$.fullscreen=
$(a.panel.querySelector(".fullscreen")).hover(p,r).bind("click",function(){a.fullpage&&(d.removeClass("fullpage"),_.extend(a.parent.domElement.style,{margin:0}),a.parent.setSize(b,m),c.unbind("resize",n));BigScreen.toggle(a.parent.domElement,function(){a.parent.setSize(screen.width,screen.height);a.fullscreen=!0;a.fullpage=!1;E.addClass("set");E.attr("description","Exit fullscreen")},function(){d.removeClass("fullpage");_.extend(a.parent.domElement.style,{margin:0});a.parent.setSize(b,m);a.fullscreen=
!1;E.removeClass("set");E.attr("description","Fullscreen")},function(){})}),C=a.$.switcher=$(a.panel.querySelector(".switch")).hover(p,r).bind("click",function(){u&&localStorage&&localStorage.setItem("opened-graph",!0);a.parent.toggle()});a.parent.bind("viewport",function(){C.addClass("viewport");C.attr("description","Hide output")}).bind("graph",function(){C.removeClass("viewport");C.attr("description","View output")})},CreateNodeListing:function(a){a.nodeListing=document.createElement("ul");a.nodeListing.classList.add("node-listing");
var b={title:"Select a Node to Add",nodes:_.map(Sandbox.Nodes,function(a,b){var c=new a,d={reference:b,name:a.prototype.name,inputs:_.size(c.inputs),outputs:_.size(c.outputs)};c.destroy();return d})};a.nodeListing.innerHTML=_.template(e.Templates.nodeListing,b);a.drawer.appendChild(a.nodeListing);_.each(a.nodeListing.children,function(b){var c=b.getAttribute("reference");c&&$(b).bind("click",function(){var b=new Sandbox.Nodes[c];a.parent.add(b)})})},CreateParamsListing:function(a){a.paramsListing=
document.createElement("ul");a.paramsListing.classList.add("params-listing");a.paramsListing.innerHTML=e.Templates.defaultParamsListing;a.drawer.appendChild(a.paramsListing)},CreateContextMenu:function(a){a.toolTip={domElement:document.createElement("div"),show:function(b,d,e){c.bind("click",a.toolTip.hide);a.toolTip.content.innerHTML=e;_.defer(function(){var c=a.toolTip.domElement.getBoundingClientRect();_.extend(a.toolTip.domElement.style,{top:d-c.height/2+"px",left:b-(c.width+12)+"px",display:"block"})})},
hide:function(){_.extend(a.toolTip.domElement.style,{top:"-10000px",left:"-10000px"});c.unbind("click",a.toolTip.hide)}};a.contextMenu={domElement:document.createElement("div"),backdrop:document.createElement("div"),container:document.createElement("div"),loader:document.createElement("div"),showLoader:function(c){a.contextMenu.loader.querySelector(".content").innerHTML=c;a.contextMenu.container.style.display="none";a.contextMenu.loader.style.display="block";b()},show:function(c){var d=a.contextMenu.container.querySelector('input[type="text"]');
d.value=c||"http://justareflektor.com/sandbox/4567";a.contextMenu.container.style.display="block";a.contextMenu.loader.style.display="none";b();d.select()},hide:function(){a.contextMenu.domElement.style.opacity=0;_.delay(function(){a.contextMenu.domElement.style.display="none"},150)}};var b=_.throttle(function(){_.extend(a.contextMenu.domElement.style,{display:"block"});_.defer(function(){a.contextMenu.domElement.style.opacity=1})},1E3);a.contextMenu.domElement.classList.add("url-context-menu");a.contextMenu.backdrop.classList.add("backdrop");
a.contextMenu.container.classList.add("container");a.contextMenu.loader.classList.add("loader");a.toolTip.domElement.classList.add("tool-tip");a.toolTip.domElement.innerHTML='<span class="content"></span>';a.toolTip.content=a.toolTip.domElement.querySelector(".content");a.contextMenu.container.innerHTML='<div><p>To share this patch with others, copy and paste this link:</p><div class="divider"></div><input type="text" value=""></div>';a.contextMenu.container.querySelector("input").value="http://justareflektor.com/sandbox/4564";
a.contextMenu.loader.innerHTML='<div class="container"><div><p class="content"></p></div></div>';a.contextMenu.domElement.appendChild(a.contextMenu.backdrop);a.contextMenu.domElement.appendChild(a.contextMenu.container);a.contextMenu.domElement.appendChild(a.contextMenu.loader);document.body.appendChild(a.toolTip.domElement);$(a.contextMenu.backdrop).bind("click",function(b){a.contextMenu.hide()})}});_.extend(e.prototype,{appendTo:function(a){a.appendChild(this.domElement);a.appendChild(this.contextMenu.domElement);
return this},showParamsListing:function(){this.showing=!0;this.nodeListing.style.display="none";this.paramsListing.style.display="block";this.$.home.addClass("enabled");this.$.add.removeClass("enabled");return this},showNodeListing:function(){this.showing=!1;this.nodeListing.style.display="block";this.paramsListing.style.display="none";this.$.home.removeClass("enabled");this.$.add.addClass("enabled");return this},toggle:function(){this.showing?this.showNodeListing():this.showParamsListing();return this},
add:function(c){var d=_.template(e.Templates.paramsListing,{title:c.name,nodes:_.map(c.params,a)}),m=document.createElement("li");m.classList.add("shell");m.id="params-"+c.id;m.innerHTML=d;b(this,c,m);this.paramsListing.appendChild(m);return this},remove:function(a){a=document.querySelector("#params-"+a.id);$(a).remove();return this},focus:function(a){this.__focused=!0;this.drawer.classList.add("enabled");var b=_.bind(function(){this.drawer.classList.remove("enabled");$(this.domElement).unbind("mouseleave",
b)},this);$(this.domElement).bind("mouseleave",b);return this.showParamsListing()},snapToScreen:function(){var a=w=c.width(),b=h=c.height();a/Sandbox.aspectRatio>b&&(w=b*Sandbox.aspectRatio);w=Math.min(w,1920);h=w/Sandbox.aspectRatio;this.parent.setSize(w,h);_.extend(this.parent.domElement.style,{marginLeft:(a-w)/2+"px",marginTop:(b-h)/2+"px"});return this}})})();(function(){var a=Sandbox.Node=function(){this.id=Sandbox.uniqueId();this.params={};this.inputs={};this.outputs={};this.scene=new THREE.Scene;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,-1,1);this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2));this.scene.add(this.quad);this.destructables=[this.scene,this.camera,this.quad];this.shouldRender=!0};_.extend(a.prototype,Backbone.Events,{type:"Node",update:_.identity,setId:function(a){this.id=a;return this},setParams:function(a){_.each(a,function(a,
b){if(!_.isUndefined(this.params[b])&&(this.params[b].value=a,_.isFunction(this.params[b].onUpdate)))this.params[b].onUpdate()},this);return this},getParam:function(a){return this.params[a]&&this.params[a].value},extractParams:function(){var a={};_.each(this.params,function(c,d){a[d]=this.getParam(d)},this);return a},attach:function(a){this.sandbox=a;this.renderer=a.viewport.renderer;this.viewport=a.viewport;return this},createBuffer:function(a){a=_.defaults(a||{},{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,
format:THREE.RGBFormat,stencilBuffer:!1,generateMipmaps:!1,width:0,height:0});var c=new THREE.WebGLRenderTarget(a.width,a.height,a);c.generateMipmaps=a.generateMipmaps;c.__parentNode=this;return c},dispose:function(a){_.isFunction(a.dispose)&&a.dispose();a=_.indexOf(this.destructables,a);if(0>a)return this;this.destructables.splice(a,1);return this},destroy:function(){_.each(_.compact(this.destructables),function(a){_.isFunction(a.dispose)&&a.dispose()});this.destructables.length=0;return this}})})();(function(){var a=Sandbox.Preview=function(){Sandbox.Node.call(this);var a=this,c=null;this.buffer=null;this.inputs.buffer=null;Object.defineProperty(this.inputs,"buffer",{get:function(){return c},set:function(d){c=a.buffer=d}});this.html=_.template(Sandbox.Graph.Templates.preview,this)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Output",update:function(){return this.trigger("update")}})})();THREE.Composite3Shader={uniforms:{texture1:{type:"t",value:null},texture2:{type:"t",value:null},opacity1:{type:"f",value:1},opacity2:{type:"f",value:1},mode:{type:"i",value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float blend;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform int mode;\nuniform float opacity1;\nuniform float opacity2;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel1 = texture2D( texture1, vUv ) * opacity1;\nvec4 texel2 = texture2D( texture2, vUv ) * opacity2;\nif (mode == 0) {\ngl_FragColor = min(texel1 + texel2, 1.0);\n} else if (mode == 1) {\ngl_FragColor = max(texel1 - texel2, 0.0);\n} else if (mode == 2) {\ngl_FragColor = texel1 * texel2;\n}\n}"};THREE.AddBlendShader={uniforms:{texture1:{type:"t",value:null},texture2:{type:"t",value:null},blend:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float blend;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel1 = texture2D( texture1, vUv );\nvec4 texel2 = texture2D( texture2, vUv );\ngl_FragColor = texel1 + texel2 * blend;\n}"};THREE.BlendShader={uniforms:{texture1:{type:"t",value:null},texture2:{type:"t",value:null},blend:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float blend;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel1 = texture2D( texture1, vUv );\nvec4 texel2 = texture2D( texture2, vUv );\ngl_FragColor = mix( texel1, texel2, 0.5 );\n}"};THREE.ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{texture:{type:"t",value:null},uImageIncrement:{type:"v2",value:new THREE.Vector2(0.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:"uniform vec2 uImageIncrement;\nvarying vec2 vUv;\nvoid main() {\nvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float cKernel[ KERNEL_SIZE_INT ];\nuniform sampler2D texture;\nuniform vec2 uImageIncrement;\nvarying vec2 vUv;\nvoid main() {\nvec2 imageCoord = vUv;\nvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\nfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\nsum += texture2D( texture, imageCoord ) * cKernel[ i ];\nimageCoord += uImageIncrement;\n}\ngl_FragColor = sum;\n}",
buildKernel:function(a){var b,c,d,e,f=2*Math.ceil(3*a)+1;25<f&&(f=25);e=0.5*(f-1);c=Array(f);for(b=d=0;b<f;++b)c[b]=Math.exp(-((b-e)*(b-e))/(2*a*a)),d+=c[b];for(b=0;b<f;++b)c[b]/=d;return c}};THREE.CopyShader={uniforms:{texture:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D texture;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( texture, vUv );\ngl_FragColor = opacity * texel;\n}"};THREE.GodRaysShader={defines:{TAPS_PER_PASS:"6.0"},uniforms:{texture:{type:"t",value:null},fStepSize:{type:"f",value:6},center:{type:"v2",value:new THREE.Vector2(0,0)},rayLength:{type:"f",value:1},intensity:{type:"f",value:1},aspect:{type:"f",value:1.33}},vertexShader:"varying highp vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying vec2 vUv;\nuniform sampler2D texture;\nuniform vec2 center;\nuniform float fStepSize;\nuniform float rayLength;\nuniform float intensity;\nuniform float aspect;\nvoid main() {\nvec2 delta = (center - vUv);\nfloat dist = length( delta * vec2(aspect,1.0) );\nvec2 stepv = (fStepSize * delta / dist) * rayLength;\nvec2 uv = vUv.xy;\nvec3 col = vec3(0.0);\nfor ( float i = 0.0; i < TAPS_PER_PASS; i += 1.0 ) {\ncol += ( dot(center-uv,center-vUv.xy) > 0.0 ? ( texture2D( texture, uv ).rgb ) : vec3(0.0));\nuv += stepv;\n}\ngl_FragColor = vec4( col / TAPS_PER_PASS * intensity, 1.0 );\n}"};THREE.RefractionShader={uniforms:{normalBuffer:{type:"t",value:null},videoBuffer:{type:"t",value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D normalBuffer;\nuniform sampler2D videoBuffer;\nvarying highp vec2 vUv;\nvoid main() {\nvec3 normal = texture2D(normalBuffer,vUv).rgb * vec3(2.0) - vec3(1.0);\nif ( normal == vec3(-1.0) ) normal = vec3(0.0);\nvec2 vUv2 = vUv * vec2(0.95);\nvec2 rUvR = vUv2 + ( ( normal.xy ) * vec2(0.31) );\nvec2 rUvG = vUv2 + ( ( normal.xy ) * vec2(0.32) );\nvec2 rUvB = vUv2 + ( ( normal.xy ) * vec2(0.33) );\nvec3 video = texture2D(videoBuffer,rUvR).rgb;\nvideo.g = texture2D(videoBuffer,rUvG).g;\nvideo.b = texture2D(videoBuffer,rUvB).b;\ngl_FragColor = vec4(video, 1.0);\n}"};THREE.DrawingBlur={uniforms:{previousBuffer:{type:"t",value:null},center:{type:"v2",value:new THREE.Vector2(0.5,0.5)},ratio:{type:"v2",value:new THREE.Vector2(1,1)},drawingSize:{type:"f",value:null},intensity:{type:"f",value:null},fade:{type:"f",value:null}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\n     vUv = vec2(uv.x,uv.y);\n     gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform sampler2D previousBuffer;\nuniform mediump vec2 center;\nuniform mediump float drawingSize;\nuniform mediump vec2 ratio;\nuniform mediump float fade;\nuniform mediump float intensity;\nvoid main() {\n    mediump float centerDist = distance((vUv-0.5)*ratio,(center-0.5)*ratio);\n    float dist = max(drawingSize-centerDist,0.0) / drawingSize * intensity;\n    vec3 previousColor = texture2D(previousBuffer, vUv).rgb - fade;\n    gl_FragColor = vec4(previousColor + dist*(1.0-previousColor), 1.0);\n    gl_FragColor = clamp(gl_FragColor, 0.0, 1.0);\n}"};THREE.BumpToNormal={uniforms:{bumpBuffer:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2},intensity:{type:"f",value:1}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\n     vUv = vec2(uv.x,uv.y);\n     gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform sampler2D bumpBuffer;\nuniform vec2 resolution;\nuniform float intensity;\nvoid main() {\nfloat top    = texture2D(bumpBuffer, vec2(vUv.x, vUv.y - 1./resolution.y)).x;\nfloat bottom  = texture2D(bumpBuffer, vec2(vUv.x, vUv.y + 1./resolution.y)).x;\nfloat left  = texture2D(bumpBuffer, vec2(vUv.x - 1./resolution.x, vUv.y)).x;\nfloat right = texture2D(bumpBuffer, vec2(vUv.x + 1./resolution.x, vUv.y)).x;\nfloat dx = (right - left) * intensity;\nfloat dy = (bottom - top) * intensity;\nfloat dz = max(sqrt(intensity - dx*dx - dy*dy), 0.0);  \nvec3 normal = normalize(vec3(dx,dy,dz))/2.0+0.5;\n    gl_FragColor = vec4( normal , 1.0);\n}"};THREE.VideoFeedback={uniforms:{previousBuffer:{type:"t",value:null},maskBuffer:{type:"t",value:null},videoBuffer:{type:"t",value:null}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\n     vUv = vec2(uv.x,uv.y);\n     gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform sampler2D previousBuffer;\nuniform sampler2D maskBuffer;\nuniform sampler2D videoBuffer;\nvoid main() {\n    vec3 previousColor = texture2D(previousBuffer, vUv).rgb;\n    vec3 videoColor = texture2D(videoBuffer, vUv).rgb;\n    vec3 maskColor = texture2D(maskBuffer, vUv).rgb;\n    gl_FragColor = vec4( mix(previousColor,videoColor, pow(maskColor.r,3.8)), 1.0);\n}"};THREE.Vibrance={uniforms:{maskBuffer:{type:"t",value:null},videoBuffer:{type:"t",value:null},effectAlpha:{type:"f",value:0.5},timep:{type:"f",value:null}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\n     vUv = vec2(uv.x,uv.y);\n     gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform float timep;\nuniform float effectAlpha;\nuniform sampler2D maskBuffer;\nuniform sampler2D videoBuffer;\nlowp float rand( vec2 co ){\n    return fract( sin( dot( co.xy ,vec2( 12.9898,78.233 ) ) ) * 43758.5453 );\n}\nconst mediump vec3  kRGBToYPrime = vec3 (0.299, 0.587, 0.114);\nvoid main() {\n    lowp float noise = rand(vUv*timep*10.0);\n    mediump float vibrance = 1.0-texture2D(maskBuffer,vUv).r;\n    vibrance*=vibrance*noise;\n    vec4 color = texture2D(videoBuffer,vUv);\n    lowp float YPrime  = dot (color.rgb, kRGBToYPrime);\n    lowp float average = YPrime; //(color.r + color.g + color.b) / 3.0;\n    lowp float mx = max(color.r, max(color.g, color.b));\n    lowp float amt = (mx - average) * (-vibrance * 100.0 * effectAlpha);\n    color.rgb = mix(color.rgb, vec3(mx), amt);\n    gl_FragColor = color;\n}"};THREE.OffsetBlurShader={uniforms:{tDiffuse:{type:"t",value:null},offset:{type:"v2",value:new THREE.Vector2(0.0125,0.0125)}},vertexShader:"varying vec2 vUv;\nvarying vec2 uvLeft;\nvarying vec2 uvRight;\nvarying vec2 uvTop;\nvarying vec2 uvBottom;\nvarying vec2 uvTopLeft;\nvarying vec2 uvTopRight;\nvarying vec2 uvBottomLeft;\nvarying vec2 uvBottomRight;\nuniform vec2 offset;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\nuvLeft = vUv + vec2(-offset.x, 0.0);\nuvRight = vUv + vec2(offset.x, 0.0);\nuvTop = vUv + vec2(0.0, -offset.y);\nuvBottom = vUv + vec2(0.0, offset.y);\nuvTopLeft = vUv + vec2(-offset.x, -offset.y);\nuvTopRight = vUv + vec2(offset.x, -offset.y);\nuvBottomLeft = vUv + vec2(-offset.x, offset.y);\nuvBottomRight = vUv + vec2(offset.x, offset.y);\ngl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"varying vec2 vUv;\nvarying vec2 uvLeft;\nvarying vec2 uvRight;\nvarying vec2 uvTop;\nvarying vec2 uvBottom;\nvarying vec2 uvTopLeft;\nvarying vec2 uvTopRight;\nvarying vec2 uvBottomLeft;\nvarying vec2 uvBottomRight;\nuniform vec2 offset;\nuniform sampler2D tDiffuse;\nvoid main() {\ngl_FragColor = (\ntexture2D(tDiffuse, vUv) * 4.0 +\n(texture2D(tDiffuse, uvLeft) +\ntexture2D(tDiffuse, uvRight) +\ntexture2D(tDiffuse, uvTop) +\ntexture2D(tDiffuse, uvBottom)) * 2.0 +\ntexture2D(tDiffuse, uvTopLeft) +\ntexture2D(tDiffuse, uvTopRight) +\ntexture2D(tDiffuse, uvBottomRight) +\ntexture2D(tDiffuse, uvBottomLeft)\n) * 0.0625;\ngl_FragColor.a = 1.0;\n}"};THREE.NoiseShader={uniforms:{texture:{type:"t",value:null},amount:{type:"v2",value:new THREE.Vector2(Math.random(),Math.random())},fade:{type:"f",value:1}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix *  modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform sampler2D texture;\nuniform highp vec2 amount;\nuniform lowp float fade;\nfloat rand(vec2 co) {\nreturn fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\n#define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))\nvoid main() {\nfloat noise = 0.5 + 0.5 * rand(amount + vUv);\nlowp float linea = dot(texture2D(texture, vUv).rgb, vec3(1.0));\nlinea *= linea * linea * fade;\nvec4 lineValue = linea * linea * vec4(1.0);\nlineValue = (lineValue * noise) * 1.5 - 0.5;\ngl_FragColor = max(lineValue, 0.0) * fade;\n}"};THREE.InvertShader={uniforms:{texture:{type:"t",value:null},amount:{type:"f",value:1}},vertexShader:"varying mediump vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix *  modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"varying mediump vec2 vUv;\nuniform sampler2D texture;\nuniform float amount;\nvoid main() {\nvec4 c = texture2D(texture, vUv);\nvec4 i = vec4(1.0 - c.r, 1.0 - c.g, 1.0 - c.b, c.a);\ngl_FragColor = (i * amount) + c * (1.0 - amount);\n}"};(function(){var a=Sandbox.Nodes.DrawingBlur=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.DrawingBlur.uniforms),vertexShader:THREE.DrawingBlur.vertexShader,fragmentShader:THREE.DrawingBlur.fragmentShader,depthTest:!1,transparent:!1});this.params={size:{value:0.3,step:0.001,min:0,max:1},sizeRandomness:{value:0.4,step:0.001,
min:0,max:1},intensity:{value:0.9,step:0.001,min:0,max:1},fade:{value:0.01,step:0.001,min:0,max:1}};this.quad.material=this.shader;this.fbo0=this.createBuffer();this.fbo1=this.createBuffer();this.buffer=this.outputs.buffer=this.fbo0;this.destructables.push(this.shader,this.fbo0,this.fbo1)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Drawing Blur",resize:function(a,c){var d=Math.min(1,1920/a);this.fbo0.dispose();var e=_.indexOf(this.destructables,this.fbo0);0<=e&&this.destructables.splice(e,
1);this.fbo0=this.createBuffer({width:a*d,height:c*d});this.fbo1.dispose();e=_.indexOf(this.destructables,this.fbo1);0<=e&&this.destructables.splice(e,1);this.fbo1=this.createBuffer({width:a*d,height:c*d});this.shader.uniforms.ratio.value.set(a/c,1);this.destructables.push(this.fbo0,this.fbo1);this.buffer=this.outputs.buffer=this.fbo0;return this},update:function(){var a=this.fbo1;this.fbo1=this.fbo0;this.fbo0=this.outputs.buffer=a;this.shader.uniforms.drawingSize.value=this.getParam("size")+Math.pow(Math.random(),
6)*this.getParam("sizeRandomness");this.shader.uniforms.intensity.value=this.getParam("intensity");this.shader.uniforms.fade.value=this.getParam("fade");this.shader.uniforms.previousBuffer.value=this.fbo1;this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0);return this.trigger("update")},onMouseMove:function(a,c){this.shader.uniforms.center.value.set(a,1-c);return this}})})();(function(){function a(){var a=this.drops,b=this.getParam("fade"),c=this.getParam("drag"),d=this.getParam("randomness"),n=this.getParam("perlin");_.each(a.children,function(a){var e=!0,t=!1;a.isWhite&&b&&(a.color+=-a.color*c/12,a.color=Math.floor(a.color),a.fill="rgb("+a.color+","+a.color+","+a.color+")");_.each(a.vertices,function(a){if(0>=a.velocity)t=!0;else{a.length()<two.width&&(e=!1);var b=(noise.perlin2(a.x,a.y)+1)/2;a.x+=a.velocity*Math.cos(a.direction);a.y+=a.velocity*Math.sin(a.direction);
a.velocity-=a.velocity*c*((n?b:Math.random())*d||1)}});e&&!t&&a.remove()})}function b(a,b){var c=this.two.renderer.domElement.getContext("2d").getImageData(a,b,1,1).data;return 0>=c[3]||127.5>c[0]&&127.5>c[1]&&127.5>c[2]}var c=2*Math.PI,d=Sandbox.Nodes.Suminagashi=function(){Sandbox.Node.call(this);this.destroy();this.two=new Two({type:Two.Types.canvas,width:480,height:270});this.drops=this.two.scene;this.outputs.texture=this.buffer=new THREE.Texture(this.two.renderer.domElement);this.outputs.texture.__parentNode=
this;this.outputs.texture.minFilter=THREE.LinearFilter;this.outputs.texture.magFilter=THREE.LinearFilter;this.outputs.texture.format=THREE.RGBFormat;this.outputs.texture.generateMipmaps=!1;this.params={interval:{value:2E3,min:250,max:1E4,step:10},resolution:{value:32,min:16,max:64,step:2},velocity:{value:10,min:1,max:20,step:1},drag:{value:0.125,min:1E-4,max:1,step:1E-4},randomness:{value:0,min:0,max:1,step:0.001},perlin:{value:!1},fade:{value:!1}};this.html=_.template(Sandbox.Graph.Templates.canvas,
this)+_.template(Sandbox.Graph.Templates.description,this);this.destructables.push(this.texture);this.lastTrigger=Date.now();this.width=this.two.width;this.height=this.two.height;this.mouse={x:this.width/2,y:this.height/2}};_.extend(d.prototype,Sandbox.Node.prototype,{name:"Suminagashi",resize:function(a,b){var c=Math.min(1,480/a);this.width=a*c;this.height=b*c;this.two.renderer.setSize(this.width,this.height);this.two.width=this.width;this.two.height=this.height;return this},addDrop:function(){var a=
this.getParam("velocity"),d=this.getParam("resolution"),l=this.getParam("randomness"),m=this.getParam("perlin"),n=this.mouse.x,p=this.mouse.y,r=this.two,t=this.drops,u=b.call(this,n,p),z=new Two.Vector(n,p),E=_.map(_.range(d),function(b){b=c*(b/d);b=new Two.Vector(Math.cos(b)+n,Math.sin(b)+p);var r=(noise.perlin2(n,p)+1)/2;b.velocity=l*(m?r:Math.random())*a+a;b.direction=Math.atan2(p-b.y,n-b.x);return b});_.each(t.children,function(b){var c=b.translation;_.each(b.vertices,function(b){var d=b.distanceTo(z)/
r.width;b.velocity=a*d+a;b.direction=Math.atan2(p-c.y-b.y,n-c.x-b.x)+Math.PI})});E=r.makeCurve(E);E.color=u?255:0;E.noStroke().fill="rgb("+E.color+","+E.color+","+E.color+")";E.isWhite=u;t.add(E)},update:function(){var b=Date.now();b-this.lastTrigger>this.getParam("interval")&&(this.addDrop(),this.lastTrigger=b);a.call(this);this.two.render();this.outputs.texture.needsUpdate=!0;return this.trigger("update")},onMouseMove:function(a,b){this.mouse.x=this.width*a;this.mouse.y=this.height*b;return this},
destroy:function(){Sandbox.Node.prototype.destroy.call(this);var a=_.indexOf(Two.Instances,this.two);0<=a&&Two.Instances.splice(a,1);return this}})})();(function(){var a=document.createElement("video"),b=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),c=Sandbox.Nodes.Webcam=function(){Sandbox.Node.call(this);this.destroy();this.outputs.texture=this.buffer=window.texture=new THREE.Texture(a);this.outputs.texture.__parentNode=this;this.outputs.texture.minFilter=THREE.LinearFilter;this.outputs.texture.magFilter=THREE.LinearFilter;this.outputs.texture.format=THREE.RGBFormat;this.outputs.texture.generateMipmaps=
!1;this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.destructables.push(this.texture);this._requested=!1};_.extend(c,{requested:!1,Request:function(){b&&(window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({video:!0},function(b){b.getVideoTracks();a.src=window.URL.createObjectURL(b);a.play();_.delay(function(){c.requested=
!0},1E3)},function(a){console.error(a)}))}});_.extend(c.prototype,Sandbox.Node.prototype,{name:"Webcam",resize:function(a,b){this.width=a;this.height=b;return this},update:function(){this._requested||c.requested||(c.Request(),this._requested=!0);if(c.requested){var b=a.videoWidth/a.videoHeight,e=this.width/this.height;this.outputs.texture.repeat.y!==b/e&&this.outputs.texture.repeat.set(1,b/e);this.outputs.texture.needsUpdate=!0}return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Planes=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.params={amount:{value:1,min:1,max:50,step:1},drag:{value:0.0625,min:0,max:1,step:0.001},blending:{value:THREE.AdditiveBlending,options:a.BlendingModes}};this.scene.remove(this.quad);this.dispose(this.quad);delete this.quad;var b=new THREE.PlaneGeometry(2,2);this.material=new THREE.MeshBasicMaterial({blending:this.getParam("blending"),
transparent:!0});this.planes=_.map(_.range(this.params.amount.max),function(a){a=new THREE.Mesh(b,this.material);a.position.destination=new THREE.Vector3;this.scene.add(a);this.destructables.push(a);return a},this);this.inputs.video=null;this.buffer=this.outputs.buffer=this.createBuffer();this.destructables.push(this.buffer,this.material)};_.extend(a,{BlendingModes:[{name:"None",value:THREE.NoBlending},{name:"Normal",value:THREE.NormalBlending},{name:"Additive",value:THREE.AdditiveBlending},{name:"Subtractive",
value:THREE.SubtractiveBlending},{name:"Multiply",value:THREE.MultiplyBlending}]});_.extend(a.prototype,Sandbox.Node.prototype,{name:"Planes",resize:function(a,c){var d=Math.min(1,480/a),d={width:a*d,height:c*d};this.dispose(this.buffer);this.buffer=this.outputs.buffer=this.createBuffer(d);this.destructables.push(this.buffer);return this},update:function(){var a=this.getParam("drag"),c=this.getParam("amount");if(this.inputs.video){_.each(this.planes,function(d,f){f>=c?d.visible=!1:(0<f&&d.position.destination.copy(this.planes[f-
1].position),d.position.add(d.position.destination.clone().sub(d.position).multiplyScalar(a)),d.visible=!0)},this);var d=this.getParam("blending");this.material.blending!==d&&(this.material.blending=parseInt(d),this.material.needsUpdate=!0);this.material.map!==this.inputs.video&&(this.material.map=this.inputs.video,this.material.needsUpdate=!0);this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0)}return this.trigger("update")},onMouseMove:function(a,c){this.planes[0].position.destination.set(a-
0.5,1-c-0.5,0);return this}})})();(function(){var a=Sandbox.Nodes.GodRays=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.params={intensity:{value:1.5,min:0,max:10,step:0.001},rayLength:{value:1,min:0,max:1,step:0.001}};this.shader=this.quad.material=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.GodRaysShader.uniforms),vertexShader:THREE.GodRaysShader.vertexShader,fragmentShader:THREE.GodRaysShader.fragmentShader,
blending:THREE.AdditiveBlending,defines:THREE.GodRaysShader.defines,transparent:!1});this.inputs.texture=null;this.fbo0=this.createBuffer();this.fbo1=this.createBuffer();this.buffer=this.outputs.buffer=this.fbo0;this.destructables.push(this.fbo0,this.fbo1,this.shader)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"God Rays",resize:function(a,c){var d=Math.min(1,480/a);this.dispose(this.fbo0);this.fbo0=this.createBuffer({width:a*d,height:c*d});this.dispose(this.fbo1);this.fbo1=this.createBuffer({width:a*
d,height:c*d});this.destructables.push(this.fbo0,this.fbo1);this.buffer=this.outputs.buffer=this.fbo0;return this},update:function(){if(this.inputs.texture){this.shader.uniforms.texture.value!==this.inputs.texture&&(this.shader.uniforms.texture.value=this.inputs.texture);var a=1*Math.pow(6,-1);this.shader.uniforms.intensity.value=this.getParam("intensity");this.shader.uniforms.rayLength.value=this.getParam("rayLength");this.shader.uniforms.aspect.value=this.buffer.width/this.buffer.height;this.shader.uniforms.fStepSize.value=
a;this.shader.uniforms.texture.value=this.inputs.texture;this.renderer.render(this.scene,this.camera,this.fbo0,!1);a=1*Math.pow(6,-2);this.shader.uniforms.fStepSize.value=a;this.shader.uniforms.texture.value=this.fbo0;this.renderer.render(this.scene,this.camera,this.fbo1,!1);a=1*Math.pow(6,-3);this.shader.uniforms.fStepSize.value=a;this.shader.uniforms.texture.value=this.fbo1;this.renderer.render(this.scene,this.camera,this.fbo0,!0)}return this.trigger("update")},onMouseMove:function(a,c){this.shader.uniforms.center.value.set(a,
1-c);return this}})})();(function(){var a={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},b=Sandbox.Nodes.Bloom=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);var b,d=void 0!==d?d:25,e=void 0!==e?e:4;this.params={strength:{value:void 0!==b?b:0.5,step:0.1,min:0,max:2},"horizontal blur":{value:0.001953125,step:0.001,min:0,max:10},"vertical blur":{value:0,step:0.001,min:0,max:10}};
this.blur=new THREE.Vector2(this.getParam("horizontal blur"),this.getParam("vertical blur"));this.blendShader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.AddBlendShader.uniforms),vertexShader:THREE.AddBlendShader.vertexShader,fragmentShader:THREE.AddBlendShader.fragmentShader,transparent:!1});this.blendShader.uniforms.blend.value=this.getParam("strength");this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.ConvolutionShader.uniforms),vertexShader:THREE.ConvolutionShader.vertexShader,
fragmentShader:THREE.ConvolutionShader.fragmentShader,defines:{KERNEL_SIZE_FLOAT:d.toFixed(1),KERNEL_SIZE_INT:d.toFixed(0)}});this.shader.uniforms.uImageIncrement.value=this.blur;this.shader.uniforms.cKernel.value=THREE.ConvolutionShader.buildKernel(e);this.quad.material=this.shader;this.inputs.buffer=null;this.fbo0=new THREE.WebGLRenderTarget(0,0,a);this.fbo1=new THREE.WebGLRenderTarget(0,0,a);this.buffer=this.outputs.buffer=new THREE.WebGLRenderTarget(0,0,a);this.outputs.buffer.__parentNode=this;
this.destructables.push(this.shader,this.blendShader,this.buffer,this.fbo0,this.fbo1)};_.extend(b.prototype,Sandbox.Node.prototype,{name:"Bloom",resize:function(a,b){var e=Math.min(1,1920/a);this.outputs.buffer.width=a*e;this.outputs.buffer.height=b*e;this.fbo0.width=a*e/16;this.fbo0.height=b*e/16;this.fbo1.width=a*e/16;this.fbo1.height=b*e/16;this.outputs.buffer.width=a*e;this.outputs.buffer.height=b*e;return this},update:function(){this.inputs.buffer&&(this.blur.x=this.getParam("horizontal blur"),
this.blur.y=this.getParam("vertical blur"),this.blendShader.uniforms.blend.value=this.getParam("strength"),this.shader.uniforms.texture.value=this.inputs.buffer,this.shader.uniforms.uImageIncrement.value=this.blur,this.renderer.render(this.scene,this.camera,this.fbo0,!1),this.shader.uniforms.texture.value=this.fbo0,this.renderer.render(this.scene,this.camera,this.fbo1,!1),this.scene.overrideMaterial=this.blendShader,this.blendShader.uniforms.texture1.value=this.inputs.buffer,this.blendShader.uniforms.texture2.value=
this.fbo1,this.renderer.render(this.scene,this.camera,this.outputs.buffer,!1),this.scene.overrideMaterial=null);return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Blur=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.height=this.width=1;this.params={amount:{value:4,step:0.25,min:0,max:50}};this.shader=this.quad.material=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.OffsetBlurShader.uniforms),vertexShader:THREE.OffsetBlurShader.vertexShader,fragmentShader:THREE.OffsetBlurShader.fragmentShader,transparent:!1});
this.inputs.buffer=null;this.buffer=this.outputs.buffer=this.createBuffer();this.destructables.push(this.shader,this.outputs.buffer)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Blur",resize:function(a,c){var d=Math.min(1,480/a),d={width:a*d,height:c*d};this.width=a;this.height=c;this.dispose(this.buffer);this.buffer=this.outputs.buffer=this.createBuffer(d);this.destructables.push(this.buffer);return this},update:function(){var a=this.getParam("amount");this.inputs.buffer&&(this.shader.uniforms.tDiffuse.value=
this.inputs.buffer,this.shader.uniforms.offset.value.set(a/this.width,a/this.height),this.renderer.render(this.scene,this.camera,this.buffer,!1));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Invert=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.params={amount:{value:1,min:0,max:1,step:0.001}};this.shader=this.quad.material=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.InvertShader.uniforms),vertexShader:THREE.InvertShader.vertexShader,fragmentShader:THREE.InvertShader.fragmentShader,transparent:!1});this.inputs.buffer=null;this.buffer=
this.outputs.buffer=this.createBuffer();this.destructables.push(this.shader,this.outputs.buffer)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Invert",resize:function(a,c){var d=Math.min(1,480/a),d={width:a*d,height:c*d};this.dispose(this.buffer);this.buffer=this.outputs.buffer=this.createBuffer(d);this.destructables.push(this.buffer);return this},update:function(){this.inputs.buffer&&(this.shader.uniforms.texture.value=this.inputs.buffer,this.shader.uniforms.amount.value=this.getParam("amount"),
this.renderer.render(this.scene,this.camera,this.buffer,!1));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Noise=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.params={fade:{value:1,step:0.001,min:0,max:1}};this.shader=this.quad.material=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.NoiseShader.uniforms),vertexShader:THREE.NoiseShader.vertexShader,fragmentShader:THREE.NoiseShader.fragmentShader,transparent:!1});this.inputs.buffer=null;this.buffer=
this.outputs.buffer=this.createBuffer();this.destructables.push(this.shader,this.outputs.buffer)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Noise",resize:function(a,c){var d=Math.min(1,480/a),d={width:a*d,height:c*d};this.dispose(this.buffer);this.buffer=this.outputs.buffer=this.createBuffer(d);this.destructables.push(this.buffer);return this},update:function(){this.inputs.buffer&&(this.shader.uniforms.texture.value=this.inputs.buffer,this.shader.uniforms.fade.value=this.getParam("fade"),
this.renderer.render(this.scene,this.camera,this.buffer,!1));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.BumpToNormal=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.BumpToNormal.uniforms),vertexShader:THREE.BumpToNormal.vertexShader,fragmentShader:THREE.BumpToNormal.fragmentShader,depthTest:!1,transparent:!1});this.quad.material=this.shader;this.fbo0=this.createBuffer();this.buffer=this.outputs.buffer=
this.fbo0;this.params={intensity:{value:1,step:0.001,min:0,max:100}};this.inputs.buffer=null;this.destructables.push(this.shader,this.fbo0,this.buffer)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Bump To Normal",resize:function(a,c){var d=Math.min(1,1920/a);this.fbo0.dispose();var e=_.indexOf(this.destructables,this.fb0);0<=e&&this.destructables.splice(e,1);this.fbo0=this.createBuffer({width:a*d,height:c*d});this.buffer=this.outputs.buffer=this.fbo0;this.shader.uniforms.resolution.value.set(a*
d,c*d);this.destructables.push(this.fbo0);return this},update:function(){this.inputs.buffer&&(this.shader.uniforms.bumpBuffer.value!==this.inputs.buffer&&(this.shader.uniforms.bumpBuffer.value=this.inputs.buffer),this.shader.uniforms.intensity.value=this.getParam("intensity"),this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Refraction=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=this.quad.material=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.RefractionShader.uniforms),vertexShader:THREE.RefractionShader.vertexShader,fragmentShader:THREE.RefractionShader.fragmentShader,transparent:!1});this.inputs.normal=null;this.inputs.video=null;this.buffer=this.outputs.buffer=
this.createBuffer();this.destructables.push(this.shader,this.buffer)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Refraction",resize:function(a,c){var d=Math.min(1,1920/a),e=_.indexOf(this.destructables,this.buffer);0<=e&&this.destructables.splice(e,1);this.buffer.dispose();this.buffer=this.outputs.buffer=this.createBuffer({width:a*d,height:c*d});this.destructables.push(this.buffer);return this},update:function(){this.inputs.normal&&this.inputs.video&&(this.shader.uniforms.normalBuffer.value!==
this.inputs.normal&&(this.shader.uniforms.normalBuffer.value=this.inputs.normal),this.shader.uniforms.videoBuffer.value!==this.inputs.video&&(this.shader.uniforms.videoBuffer.value=this.inputs.video),this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.VideoFeedback=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.VideoFeedback.uniforms),vertexShader:THREE.VideoFeedback.vertexShader,fragmentShader:THREE.VideoFeedback.fragmentShader,depthTest:!1,transparent:!1});this.quad.material=this.shader;this.fbo0=this.createBuffer();this.fbo1=this.createBuffer();
this.buffer=this.outputs.buffer=this.fbo0;this.inputs.video=null;this.inputs.mask=null;this.destructables.push(this.shader,this.fbo0,this.fbo1)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Video Feedback",resize:function(a,c){var d=Math.min(1,1920/a),e=_.indexOf(this.destructables,this.fbo0);0<=e&&this.destructables.splice(e,1);this.fbo0.dispose();this.fbo0=this.createBuffer({width:a*d,height:c*d});e=_.indexOf(this.destructables,this.fbo0);0<=e&&this.destructables.splice(e,1);this.fbo1.dispose();
this.fbo1=this.createBuffer({width:a*d,height:c*d});this.buffer=this.outputs.buffer=this.fbo0;this.destructables.push(this.fbo0,this.fbo1);return this},update:function(){var a=this.fbo1;this.fbo1=this.fbo0;this.fbo0=this.outputs.buffer=a;this.inputs.mask&&this.inputs.video&&(this.shader.uniforms.maskBuffer.value!==this.inputs.mask&&(this.shader.uniforms.maskBuffer.value=this.inputs.mask),this.shader.uniforms.videoBuffer.value!==this.inputs.video&&(this.shader.uniforms.videoBuffer.value=this.inputs.video),
this.shader.uniforms.previousBuffer.value=this.fbo1,this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Vibrance=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.Vibrance.uniforms),vertexShader:THREE.Vibrance.vertexShader,fragmentShader:THREE.Vibrance.fragmentShader,depthTest:!1,transparent:!1});this.quad.material=this.shader;this.fbo0=this.createBuffer();this.buffer=this.outputs.buffer=this.fbo0;
this.params={effectAlpha:{value:0.5,step:0.001,min:0,max:1}};this.inputs.video=null;this.inputs.mask=null;this.destructables.push(this.shader,this.fbo0)};_.extend(a.prototype,Sandbox.Node.prototype,{name:"Vibrance",resize:function(a,c){var d=Math.min(1,1920/a),e=_.indexOf(this.destructables,this.fbo0);0<=e&&this.destructables.splice(e,1);this.fbo0.dispose();this.fbo0=this.createBuffer({width:a*d,height:c*d});this.buffer=this.outputs.buffer=this.fbo0;this.destructables.push(this.buffer);return this},
update:function(){this.inputs.mask&&this.inputs.video&&(this.shader.uniforms.maskBuffer.value!==this.inputs.mask&&(this.shader.uniforms.maskBuffer.value=this.inputs.mask),this.shader.uniforms.videoBuffer.value!==this.inputs.video&&(this.shader.uniforms.videoBuffer.value=this.inputs.video),this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0),this.shader.uniforms.timep.value=0.01*performance.now(),this.shader.uniforms.effectAlpha.value=this.getParam("effectAlpha"));return this.trigger("update")}})})();(function(){var a=Sandbox.Nodes.Composite3=function(){Sandbox.Node.call(this);this.html=_.template(Sandbox.Graph.Templates.canvas,this)+_.template(Sandbox.Graph.Templates.description,this);this.shader=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(THREE.Composite3Shader.uniforms),vertexShader:THREE.Composite3Shader.vertexShader,fragmentShader:THREE.Composite3Shader.fragmentShader,transparent:!1});this.params={opacity1:{value:1,min:0,max:1,step:0.001},opacity2:{value:1,min:0,max:1,step:0.001},
blending:{options:a.BlendModes,onUpdate:_.bind(function(){var a=this.getParam("blending");this.shader.uniforms.mode.value=a},this)}};this.quad.material=this.shader;this.blankBuffer=this.createBuffer();this.blankCamera=new THREE.OrthographicCamera(-1,1,1,-1,-1,1);this.blankScene=new THREE.Scene;this.blankScene.add(new THREE.Mesh(new THREE.PlaneGeometry(2,2)));this.inputs.buffer1=null;this.inputs.buffer2=null;this.buffer=this.outputs.buffer=this.createBuffer();this.destructables.push(this.shader,this.buffer,
this.blankBuffer,this.blankCamera,this.blankScene)};_.extend(a,{BlendModes:[{name:"Additive",value:0},{name:"Subtractive",value:1},{name:"Multiply",value:2}]});_.extend(a.prototype,Sandbox.Node.prototype,{name:"Composite",resize:function(a,c){var d=Math.min(1,1920/a),d={width:a*d,height:c*d};this.dispose(this.buffer);this.buffer=this.outputs.buffer=this.createBuffer(d);this.dispose(this.blankBuffer);this.blankBuffer=this.createBuffer(d);return this},update:function(){var a=_.isNull(this.inputs.buffer1)?
this.blankBuffer:this.inputs.buffer1;this.shader.uniforms.texture1.value!==a&&(this.shader.uniforms.texture1.value=a);a=_.isNull(this.inputs.buffer2)?this.blankBuffer:this.inputs.buffer2;this.shader.uniforms.texture2.value!==a&&(this.shader.uniforms.texture2.value=a);this.shader.uniforms.opacity1.value=this.getParam("opacity1");this.shader.uniforms.opacity2.value=this.getParam("opacity2");this.renderer.render(this.scene,this.camera,this.outputs.buffer,!0);return this.trigger("update")}})})();
